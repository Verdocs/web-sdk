(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"./dist/esm/utils-3f23facc.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getRoleIndex})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getFieldId})),__webpack_require__.d(__webpack_exports__,"c",(function(){return rescale})),__webpack_require__.d(__webpack_exports__,"d",(function(){return fullNameToInitials})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getFieldSettings})),__webpack_require__.d(__webpack_exports__,"f",(function(){return integerSequence})),__webpack_require__.d(__webpack_exports__,"g",(function(){return renderDocumentField})),__webpack_require__.d(__webpack_exports__,"h",(function(){return setControlStyles}));__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.array.fill.js"),__webpack_require__("./node_modules/core-js/modules/es.array.join.js"),__webpack_require__("./node_modules/core-js/modules/es.string.split.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js");function rescale(r,n){return r*n}var integerSequence=function integerSequence(start,count){return Array(count).fill(1).map((function(_,index){return index+start}))},fullNameToInitials=function fullNameToInitials(name){return name.split(" ").map((function(word){return word[0]})).join("")},setControlStyles=function setControlStyles(el,field,xScale,yScale,option){var _a,_b,_c,_d,settings=field.setting||field.settings,_settings$x=settings.x,x=void 0===_settings$x?0:_settings$x,_settings$y=settings.y,y=void 0===_settings$y?0:_settings$y,_settings$width=settings.width,width=void 0===_settings$width?function defaultWidth(field){switch(field.type){case"attachment":case"payment":return 24;case"checkbox":case"checkbox_group":case"radio_button_group":return 14;case"signature":case"initial":return 82}return 150}(field):_settings$width,_settings$height=settings.height,height=void 0===_settings$height?function defaultHeight(field){switch(field.type){case"attachment":case"payment":return 24;case"checkbox":case"checkbox_group":case"radio_button_group":return 14;case"signature":case"initial":return 41}return 50}(field):_settings$height,optionSettings=void 0!==option&&settings.options[option]?settings.options[option]:null;optionSettings&&(x=null!==(_a=optionSettings.x)&&void 0!==_a?_a:x,y=null!==(_b=optionSettings.y)&&void 0!==_b?_b:y,width=null!==(_c=optionSettings.width)&&void 0!==_c?_c:width,height=null!==(_d=optionSettings.height)&&void 0!==_d?_d:height),el.style.width=width+"px",el.style.height=height+"px",el.style.position="absolute",el.style.left=rescale(xScale,x)+"px",el.style.bottom=rescale(yScale,y)+"px",el.style.transform="scale("+xScale+", "+yScale+")"},getFieldId=function getFieldId(field){return"verdocs-doc-fld-"+field.name},getFieldOptionId=function getFieldOptionId(field,index){return"verdocs-doc-fld-"+field.name+"-"+index},renderDocumentField=function renderDocumentField(field,docPage,roleIndex,handleFieldChange,disabled){var editable=arguments.length>5&&void 0!==arguments[5]&&arguments[5],draggable=arguments.length>6&&void 0!==arguments[6]&&arguments[6],controlsDiv=document.getElementById(docPage.containerId+"-controls");if(controlsDiv)switch(field.type){case"attachment":case"date":case"dropdown":case"initial":case"payment":case"signature":case"timestamp":case"textarea":case"textbox":var id=getFieldId(field),existingField=document.getElementById(id);if(existingField)return void setControlStyles(existingField,field,docPage.xScale,docPage.yScale);var el=document.createElement("verdocs-field-"+field.type);return el.field=field,el.setAttribute("id",id),el.setAttribute("roleindex",roleIndex),disabled&&el.setAttribute("disabled",!0),editable&&el.setAttribute("editable",!0),draggable&&el.setAttribute("draggable",!0),el.addEventListener("fieldChange",(function(e){return handleFieldChange(field,e)})),setControlStyles(el,field,docPage.xScale,docPage.yScale),controlsDiv.appendChild(el),el;case"checkbox_group":field.setting.options.forEach((function(_,checkboxIndex){var id=getFieldOptionId(field,checkboxIndex),existingField=document.getElementById(id);if(!existingField){var cbEl=document.createElement("verdocs-field-checkbox");return cbEl.field=field,cbEl.setAttribute("id",id),cbEl.setAttribute("roleindex",roleIndex),cbEl.setAttribute("option",checkboxIndex),disabled&&cbEl.setAttribute("disabled",!0),cbEl.addEventListener("fieldChange",(function(e){return handleFieldChange(field,e)})),setControlStyles(cbEl,field,docPage.xScale,docPage.yScale),controlsDiv.appendChild(cbEl),cbEl}setControlStyles(existingField,field,docPage.xScale,docPage.yScale)}));break;case"radio_button_group":field.setting.options.forEach((function(_,buttonIndex){var id=getFieldOptionId(field,buttonIndex),existingField=document.getElementById(id);if(!existingField){var cbEl=document.createElement("verdocs-field-radio-button");return cbEl.field=field,cbEl.setAttribute("id",id),cbEl.setAttribute("roleindex",roleIndex),cbEl.setAttribute("option",buttonIndex),disabled&&cbEl.setAttribute("disabled",!0),cbEl.addEventListener("fieldChange",(function(e){return handleFieldChange(field,e)})),setControlStyles(cbEl,field,docPage.xScale,docPage.yScale,buttonIndex),controlsDiv.appendChild(cbEl),cbEl}setControlStyles(existingField,field,docPage.xScale,docPage.yScale)}));break;default:return console.log("[PREVIEW] Skipping unsupported field type",field),null}},getRoleIndex=function getRoleIndex(roles,role){return roles.indexOf(role)||0},getFieldSettings=function getFieldSettings(field){return field.setting?field.setting:field.settings?field.settings:{x:0,y:0,required:!1,disabled:!1,result:"",value:""}}},"./dist/esm/verdocs-field-payment.entry.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"verdocs_field_payment",(function(){return VerdocsFieldPayment}));__webpack_require__("./node_modules/core-js/modules/es.array.find.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.to-primitive.js"),__webpack_require__("./node_modules/core-js/modules/es.date.to-primitive.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.number.constructor.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js");var _index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./dist/esm/index-f78d163d.js"),_utils_3f23facc_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./dist/esm/utils-3f23facc.js");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,"symbol"==typeof(key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"))?key:String(key)),descriptor)}var arg,key}var VerdocsFieldPayment=function(){function VerdocsFieldPayment(hostRef){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VerdocsFieldPayment),Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.j)(this,hostRef),this.signatureComplete=Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.e)(this,"signatureComplete",7),this.initialComplete=Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.e)(this,"initialComplete",7),this._fields=[],this.signatureFile=null,this.initialFile=null,this.focusOrderNumber=-1,this.focusFieldName="",this.activeElement=null,this.showError={pageNum:-1,fieldIndex:-1,type:null},this.dialogOpened=!1,this.closeAllErrors=!1,this.fieldsMap={},this.fieldsForCurrentSigner=[],this.fontSize=11,this.averageFontWidth=5,this.requiredFields=[],this.field=null,this.recipient=void 0,this.disabled=!1,this.fields=void 0,this.pageNum=void 0,this.roleName=void 0,this.fieldId=void 0,this.recipients=void 0,this.selectedRoleName=void 0,this.pdfPages=void 0,this.currentSignature=void 0,this.currentSignatureId=void 0,this.currentInitial=void 0,this.currentInitialId=void 0,this.focused=!1,this.signed=!1,this.preparedMessage=void 0,this.signatureUrl=""}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(VerdocsFieldPayment,[{key:"componentWillLoad",value:function componentWillLoad(){if(console.log("sign field",this.field),this.recipients&&this.recipients.length>0){var preparer=this.recipients.find((function(r){return"preparer"===r.type}));console.log("Found preparer",preparer),preparer&&(this.preparedMessage="Prepared by "+preparer.full_name)}}},{key:"render",value:function render(){var _a,_b,settings=Object(_utils_3f23facc_js__WEBPACK_IMPORTED_MODULE_9__.e)(this.field),disabled=null!==(_b=null!==(_a=this.disabled)&&void 0!==_a?_a:settings.disabled)&&void 0!==_b&&_b;return console.log("Payment field",settings),Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.h)(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.b,{class:{focused:this.focused,disabled:disabled}},Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.h)("button",{class:{hide:this.signed}},"$"),this.signed?Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.h)("div",{class:"frame"}):Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.h)("div",{style:{display:"none"}}),Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_8__.h)("img",{width:"100%",height:"100%",src:this.signatureUrl}))}}]),VerdocsFieldPayment}();VerdocsFieldPayment.style='verdocs-field-payment{font-family:"Inter", -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", sans-serif;width:24px;height:24px;display:block;font-size:11px;position:relative;border:1px solid #cfa;background-color:transparent;-webkit-transform-origin:bottom left;transform-origin:bottom left}verdocs-field-payment.disabled{opacity:0.5}verdocs-field-payment button,verdocs-field-payment div{-webkit-box-sizing:border-box;box-sizing:border-box}verdocs-field-payment button{color:rgba(0, 0, 0, 0.87);font-weight:500;-webkit-transform-origin:0 0;transform-origin:0 0;height:100%;width:100%;background:none;font-size:11px}verdocs-field-payment button.hide{display:none}verdocs-field-payment input{float:left;font-family:Arial, sans-serif}verdocs-field-payment select{position:absolute;font-family:Arial, sans-serif;background:linear-gradient(55deg, transparent 50%, #333 50%), linear-gradient(125deg, #333 50%, transparent 50%), linear-gradient(to right, transparent, transparent);background-position:calc(100% - 7px) 4px, calc(100% - 3px) 4px, 100% 0;background-size:5px 5px, 5px 5px, 2.5em 2.5em;background-repeat:no-repeat;-webkit-appearance:none;-moz-appearance:none;appearance:none}verdocs-field-payment .frame{width:100%;height:100%;background-size:contain;text-align:left}verdocs-field-payment .frame img{position:absolute;height:auto;width:100%}verdocs-field-payment.focused{-webkit-animation:verdocs-field-pulse 0.75s 2;animation:verdocs-field-pulse 0.75s 2}'}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL0B2ZXJkb2NzL2pzLXNkay9VdGlscy9GaWVsZHMuanMiLCJ3ZWJwYWNrOi8vL3NyYy91dGlscy91dGlscy50cyIsIndlYnBhY2s6Ly8vc3JjL2NvbXBvbmVudHMvZWxlbWVudHMvdmVyZG9jcy1maWVsZC1wYXltZW50L3ZlcmRvY3MtZmllbGQtcGF5bWVudC5zY3NzIiwid2VicGFjazovLy9zcmMvY29tcG9uZW50cy9lbGVtZW50cy92ZXJkb2NzLWZpZWxkLXBheW1lbnQvdmVyZG9jcy1maWVsZC1wYXltZW50LnRzeCJdLCJuYW1lcyI6WyJyZXNjYWxlIiwiciIsIm4iLCJpbnRlZ2VyU2VxdWVuY2UiLCJzdGFydCIsImNvdW50IiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiXyIsImluZGV4IiwiZnVsbE5hbWVUb0luaXRpYWxzIiwibmFtZSIsInNwbGl0Iiwid29yZCIsImpvaW4iLCJzZXRDb250cm9sU3R5bGVzIiwiZWwiLCJmaWVsZCIsInhTY2FsZSIsInlTY2FsZSIsIm9wdGlvbiIsInNldHRpbmdzIiwic2V0dGluZyIsIngiLCJ5Iiwid2lkdGgiLCJkZWZhdWx0V2lkdGgiLCJ0eXBlIiwiaGVpZ2h0IiwiZGVmYXVsdEhlaWdodCIsIm9wdGlvblNldHRpbmdzIiwidW5kZWZpbmVkIiwib3B0aW9ucyIsInN0eWxlIiwicG9zaXRpb24iLCJsZWZ0IiwiYm90dG9tIiwidHJhbnNmb3JtIiwiZ2V0RmllbGRJZCIsImdldEZpZWxkT3B0aW9uSWQiLCJyZW5kZXJEb2N1bWVudEZpZWxkIiwiZG9jUGFnZSIsInJvbGVJbmRleCIsImhhbmRsZUZpZWxkQ2hhbmdlIiwiZGlzYWJsZWQiLCJlZGl0YWJsZSIsImRyYWdnYWJsZSIsImNvbnRyb2xzRGl2IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNvbnRhaW5lcklkIiwiaWQiLCJleGlzdGluZ0ZpZWxkIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiYXBwZW5kQ2hpbGQiLCJmb3JFYWNoIiwiY2hlY2tib3hJbmRleCIsImNiRWwiLCJidXR0b25JbmRleCIsImNvbnNvbGUiLCJsb2ciLCJnZXRSb2xlSW5kZXgiLCJyb2xlcyIsInJvbGUiLCJpbmRleE9mIiwiZ2V0RmllbGRTZXR0aW5ncyIsInJlcXVpcmVkIiwicmVzdWx0IiwidmFsdWUiLCJWZXJkb2NzRmllbGRQYXltZW50IiwiX2ZpZWxkcyIsInNpZ25hdHVyZUZpbGUiLCJpbml0aWFsRmlsZSIsImZvY3VzT3JkZXJOdW1iZXIiLCJmb2N1c0ZpZWxkTmFtZSIsImFjdGl2ZUVsZW1lbnQiLCJzaG93RXJyb3IiLCJwYWdlTnVtIiwiZmllbGRJbmRleCIsImRpYWxvZ09wZW5lZCIsImNsb3NlQWxsRXJyb3JzIiwiZmllbGRzTWFwIiwiZmllbGRzRm9yQ3VycmVudFNpZ25lciIsImZvbnRTaXplIiwiYXZlcmFnZUZvbnRXaWR0aCIsInJlcXVpcmVkRmllbGRzIiwiY29tcG9uZW50V2lsbExvYWQiLCJ0aGlzIiwicmVjaXBpZW50cyIsImxlbmd0aCIsInByZXBhcmVyIiwiZmluZCIsInByZXBhcmVkTWVzc2FnZSIsInJlbmRlciIsImgiLCJIb3N0IiwiY2xhc3MiLCJmb2N1c2VkIiwiaGlkZSIsInNpZ25lZCIsImRpc3BsYXkiLCJzcmMiLCJzaWduYXR1cmVVcmwiXSwibWFwcGluZ3MiOiJtOUNBcUJPLFNBQVNBLFFBQVFDLEVBQUdDLEdBQ3ZCLE9BQU9ELEVBQUlDLENBQ2YsQyxJQ2hCYUMsZ0JBQWtCLFNBQWxCQSxnQkFBbUJDLE1BQWVDLE9BQWEsT0FDMURDLE1BQU1ELE9BQ0hFLEtBQUssR0FDTEMsS0FBSSxTQUFDQyxFQUFHQyxPQUFLLE9BQUtBLE1BQVFOLEtBQUssS0FFdkJPLG1CQUFxQixTQUFyQkEsbUJBQXNCQyxNQUFZLE9BQzdDQSxLQUNHQyxNQUFNLEtBQ05MLEtBQUksU0FBQU0sTUFBSSxPQUFJQSxLQUFLLEVBQUUsSUFDbkJDLEtBQUssR0FBRSxF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QUFTLEVBQUcsQ0FDakQsSUFBTUMsU0FBV0gsS0FBS0MsV0FBV0csTUFBSyxTQUFBOUYsR0FBQyxNQUFlLGFBQVhBLEVBQUUyQixJQUFtQixJQUNoRW1DLFFBQVFDLElBQUksaUJBQWtCOEIsVUFDMUJBLFdBQ0ZILEtBQUtLLGdCQUFrQixlQUFlRixTQUFvQixVLHdCQXNDaEUsU0FBQUcsUyxVQUNRM0UsU0FBVytDLDBEQUFpQnNCLEtBQUt6RSxPQUNqQzJCLFNBQTZDLFFBQWxDLEdBQWEsUUFBYixHQUFBOEMsS0FBSzlDLGdCQUFRLFVBQUl2QixTQUFTdUIsZ0JBQVEsV0FFbkQsT0FEQWtCLFFBQVFDLElBQUksZ0JBQWlCMUMsVUFFM0I0RSwwREFBQ0Msa0RBQUksQ0FBQ0MsTUFBTyxDQUFDQyxRQUFTVixLQUFLVSxRQUFTeEQsb0JBQ25DcUQsb0VBQVFFLE1BQU8sQ0FBQ0UsS0FBTVgsS0FBS1ksU0FBTyxLQUNqQ1osS0FBS1ksT0FBU0wsaUVBQUtFLE1BQU0sVUFBYUYsaUVBQUtoRSxNQUFPLENBQUNzRSxRQUFTLFVBQzdETixpRUFBS3hFLE1BQU0sT0FBT0csT0FBTyxPQUFPNEUsSUFBS2QsS0FBS2UsZSxLQUcvQyxvQkExSDZCLEcsMEJEZEQsNDdDIiwiZmlsZSI6IjMzLjhhM2M3MzkxLmlmcmFtZS5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZ2V0UlRvcCh5LCBmaWVsZEhlaWdodCwgaVRleHRIZWlnaHQsIHlSYXRpbykge1xuICAgIHJldHVybiBpVGV4dEhlaWdodCAtICh5ICsgZmllbGRIZWlnaHQpICogeVJhdGlvO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFJMZWZ0KHgsIHJhdGlvKSB7XG4gICAgcmV0dXJuIHggKiByYXRpbztcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRSVmFsdWUoeSwgcmF0aW8pIHtcbiAgICByZXR1cm4geSAqIHJhdGlvO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGJsb2JUb0Jhc2U2NChpbWFnZSkge1xuICAgIHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmaWxlUmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZWplY3QobmV3IERPTUV4Y2VwdGlvbignUHJvYmxlbSByZWFkaW5nIGJsb2IuJykpO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJlc29sdmUoZmlsZVJlYWRlci5yZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoaW1hZ2UpO1xuICAgIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHJlc2NhbGUociwgbikge1xuICAgIHJldHVybiByICogbjtcbn1cbiIsIi8vIFRoZXNlIHNob3VsZCBwcm9iYWJseSBhbGwgbW92ZSB0byBKUy1TREtcbmltcG9ydCB7cmVzY2FsZX0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1V0aWxzL0ZpZWxkcyc7XG4vLyBpbXBvcnQge2dldFJHQkF9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9VdGlscy9Db2xvcnMnO1xuaW1wb3J0IHtJVGVtcGxhdGVGaWVsZH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1RlbXBsYXRlcy9UeXBlcyc7XG5pbXBvcnQge0lEb2N1bWVudEZpZWxkfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvRW52ZWxvcGVzL1R5cGVzJztcbmltcG9ydCB7SURvY3VtZW50UGFnZUluZm99IGZyb20gJy4vVHlwZXMnO1xuXG5leHBvcnQgY29uc3QgaW50ZWdlclNlcXVlbmNlID0gKHN0YXJ0OiBudW1iZXIsIGNvdW50OiBudW1iZXIpOiBudW1iZXJbXSA9PlxuICBBcnJheShjb3VudClcbiAgICAuZmlsbCgxKVxuICAgIC5tYXAoKF8sIGluZGV4KSA9PiBpbmRleCArIHN0YXJ0KTtcblxuZXhwb3J0IGNvbnN0IGZ1bGxOYW1lVG9Jbml0aWFscyA9IChuYW1lOiBzdHJpbmcpID0+XG4gIG5hbWVcbiAgICAuc3BsaXQoJyAnKVxuICAgIC5tYXAod29yZCA9PiB3b3JkWzBdKVxuICAgIC5qb2luKCcnKTtcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRXaWR0aCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICBjYXNlICdhdHRhY2htZW50JzpcbiAgICBjYXNlICdwYXltZW50JzpcbiAgICAgIHJldHVybiAyNDtcbiAgICBjYXNlICdjaGVja2JveCc6XG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgIGNhc2UgJ3JhZGlvX2J1dHRvbl9ncm91cCc6XG4gICAgICByZXR1cm4gMTQ7XG4gICAgY2FzZSAnc2lnbmF0dXJlJzpcbiAgICBjYXNlICdpbml0aWFsJzpcbiAgICAgIHJldHVybiA4MjtcbiAgfVxuXG4gIHJldHVybiAxNTA7XG59O1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdEhlaWdodCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICBjYXNlICdhdHRhY2htZW50JzpcbiAgICBjYXNlICdwYXltZW50JzpcbiAgICAgIHJldHVybiAyNDtcbiAgICBjYXNlICdjaGVja2JveCc6XG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgIGNhc2UgJ3JhZGlvX2J1dHRvbl9ncm91cCc6XG4gICAgICByZXR1cm4gMTQ7XG4gICAgY2FzZSAnc2lnbmF0dXJlJzpcbiAgICBjYXNlICdpbml0aWFsJzpcbiAgICAgIHJldHVybiA0MTtcbiAgfVxuXG4gIHJldHVybiA1MDtcbn07XG5cbmV4cG9ydCBjb25zdCBzZXRDb250cm9sU3R5bGVzID0gKGVsOiBIVE1MRWxlbWVudCwgZmllbGQ6IElUZW1wbGF0ZUZpZWxkIHwgSURvY3VtZW50RmllbGQsIHhTY2FsZTogbnVtYmVyLCB5U2NhbGU6IG51bWJlciwgb3B0aW9uPzogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IHNldHRpbmdzID0gKGZpZWxkIGFzIElUZW1wbGF0ZUZpZWxkKS5zZXR0aW5nIHx8IChmaWVsZCBhcyBJRG9jdW1lbnRGaWVsZCkuc2V0dGluZ3M7XG4gIGxldCB7eCA9IDAsIHkgPSAwLCB3aWR0aCA9IGRlZmF1bHRXaWR0aChmaWVsZCksIGhlaWdodCA9IGRlZmF1bHRIZWlnaHQoZmllbGQpfSA9IHNldHRpbmdzO1xuXG4gIGNvbnN0IG9wdGlvblNldHRpbmdzID0gb3B0aW9uICE9PSB1bmRlZmluZWQgJiYgc2V0dGluZ3Mub3B0aW9uc1tvcHRpb25dID8gc2V0dGluZ3Mub3B0aW9uc1tvcHRpb25dIDogbnVsbDtcbiAgaWYgKG9wdGlvblNldHRpbmdzKSB7XG4gICAgeCA9IG9wdGlvblNldHRpbmdzLnggPz8geDtcbiAgICB5ID0gb3B0aW9uU2V0dGluZ3MueSA/PyB5O1xuICAgIHdpZHRoID0gb3B0aW9uU2V0dGluZ3Mud2lkdGggPz8gd2lkdGg7XG4gICAgaGVpZ2h0ID0gb3B0aW9uU2V0dGluZ3MuaGVpZ2h0ID8/IGhlaWdodDtcbiAgfVxuXG4gIGVsLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xuICBlbC5zdHlsZS5oZWlnaHQgPSBgJHtoZWlnaHR9cHhgO1xuICBlbC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gIGVsLnN0eWxlLmxlZnQgPSBgJHtyZXNjYWxlKHhTY2FsZSwgeCl9cHhgO1xuICBlbC5zdHlsZS5ib3R0b20gPSBgJHtyZXNjYWxlKHlTY2FsZSwgeSl9cHhgO1xuICBlbC5zdHlsZS50cmFuc2Zvcm0gPSBgc2NhbGUoJHt4U2NhbGV9LCAke3lTY2FsZX0pYDtcbiAgLy8gZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZmllbGRbJ3JnYmEnXSB8fCBnZXRSR0JBKHJvbGVJbmRleCk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RmllbGRJZCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICByZXR1cm4gYHZlcmRvY3MtZG9jLWZsZC0ke2ZpZWxkLm5hbWV9YDtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRGaWVsZE9wdGlvbklkID0gKGZpZWxkOiBJVGVtcGxhdGVGaWVsZCwgaW5kZXg6IG51bWJlcikgPT4ge1xuICByZXR1cm4gYHZlcmRvY3MtZG9jLWZsZC0ke2ZpZWxkLm5hbWV9LSR7aW5kZXh9YDtcbn07XG5cbmV4cG9ydCBjb25zdCByZW5kZXJEb2N1bWVudEZpZWxkID0gKFxuICBmaWVsZDogSVRlbXBsYXRlRmllbGQsXG4gIGRvY1BhZ2U6IElEb2N1bWVudFBhZ2VJbmZvLFxuICByb2xlSW5kZXg6IG51bWJlcixcbiAgaGFuZGxlRmllbGRDaGFuZ2U6IChmaWVsZDogSVRlbXBsYXRlRmllbGQsIGU6IGFueSwgb3B0aW9uSWQ/OiBzdHJpbmcpID0+IHZvaWQsXG4gIGRpc2FibGVkOiBib29sZWFuLFxuICBlZGl0YWJsZTogYm9vbGVhbiA9IGZhbHNlLFxuICBkcmFnZ2FibGU6IGJvb2xlYW4gPSBmYWxzZSxcbikgPT4ge1xuICBjb25zdCBjb250cm9sc0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRvY1BhZ2UuY29udGFpbmVySWQgKyAnLWNvbnRyb2xzJyk7XG4gIGlmICghY29udHJvbHNEaXYpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICBjYXNlICdhdHRhY2htZW50JzpcbiAgICBjYXNlICdkYXRlJzpcbiAgICBjYXNlICdkcm9wZG93bic6XG4gICAgY2FzZSAnaW5pdGlhbCc6XG4gICAgY2FzZSAncGF5bWVudCc6XG4gICAgY2FzZSAnc2lnbmF0dXJlJzpcbiAgICBjYXNlICd0aW1lc3RhbXAnOlxuICAgIGNhc2UgJ3RleHRhcmVhJzpcbiAgICBjYXNlICd0ZXh0Ym94Jzoge1xuICAgICAgY29uc3QgaWQgPSBnZXRGaWVsZElkKGZpZWxkKTtcbiAgICAgIGNvbnN0IGV4aXN0aW5nRmllbGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgICBpZiAoZXhpc3RpbmdGaWVsZCkge1xuICAgICAgICBzZXRDb250cm9sU3R5bGVzKGV4aXN0aW5nRmllbGQsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGVsOiBhbnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGB2ZXJkb2NzLWZpZWxkLSR7ZmllbGQudHlwZX1gKTtcbiAgICAgIGVsLmZpZWxkID0gZmllbGQ7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2lkJywgaWQpO1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdyb2xlaW5kZXgnLCByb2xlSW5kZXgpO1xuICAgICAgaWYgKGRpc2FibGVkKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgIH1cbiAgICAgIGlmIChlZGl0YWJsZSkge1xuICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2VkaXRhYmxlJywgdHJ1ZSk7XG4gICAgICB9XG4gICAgICBpZiAoZHJhZ2dhYmxlKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJywgdHJ1ZSk7XG4gICAgICB9XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdmaWVsZENoYW5nZScsIGUgPT4gaGFuZGxlRmllbGRDaGFuZ2UoZmllbGQsIGUpKTtcbiAgICAgIHNldENvbnRyb2xTdHlsZXMoZWwsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUpO1xuICAgICAgY29udHJvbHNEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuXG4gICAgICByZXR1cm4gZWw7XG4gICAgfVxuXG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgICAgZmllbGQuc2V0dGluZy5vcHRpb25zLmZvckVhY2goKF8sIGNoZWNrYm94SW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSBnZXRGaWVsZE9wdGlvbklkKGZpZWxkLCBjaGVja2JveEluZGV4KTtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdGaWVsZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICAgICAgaWYgKGV4aXN0aW5nRmllbGQpIHtcbiAgICAgICAgICBzZXRDb250cm9sU3R5bGVzKGV4aXN0aW5nRmllbGQsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNiRWw6IGFueSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYHZlcmRvY3MtZmllbGQtY2hlY2tib3hgKTtcbiAgICAgICAgY2JFbC5maWVsZCA9IGZpZWxkO1xuICAgICAgICBjYkVsLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XG4gICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdyb2xlaW5kZXgnLCByb2xlSW5kZXgpO1xuICAgICAgICBjYkVsLnNldEF0dHJpYnV0ZSgnb3B0aW9uJywgY2hlY2tib3hJbmRleCk7XG4gICAgICAgIGlmIChkaXNhYmxlZCkge1xuICAgICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGNiRWwuYWRkRXZlbnRMaXN0ZW5lcignZmllbGRDaGFuZ2UnLCBlID0+IGhhbmRsZUZpZWxkQ2hhbmdlKGZpZWxkLCBlKSk7XG4gICAgICAgIHNldENvbnRyb2xTdHlsZXMoY2JFbCwgZmllbGQsIGRvY1BhZ2UueFNjYWxlLCBkb2NQYWdlLnlTY2FsZSk7XG4gICAgICAgIGNvbnRyb2xzRGl2LmFwcGVuZENoaWxkKGNiRWwpO1xuXG4gICAgICAgIHJldHVybiBjYkVsO1xuICAgICAgfSk7XG5cbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAncmFkaW9fYnV0dG9uX2dyb3VwJzpcbiAgICAgIGZpZWxkLnNldHRpbmcub3B0aW9ucy5mb3JFYWNoKChfLCBidXR0b25JbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBpZCA9IGdldEZpZWxkT3B0aW9uSWQoZmllbGQsIGJ1dHRvbkluZGV4KTtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdGaWVsZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICAgICAgaWYgKGV4aXN0aW5nRmllbGQpIHtcbiAgICAgICAgICBzZXRDb250cm9sU3R5bGVzKGV4aXN0aW5nRmllbGQsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNiRWw6IGFueSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYHZlcmRvY3MtZmllbGQtcmFkaW8tYnV0dG9uYCk7XG4gICAgICAgIGNiRWwuZmllbGQgPSBmaWVsZDtcbiAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ2lkJywgaWQpO1xuICAgICAgICBjYkVsLnNldEF0dHJpYnV0ZSgncm9sZWluZGV4Jywgcm9sZUluZGV4KTtcbiAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ29wdGlvbicsIGJ1dHRvbkluZGV4KTtcbiAgICAgICAgaWYgKGRpc2FibGVkKSB7XG4gICAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2JFbC5hZGRFdmVudExpc3RlbmVyKCdmaWVsZENoYW5nZScsIGUgPT4gaGFuZGxlRmllbGRDaGFuZ2UoZmllbGQsIGUpKTtcbiAgICAgICAgc2V0Q29udHJvbFN0eWxlcyhjYkVsLCBmaWVsZCwgZG9jUGFnZS54U2NhbGUsIGRvY1BhZ2UueVNjYWxlLCBidXR0b25JbmRleCk7XG4gICAgICAgIGNvbnRyb2xzRGl2LmFwcGVuZENoaWxkKGNiRWwpO1xuXG4gICAgICAgIHJldHVybiBjYkVsO1xuICAgICAgfSk7XG5cbiAgICAgIGJyZWFrO1xuXG4gICAgLy8gY2FzZSAnYXR0YWNobWVudCc6XG4gICAgLy8gICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZlcmRvY3MtZmllbGQtYXR0YWNobWVudCcpO1xuICAgIC8vICAgZWwuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHJlc3VsdCB8fCAnJyk7XG4gICAgLy8gICBicmVhaztcbiAgICAvLyBjYXNlICdwYXltZW50JzpcbiAgICAvLyAgIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmVyZG9jcy1maWVsZC1wYXltZW50Jyk7XG4gICAgLy8gICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgY29uc29sZS5sb2coJ1tQUkVWSUVXXSBTa2lwcGluZyB1bnN1cHBvcnRlZCBmaWVsZCB0eXBlJywgZmllbGQpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSb2xlSW5kZXggPSAocm9sZXM6IHN0cmluZ1tdLCByb2xlOiBzdHJpbmcpID0+IHJvbGVzLmluZGV4T2Yocm9sZSkgfHwgMDtcblxuLy8gVE9ETzogV2UgY2FuIGNsZWFuIHRoaXMgdXAgYSBsb3QgaWYgd2UgYWx0ZXIgdGhlIEFQSSB0byBlbWl0IGJvdGggc2V0dGluZyBhbmQgc2V0dGluZ3MgcmVnYXJkbGVzcyBvZiB0aGUgc291cmNlIHR5cGUsXG4vLyAgIGJ1dCB0aGVuIG1lcmdlIHRoZSBTREsgdHlwZXMgdG8gZW5jb3VyYWdlIGRldmVsb3BlcnMgdG8gdXNlIGp1c3QgYHNldHRpbmdzYC5cbmV4cG9ydCBjb25zdCBnZXRGaWVsZFNldHRpbmdzID0gKGZpZWxkOiBJVGVtcGxhdGVGaWVsZCB8IElEb2N1bWVudEZpZWxkKSA9PiB7XG4gIGlmICgoZmllbGQgYXMgSVRlbXBsYXRlRmllbGQpLnNldHRpbmcpIHtcbiAgICByZXR1cm4gKGZpZWxkIGFzIElUZW1wbGF0ZUZpZWxkKS5zZXR0aW5nO1xuICB9XG5cbiAgaWYgKChmaWVsZCBhcyBJRG9jdW1lbnRGaWVsZCkuc2V0dGluZ3MpIHtcbiAgICByZXR1cm4gKGZpZWxkIGFzIElEb2N1bWVudEZpZWxkKS5zZXR0aW5ncztcbiAgfVxuXG4gIHJldHVybiB7eDogMCwgeTogMCwgcmVxdWlyZWQ6IGZhbHNlLCBkaXNhYmxlZDogZmFsc2UsIHJlc3VsdDogJycsIHZhbHVlOiAnJ307XG59O1xuIiwiQGltcG9ydCAnLi4vLi4vLi4vdGhlbWUuc2Nzcyc7XG5cbnZlcmRvY3MtZmllbGQtcGF5bWVudCB7XG4gIGZvbnQtZmFtaWx5OiAkdmVyZG9jcy1wcmltYXJ5LWZvbnQ7XG4gIHdpZHRoOiAyNHB4O1xuICBoZWlnaHQ6IDI0cHg7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICBmb250LXNpemU6IDExcHg7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgYm9yZGVyOiAxcHggc29saWQgI2NmYTtcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XG4gIHRyYW5zZm9ybS1vcmlnaW46IGJvdHRvbSBsZWZ0O1xuXG4gICYuZGlzYWJsZWQge1xuICAgIG9wYWNpdHk6IDAuNTtcbiAgfVxuXG4gIGJ1dHRvbixcbiAgZGl2IHtcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICB9XG5cbiAgYnV0dG9uIHtcbiAgICBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjg3KTtcbiAgICBmb250LXdlaWdodDogNTAwO1xuICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDtcbiAgICAvL2JhY2tncm91bmQtY29sb3I6IHJnYmEoMjI1LCAyNTUsIDI1NSwgMC41KTtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICBmb250LXNpemU6IDExcHg7XG5cbiAgICAmLmhpZGUge1xuICAgICAgZGlzcGxheTogbm9uZTtcbiAgICB9XG4gIH1cblxuICBpbnB1dCB7XG4gICAgZmxvYXQ6IGxlZnQ7XG4gICAgZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmO1xuICB9XG5cbiAgc2VsZWN0IHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmO1xuICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCg1NWRlZywgdHJhbnNwYXJlbnQgNTAlLCAjMzMzIDUwJSksIGxpbmVhci1ncmFkaWVudCgxMjVkZWcsICMzMzMgNTAlLCB0cmFuc3BhcmVudCA1MCUpLCBsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsIHRyYW5zcGFyZW50LCB0cmFuc3BhcmVudCk7XG4gICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2FsYygxMDAlIC0gN3B4KSA0cHgsIGNhbGMoMTAwJSAtIDNweCkgNHB4LCAxMDAlIDA7XG4gICAgYmFja2dyb3VuZC1zaXplOiA1cHggNXB4LCA1cHggNXB4LCAyLjVlbSAyLjVlbTtcbiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICAgIGFwcGVhcmFuY2U6IG5vbmU7XG4gIH1cblxuICAuZnJhbWUge1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbiAgICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XG4gICAgdGV4dC1hbGlnbjogbGVmdDtcblxuICAgIGltZyB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICB3aWR0aDogMTAwJTtcbiAgICB9XG4gIH1cblxuICAmLmZvY3VzZWQge1xuICAgIGFuaW1hdGlvbjogdmVyZG9jcy1maWVsZC1wdWxzZSAwLjc1cyAyO1xuICB9XG59XG4iLCJpbXBvcnQge0lUZW1wbGF0ZUZpZWxkfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzL1R5cGVzJztcbmltcG9ydCB7SURvY3VtZW50RmllbGQsIElSZWNpcGllbnR9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9FbnZlbG9wZXMvVHlwZXMnO1xuaW1wb3J0IHtDb21wb25lbnQsIGgsIEhvc3QsIFByb3AsIEV2ZW50LCBFdmVudEVtaXR0ZXIsIFN0YXRlfSBmcm9tICdAc3RlbmNpbC9jb3JlJztcbmltcG9ydCB7Z2V0RmllbGRTZXR0aW5nc30gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuXG4vKipcbiAqIERpc3BsYXlzIGEgc2lnbmF0dXJlIGZpZWxkLiBWYXJpb3VzIGZpZWxkIHR5cGVzIGFyZSBzdXBwb3J0ZWQsIGluY2x1ZGluZyB0cmFkaXRpb25hbCBTaWduYXR1cmUgYW5kIEluaXRpYWxzIHR5cGVzIGFzIHdlbGwgYXNcbiAqIGlucHV0IHR5cGVzIGxpa2UgdGV4dCBhbmQgY2hlY2tib3guXG4gKi9cbkBDb21wb25lbnQoe1xuICB0YWc6ICd2ZXJkb2NzLWZpZWxkLXBheW1lbnQnLFxuICBzdHlsZVVybDogJ3ZlcmRvY3MtZmllbGQtcGF5bWVudC5zY3NzJyxcbiAgc2hhZG93OiBmYWxzZSxcbn0pXG5leHBvcnQgY2xhc3MgVmVyZG9jc0ZpZWxkUGF5bWVudCB7XG4gIC8qKlxuICAgKiBUaGUgZG9jdW1lbnQgb3IgdGVtcGxhdGUgZmllbGQgdG8gZGlzcGxheS5cbiAgICovXG4gIEBQcm9wKCkgZmllbGQ6IElEb2N1bWVudEZpZWxkIHwgSVRlbXBsYXRlRmllbGQgfCBudWxsID0gbnVsbDtcblxuICAvKipcbiAgICogVGhlIHJlY2lwaWVudCBjb21wbGV0aW5nIHRoZSBmb3JtLCBpZiBrbm93bi5cbiAgICovXG4gIEBQcm9wKCkgcmVjaXBpZW50PzogSVJlY2lwaWVudDtcblxuICAvKipcbiAgICogSWYgc2V0LCBvdmVycmlkZXMgdGhlIGZpZWxkJ3Mgc2V0dGluZ3Mgb2JqZWN0LiBQcmltYXJpbHkgdXNlZCB0byBzdXBwb3J0IFwicHJldmlld1wiIG1vZGVzIHdoZXJlIGFsbCBmaWVsZHMgYXJlIGRpc2FibGVkLlxuICAgKi9cbiAgQFByb3AoKSBkaXNhYmxlZD86IGJvb2xlYW4gPSBmYWxzZTtcblxuICBAUHJvcCgpIGZpZWxkczogYW55W107XG4gIEBQcm9wKCkgcGFnZU51bTogbnVtYmVyO1xuICBAUHJvcCgpIHJvbGVOYW1lOiBzdHJpbmc7XG4gIEBQcm9wKCkgZmllbGRJZDogc3RyaW5nO1xuICBAUHJvcCgpIHJlY2lwaWVudHM6IGFueTtcbiAgQFByb3AoKSBzZWxlY3RlZFJvbGVOYW1lOiBzdHJpbmc7XG4gIEBQcm9wKCkgcGRmUGFnZXM6IGFueVtdO1xuICBAUHJvcCgpIGN1cnJlbnRTaWduYXR1cmU6IHN0cmluZztcbiAgQFByb3AoKSBjdXJyZW50U2lnbmF0dXJlSWQ6IHN0cmluZztcbiAgQFByb3AoKSBjdXJyZW50SW5pdGlhbDogc3RyaW5nO1xuICBAUHJvcCgpIGN1cnJlbnRJbml0aWFsSWQ6IHN0cmluZztcbiAgQFByb3AoKSBmb2N1c2VkOiBib29sZWFuID0gZmFsc2U7XG4gIEBQcm9wKCkgc2lnbmVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgQEV2ZW50KHtjb21wb3NlZDogdHJ1ZX0pIHNpZ25hdHVyZUNvbXBsZXRlOiBFdmVudEVtaXR0ZXI8c3RyaW5nPjtcblxuICBARXZlbnQoe2NvbXBvc2VkOiB0cnVlfSkgaW5pdGlhbENvbXBsZXRlOiBFdmVudEVtaXR0ZXI8c3RyaW5nPjtcblxuICBAU3RhdGUoKSBwcmVwYXJlZE1lc3NhZ2U6IHN0cmluZztcbiAgQFN0YXRlKCkgc2lnbmF0dXJlVXJsOiBzdHJpbmcgPSAnJztcblxuICBfZmllbGRzOiBhbnlbXSA9IFtdO1xuICAvLyBlbnZlbG9wZUZpZWxkc0Zvcm1Hcm91cDogRm9ybUdyb3VwO1xuICBzaWduYXR1cmVGaWxlOiBhbnkgPSBudWxsO1xuICBpbml0aWFsRmlsZTogYW55ID0gbnVsbDtcbiAgdG9kYXk6IHN0cmluZztcbiAgZm9jdXNPcmRlck51bWJlciA9IC0xO1xuICBmb2N1c0ZpZWxkTmFtZTogc3RyaW5nID0gJyc7XG4gIHRpbWVyOiBhbnk7XG4gIGFjdGl2ZUVsZW1lbnQgPSBudWxsO1xuICBzaG93RXJyb3IgPSB7XG4gICAgcGFnZU51bTogLTEsXG4gICAgZmllbGRJbmRleDogLTEsXG4gICAgdHlwZTogbnVsbCxcbiAgfTtcbiAgZGlhbG9nT3BlbmVkID0gZmFsc2U7XG4gIGNsb3NlQWxsRXJyb3JzID0gZmFsc2U7XG4gIGZpZWxkc01hcDogYW55ID0ge307XG4gIG1vZGU6IHN0cmluZztcblxuICBmaWVsZHNGb3JDdXJyZW50U2lnbmVyOiBhbnlbXSA9IFtdO1xuXG4gIHZhbGlkYXRvcnM7XG4gIGZvbnRTaXplID0gMTE7XG4gIGF2ZXJhZ2VGb250V2lkdGggPSA1O1xuICByZXF1aXJlZEZpZWxkczogYW55W10gPSBbXTtcblxuICBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICAvLyBMb2FkIHZhbGlkYXRvcnNcbiAgICAvLyBMb2FkIGZpZWxkc1xuICAgIC8vIEdldCByb2xlIG5hbWVzXG4gICAgY29uc29sZS5sb2coJ3NpZ24gZmllbGQnLCB0aGlzLmZpZWxkKTtcblxuICAgIGlmICh0aGlzLnJlY2lwaWVudHMgJiYgdGhpcy5yZWNpcGllbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHByZXBhcmVyID0gdGhpcy5yZWNpcGllbnRzLmZpbmQociA9PiByLnR5cGUgPT09ICdwcmVwYXJlcicpO1xuICAgICAgY29uc29sZS5sb2coJ0ZvdW5kIHByZXBhcmVyJywgcHJlcGFyZXIpO1xuICAgICAgaWYgKHByZXBhcmVyKSB7XG4gICAgICAgIHRoaXMucHJlcGFyZWRNZXNzYWdlID0gYFByZXBhcmVkIGJ5ICR7cHJlcGFyZXJbJ2Z1bGxfbmFtZSddfWA7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gW3RhYkluZGV4XT1cImZpZWxkLnJvbGUgIT09IHJvbGVOYW1lID8gLTEgOiAxXCJcbiAgLy8gW25nU3R5bGVdPVwiZmllbGQuZWxlbWVudF9zdHlsZVwiXG4gIC8vIFt2YWx1ZV09XCJmaWVsZC52YWx1ZVwiXG4gIC8vIChjbGljayk9XCJpbml0aWF0ZVNpZ24oZmllbGQpXCJcbiAgLy8gKGJsdXIpPVwidmFsaWRhdGVDaGFuZ2VzKGZpZWxkKVwiXG4gIC8vIFtkaXNhYmxlZF09XCJmaWVsZC5yb2xlIT09cm9sZU5hbWVcIlxuICAvLyBbaWRdPVwiZmllbGQua2V5XCJcblxuICAvLyA8YnV0dG9uIF9uZ2NvbnRlbnQtYXBwLXJvb3QtYzM0Mj1cIlwiIGNsYXNzPVwiZW52ZWxvcGVfX2ZpZWxkXCIgdGFiaW5kZXg9XCIxXCIgbmctcmVmbGVjdC1uZy1zdHlsZT1cIltvYmplY3QgT2JqZWN0XVwiXG4gIC8vIG5nLXJlZmxlY3QtbmctY2xhc3M9XCJbb2JqZWN0IE9iamVjdF1cIiB2YWx1ZT1cIlwiIGlkPVwic2lnbmF0dXJlUDUtMVwiXG4gIC8vIHN0eWxlPVwiaGVpZ2h0OiAxMDAlOyB3aWR0aDogMTAwJTsgYmFja2dyb3VuZDogbm9uZTsgZm9udC1zaXplOiAxMXB4OyBib3JkZXI6IDFweCBzb2xpZCByZ2IoMjA0LCAwLCAwKTtcIj4gU2lnbmF0dXJlIDwvYnV0dG9uPlxuXG4gIC8vICAgICBib3R0b206IDIyOS4zMzNcbiAgLy8gcHhcbiAgLy8gO1xuICAvLyAgICAgbGVmdDogMTY5LjMzM1xuICAvLyBweFxuICAvLyA7XG4gIC8vICAgICBoZWlnaHQ6IDQxXG4gIC8vIHB4XG4gIC8vIDtcbiAgLy8gICAgIHdpZHRoOiA4MlxuICAvLyBweFxuICAvLyA7XG4gIC8vICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDE1NiwgMzksIDE3NiwgMC40KTtcbiAgLy8gICAgIHRyYW5zZm9ybTogc2NhbGUoMS4zMzMzMywgMS4zMzMzMyk7XG4gIC8vIH1cbiAgLy8gPHN0eWxlPlxuICAvLyAuZW52ZWxvcGVfX2l0ZW1bX25nY29udGVudC1hcHAtcm9vdC1jMzQyXSB7XG4gIC8vICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIC8vICAgICB0cmFuc2Zvcm0tb3JpZ2luOiBib3R0b20gbGVmdDtcbiAgLy8gICAgIG9wYWNpdHk6IDE7XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0RmllbGRTZXR0aW5ncyh0aGlzLmZpZWxkKTtcbiAgICBjb25zdCBkaXNhYmxlZCA9IHRoaXMuZGlzYWJsZWQgPz8gc2V0dGluZ3MuZGlzYWJsZWQgPz8gZmFsc2U7XG4gICAgY29uc29sZS5sb2coJ1BheW1lbnQgZmllbGQnLCBzZXR0aW5ncyk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxIb3N0IGNsYXNzPXt7Zm9jdXNlZDogdGhpcy5mb2N1c2VkLCBkaXNhYmxlZH19PlxuICAgICAgICA8YnV0dG9uIGNsYXNzPXt7aGlkZTogdGhpcy5zaWduZWR9fT4kPC9idXR0b24+XG4gICAgICAgIHt0aGlzLnNpZ25lZCA/IDxkaXYgY2xhc3M9XCJmcmFtZVwiIC8+IDogPGRpdiBzdHlsZT17e2Rpc3BsYXk6ICdub25lJ319IC8+fVxuICAgICAgICA8aW1nIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiBzcmM9e3RoaXMuc2lnbmF0dXJlVXJsfSAvPlxuICAgICAgPC9Ib3N0PlxuICAgICk7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=