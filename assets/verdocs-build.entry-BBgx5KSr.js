import{m as r,H as v,o as x,r as g,n as p}from"./components-BUY51Sj4.js";import{V as b}from"./index-FOFzXDN2.js";import{g as y}from"./TemplateStore-df5484bb-DdHXR8_e.js";import{S as w}from"./errors-887f1e88-DR85jTO9.js";import"./TemplateRoleStore-ddc3b96f-B5kZ-UY0.js";import"./TemplateFieldStore-d7516adf-DcKvNlmt.js";import"./index-7456b04f-WYt0v2to.js";import"./index-CDs2tPxN.js";import"./index-BXagdh-V.js";import"./iframe-BIHgOnMp.js";import"../sb-preview/runtime.js";import"./index-296aabaf-RiVWanv8.js";var u=function(l,t,e,o){function d(n){return n instanceof e?n:new e(function(a){a(n)})}return new(e||(e=Promise))(function(n,a){function c(s){try{i(o.next(s))}catch(m){a(m)}}function h(s){try{i(o.throw(s))}catch(m){a(m)}}function i(s){s.done?n(s.value):d(s.value).then(c,h)}i((o=o.apply(l,t||[])).next())})},f=function(l,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,d,n,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(i){return function(s){return h([i,s])}}function h(i){if(o)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(e=0)),e;)try{if(o=1,d&&(n=i[0]&2?d.return:i[0]?d.throw||((n=d.return)&&n.call(d),0):d.next)&&!(n=n.call(d,i[1])).done)return n;switch(d=0,n&&(i=[i[0]&2,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return e.label++,{value:i[1],done:!1};case 5:e.label++,d=i[1],i=[0];continue;case 7:i=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(i[0]===6||i[0]===2)){e=0;continue}if(i[0]===3&&(!n||i[1]>n[0]&&i[1]<n[3])){e.label=i[1];break}if(i[0]===6&&e.label<n[1]){e.label=n[1],n=i;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(i);break}n[2]&&e.ops.pop(),e.trys.pop();continue}i=t.call(l,e)}catch(s){i=[6,s],d=0}finally{o=n=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},I='@-webkit-keyframes verdocs-field-pulse{0%{background-color:rgba(0, 0, 0, 0.35)}50%{background-color:rgba(0, 0, 0, 0)}100%{background-color:rgba(0, 0, 0, 0.35)}}@keyframes verdocs-field-pulse{0%{background-color:rgba(0, 0, 0, 0.35)}50%{background-color:rgba(0, 0, 0, 0)}100%{background-color:rgba(0, 0, 0, 0.35)}}verdocs-build{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font-family:"Inter", -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", sans-serif}verdocs-build .content{-ms-flex:1;flex:1;gap:20px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-direction:column;flex-direction:column}verdocs-build verdocs-template-attachments,verdocs-build verdocs-template-roles{margin:20px}verdocs-build verdocs-template-fields{border-top:1px solid #777777}verdocs-build verdocs-template-attachments{padding:20px;background:#ffffff}verdocs-build verdocs-template-fields{width:100%}verdocs-build verdocs-preview{-ms-flex:1;flex:1}verdocs-build .preview-container{-ms-flex-direction:row;flex-direction:row;display:-ms-flexbox;display:flex;width:100%;background-color:#eeeeee;max-height:100%}@media all and (max-width: 450px){verdocs-build .preview-container{-ms-flex-direction:column;flex-direction:column}}verdocs-build .preview-send-wrapper{display:-ms-flexbox;display:flex;-ms-flex:0 0 300px;flex:0 0 300px;background-color:#ffffff;-webkit-box-shadow:1px 1px 6px -2px rgba(0, 0, 0, 0.4980392157);box-shadow:1px 1px 6px -2px rgba(0, 0, 0, 0.4980392157)}@media all and (max-width: 450px){verdocs-build .preview-send-wrapper{-ms-flex:0;flex:0}}verdocs-build .preview-preview-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-pack:center;justify-content:center;overflow-y:scroll}',U=I,k=function(){function l(t){g(this,t),this.sdkError=p(this,"sdkError",7),this.stepChanged=p(this,"stepChanged",7),this.send=p(this,"send",7),this.templateUpdated=p(this,"templateUpdated",7),this.templateCreated=p(this,"templateCreated",7),this.rolesUpdated=p(this,"rolesUpdated",7),this.endpoint=b.getDefault(),this.templateId=null,this.step="preview",this.store=null}return l.prototype.onTemplateIdChanged=function(t){console.log("Template ID changed",t),this.loadTemplate(t).catch(function(e){return console.log("Unknown Error",e)})},l.prototype.onStepChanged=function(t){console.log("Step changed",t),this.loadTemplate(this.templateId).catch(function(e){return console.log("Unknown Error",e)})},l.prototype.componentWillLoad=function(){return u(this,void 0,void 0,function(){var t,e,o;return f(this,function(d){try{if(this.endpoint.loadSession(),!this.templateId)return console.log("[BUILD] No template ID, activating upload mode"),this.step="attachments",[2];if(!this.endpoint.session)return console.log("[BUILD] Unable to start builder session, must be authenticated"),[2];this.loadTemplate(this.templateId).catch(function(n){return console.log("[BUILD] Unable to load template",n)})}catch(n){console.log("[BUILD] Error loading template",n),(t=this.sdkError)===null||t===void 0||t.emit(new w(n.message,(e=n.response)===null||e===void 0?void 0:e.status,(o=n.response)===null||o===void 0?void 0:o.data))}return[2]})})},l.prototype.loadTemplate=function(t){return u(this,void 0,void 0,function(){var e;return f(this,function(o){switch(o.label){case 0:return t?(console.log("Loading store",t),e=this,[4,y(this.endpoint,t,!1)]):[3,2];case 1:e.store=o.sent(),o.label=2;case 2:return[2]}})})},l.prototype.handleCancel=function(t){console.log("Cancel",t.detail),this.step="preview"},l.prototype.handleTemplateCreated=function(t){return u(this,void 0,void 0,function(){var e;return f(this,function(o){switch(o.label){case 0:return[4,this.loadTemplate(t)];case 1:return o.sent(),this.templateId=t,this.step="roles",(e=this.stepChanged)===null||e===void 0||e.emit("roles"),[2]}})})},l.prototype.handleRolesUpdated=function(t){return u(this,void 0,void 0,function(){var e;return f(this,function(o){return(e=this.templateUpdated)===null||e===void 0||e.emit(t.detail),[2]})})},l.prototype.handleTemplateUpdated=function(t){return u(this,void 0,void 0,function(){var e;return f(this,function(o){return(e=this.templateUpdated)===null||e===void 0||e.emit(t.detail),[2]})})},l.prototype.handleAttachmentsNext=function(){var t;this.step="roles",(t=this.stepChanged)===null||t===void 0||t.emit("roles")},l.prototype.handleRolesNext=function(){var t;this.step="fields",(t=this.stepChanged)===null||t===void 0||t.emit("fields")},l.prototype.handleStepChanged=function(t){var e;console.log("osc",t),this.step=t,(e=this.stepChanged)===null||e===void 0||e.emit(t)},l.prototype.render=function(){var t=this;return this.endpoint.session?this.store?(console.log("[BUILD] Rendering build view",this.templateId,this.step,["attachments","roles","settings","fields","preview"].indexOf(this.step)),r(v,null,r("div",{class:"content"},r("verdocs-template-build-tabs",{endpoint:this.endpoint,templateId:this.templateId,step:this.step,onSdkError:function(e){var o;return(o=t.sdkError)===null||o===void 0?void 0:o.emit(e.detail)},onStepChanged:function(e){return t.handleStepChanged(e.detail)}}),this.step==="attachments"&&r("verdocs-template-attachments",{templateId:this.templateId,endpoint:this.endpoint,onExit:function(e){return t.handleCancel(e)},onNext:function(){return t.handleAttachmentsNext()},onTemplateUpdated:function(e){return t.handleTemplateUpdated(e)}}),this.step==="roles"&&r("verdocs-template-roles",{templateId:this.templateId,endpoint:this.endpoint,onExit:function(e){return t.handleCancel(e)},onNext:function(){return t.handleRolesNext()},onRolesUpdated:function(e){return t.handleRolesUpdated(e)}}),this.step==="settings"&&r("div",{style:{flexDirection:"column",gap:"20px",display:"flex",maxWidth:"400px",margin:"20px"}},r("verdocs-template-name",{templateId:this.templateId,endpoint:this.endpoint,style:{backgroundColor:"#ffffff",padding:"20px"},onTemplateUpdated:function(e){return t.handleTemplateUpdated(e)}}),r("verdocs-template-reminders",{templateId:this.templateId,endpoint:this.endpoint,style:{backgroundColor:"#ffffff",padding:"20px"},onTemplateUpdated:function(e){return t.handleTemplateUpdated(e)}}),r("verdocs-template-visibility",{templateId:this.templateId,endpoint:this.endpoint,style:{backgroundColor:"#ffffff",padding:"20px"},onTemplateUpdated:function(e){return t.handleTemplateUpdated(e)}})),this.step==="fields"&&r("verdocs-template-fields",{templateId:this.templateId,endpoint:this.endpoint,onTemplateUpdated:function(e){return t.handleTemplateUpdated(e)}}),this.step==="preview"&&r("div",{class:"preview-container"},r("div",{class:"preview-send-wrapper"},r("verdocs-send",{templateId:this.templateId,endpoint:this.endpoint,onSend:function(e){var o;return(o=t.send)===null||o===void 0?void 0:o.emit(e.detail)},style:{width:"100%"}})),r("div",{class:"preview-preview-wrapper"},r("verdocs-preview",{templateId:this.templateId,endpoint:this.endpoint,style:{display:"flex",flex:"1",maxWidth:"1000px"}})))))):(console.log("[BUILD] No template ID, rendering created view"),r(v,null,r("div",{class:"content"},r("verdocs-template-build-tabs",{endpoint:this.endpoint,templateId:this.templateId,step:"attachments",onSdkError:function(e){var o;return(o=t.sdkError)===null||o===void 0?void 0:o.emit(e.detail)},onStepChanged:function(e){return t.handleStepChanged(e.detail)}}),r("verdocs-template-create",{endpoint:this.endpoint,onExit:function(e){return t.handleCancel(e)},onNext:function(){return t.handleAttachmentsNext()},onTemplateCreated:function(e){return t.handleTemplateCreated(e.detail.templateId)}})))):r(v,null,r("verdocs-component-error",{message:"You must be authenticated to use this module."}))},Object.defineProperty(l.prototype,"el",{get:function(){return x(this)},enumerable:!1,configurable:!0}),Object.defineProperty(l,"watchers",{get:function(){return{templateId:["onTemplateIdChanged"],step:["onStepChanged"]}},enumerable:!1,configurable:!0}),l}();k.style=U;export{k as verdocs_build};
