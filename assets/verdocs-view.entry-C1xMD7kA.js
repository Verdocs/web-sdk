import{m as c,H as w,F as I,o as E,r as k,n as v}from"./components-BUY51Sj4.js";import{ah as x,ai as b,j as V,n as D,i as W,V as z}from"./index-FOFzXDN2.js";import{s as S}from"./utils-61c1093b-BdPfu6ZN.js";import{S as y}from"./errors-887f1e88-DR85jTO9.js";import"./index-CDs2tPxN.js";import"./index-BXagdh-V.js";import"./iframe-BIHgOnMp.js";import"../sb-preview/runtime.js";import"./Types-e4a6eba5-DhtnXEHy.js";import"./index-0329eed3-CmPFFxNR.js";var h=function(p,r,o,l){function s(e){return e instanceof o?e:new o(function(a){a(e)})}return new(o||(o=Promise))(function(e,a){function i(t){try{n(l.next(t))}catch(u){a(u)}}function d(t){try{n(l.throw(t))}catch(u){a(u)}}function n(t){t.done?e(t.value):s(t.value).then(i,d)}n((l=l.apply(p,r||[])).next())})},f=function(p,r){var o={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},l,s,e,a;return a={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(n){return function(t){return d([n,t])}}function d(n){if(l)throw new TypeError("Generator is already executing.");for(;a&&(a=0,n[0]&&(o=0)),o;)try{if(l=1,s&&(e=n[0]&2?s.return:n[0]?s.throw||((e=s.return)&&e.call(s),0):s.next)&&!(e=e.call(s,n[1])).done)return e;switch(s=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,s=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(e=o.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){o=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){o.label=n[1];break}if(n[0]===6&&o.label<e[1]){o.label=e[1],e=n;break}if(e&&o.label<e[2]){o.label=e[2],o.ops.push(n);break}e[2]&&o.ops.pop(),o.trys.pop();continue}n=r.call(p,o)}catch(t){n=[6,t],s=0}finally{l=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},_='@-webkit-keyframes verdocs-field-pulse{0%{background-color:rgba(0, 0, 0, 0.35)}50%{background-color:rgba(0, 0, 0, 0)}100%{background-color:rgba(0, 0, 0, 0.35)}}@keyframes verdocs-field-pulse{0%{background-color:rgba(0, 0, 0, 0.35)}50%{background-color:rgba(0, 0, 0, 0)}100%{background-color:rgba(0, 0, 0, 0.35)}}verdocs-view{display:-ms-flexbox;display:flex;overflow:hidden;min-height:600px;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-direction:column;flex-direction:column;-webkit-box-sizing:border-box;box-sizing:border-box;font-family:"Inter", -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", sans-serif}verdocs-view div,verdocs-view canvas{-webkit-box-sizing:border-box;box-sizing:border-box}verdocs-view .document{-ms-flex:1;flex:1;width:100%;height:100%;display:-ms-flexbox;display:flex;padding:15px;row-gap:15px;min-height:200px;max-width:1200px;position:relative;overflow-y:scroll;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex-direction:column;flex-direction:column}verdocs-view .document .inner{width:100%;max-width:1028px}verdocs-view .loading-indicator{top:0;left:0;right:0;bottom:0;display:-ms-flexbox;display:flex;z-index:10000;position:fixed;background-color:rgba(0, 0, 0, 0.7)}#verdocs-view-header{width:100%;color:#fff;display:-ms-flexbox;display:flex;z-index:1000;-ms-flex:0 0 56px;flex:0 0 56px;padding:0 20px;font-size:12px;-webkit-column-gap:15px;-moz-column-gap:15px;column-gap:15px;-ms-flex-align:center;align-items:center;-ms-flex-direction:row;flex-direction:row;-webkit-transition:all 0.25s;transition:all 0.25s;background-color:#33354c;-webkit-box-shadow:0 4px 4px 0 rgba(0, 0, 0, 0.24), 0 0 4px 0 rgba(0, 0, 0, 0.12);box-shadow:0 4px 4px 0 rgba(0, 0, 0, 0.24), 0 0 4px 0 rgba(0, 0, 0, 0.12)}@media all and (max-width: 500px){#verdocs-view-header{padding:0 10px}}#verdocs-view-header .inner{width:100%;display:-ms-flexbox;display:flex;margin:0 auto;padding:0 20px;max-width:1200px;-ms-flex-align:center;align-items:center;-ms-flex-direction:row;flex-direction:row}@media all and (max-width: 500px){#verdocs-view-header .inner{padding:0 10px}}#verdocs-view-header .logo{width:80px;display:none;margin:-6px 0 0 0}#verdocs-view-header .title{font-size:18px;font-weight:500;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}',C=_,T=function(){function p(r){k(this,r),this.sdkError=v(this,"sdkError",7),this.envelopeUpdated=v(this,"envelopeUpdated",7),this.another=v(this,"another",7),this.view=v(this,"view",7),this.next=v(this,"next",7),this.endpoint=z.getDefault(),this.envelopeId="",this.headerTargetId=null,this.canceling=!1,this.envelope=null,this.roleNames=[],this.showCancelDone=!1}return p.prototype.componentWillLoad=function(){this.endpoint.loadSession()},p.prototype.componentWillRender=function(){return h(this,void 0,void 0,function(){return f(this,function(r){return this.envelopeId?[2,this.reloadEnvelope()]:(console.error("[VIEW] Missing required envelopeId"),[2])})})},p.prototype.componentDidRender=function(){var r=this.headerTargetId?document.getElementById(this.headerTargetId):null,o=document.getElementById("verdocs-view-header");r&&o&&(console.log("[VIEW] Moving header"),o.remove(),r.append(o))},p.prototype.reloadEnvelope=function(){return h(this,void 0,void 0,function(){var r,o,l,s,e,a=this;return f(this,function(i){switch(i.label){case 0:console.log("[VIEW] Loading envelope..."),i.label=1;case 1:return i.trys.push([1,3,,4]),s=this,[4,x(this.endpoint,this.envelopeId)];case 2:return s.envelope=i.sent(),console.log("[VIEW] Loaded envelope",this.envelope),this.roleNames=this.envelope.recipients.map(function(d){return d.role_name}),setTimeout(function(){return h(a,void 0,void 0,function(){var d;return f(this,function(n){switch(n.label){case 0:return console.log("[VIEW] Reloading envelope..."),d=this,[4,x(this.endpoint,this.envelopeId)];case 1:return d.envelope=n.sent(),console.log("[VIEW] Reloaded envelope",this.envelope),[2]}})})},2e3),[3,4];case 3:return e=i.sent(),(r=this.sdkError)===null||r===void 0||r.emit(new y(e.message,(o=e.response)===null||o===void 0?void 0:o.status,(l=e.response)===null||l===void 0?void 0:l.data)),[3,4];case 4:return[2]}})})},p.prototype.handlePageRendered=function(r){var o=r.detail;console.log("[VIEW] Page rendered",o)},p.prototype.handleOptionSelected=function(r){return h(this,void 0,void 0,function(){var o,l,s,e,i,a,i,d=this;return f(this,function(n){switch(n.label){case 0:switch(s=r.detail.id,s){case"cancel":return[3,1];case"print":return[3,2];case"download-attachments":return[3,3];case"download-certificate":return[3,6];case"download-all":return[3,9]}return[3,10];case 1:return confirm("Are you sure you wish to cancel this envelope? This action cannot be undone.")&&(this.canceling=!0,V(this.endpoint,this.envelopeId).then(function(t){return d.canceling=!1,console.log("[VIEW] Envelope canceled",t),x(d.endpoint,d.envelopeId)}).then(function(t){console.log("[VIEW] Loaded new envelope details",t),d.envelope=t}).catch(function(t){var u,g,m;d.canceling=!1,console.log("[VIEW] Error canceling envelope",t),(u=d.sdkError)===null||u===void 0||u.emit(new y(t.message,(g=t.response)===null||g===void 0?void 0:g.status,(m=t.response)===null||m===void 0?void 0:m.data))}),this.showCancelDone=!0,(o=this.envelopeUpdated)===null||o===void 0||o.emit({endpoint:this.endpoint,envelope:this.envelope,event:"canceled"})),[3,10];case 2:return window.print(),(l=this.envelopeUpdated)===null||l===void 0||l.emit({endpoint:this.endpoint,envelope:this.envelope,event:"printed"}),[3,10];case 3:return e=this.envelope.documents.find(function(t){return t.type==="attachment"}),e?[4,b(this.endpoint,this.envelopeId,e.id)]:[3,5];case 4:i=n.sent(),window.open(i,"_blank"),n.label=5;case 5:return[3,10];case 6:return a=this.envelope.documents.find(function(t){return t.type==="certificate"}),a?[4,b(this.endpoint,this.envelopeId,a.id)]:[3,8];case 7:i=n.sent(),window.open(i,"_blank"),n.label=8;case 8:return[3,10];case 9:return S(this.endpoint,[this.envelope]).then(function(){var t;(t=d.envelopeUpdated)===null||t===void 0||t.emit({endpoint:d.endpoint,envelope:d.envelope,event:"downloaded"})}).catch(function(t){console.log("Error downloading Zip",t)}),[3,10];case 10:return[2]}})})},p.prototype.render=function(){var r=this,o;if(!this.envelope)return c(w,null,c("img",{src:"https://verdocs-public-assets.s3.amazonaws.com/loading-placeholder.png",style:{width:"612px",height:"792px",boxShadow:"0 0 10px 5px #0000000f",marginTop:"15px"},alt:"Placeholder page"}));var l=[{id:"print",label:"Print"}];D(this.endpoint.session,this.envelope)&&l.push({id:"cancel",label:"Cancel"});var s=this.envelope.documents.length>0,e=this.envelope.documents.filter(function(i){return i.type==="attachment"}).length,a=this.envelope.documents.find(function(i){return i.type==="certificate"})!==void 0;return(s||a)&&(l.push({label:""}),s&&l.push({id:"download-attachments",label:e>1?"Download Documents":"Download Document"}),a&&l.push({id:"download-certificate",label:"Download Certificate"}),s&&a&&l.push({id:"download-all",label:"Download All Files"})),c(w,null,c("div",{id:"verdocs-view-header"},c("div",{class:"inner"},c("img",{src:"https://verdocs.com/assets/white-logo.svg",alt:"Verdocs Logo",class:"logo"}),c("div",{class:"title"},this.envelope.name),c("div",{style:{flex:"1"}}),c("div",{style:{marginLeft:"10px"}}),c("verdocs-dropdown",{options:l,onOptionSelected:function(i){return r.handleOptionSelected(i)}}))),c("div",{class:"document",style:{paddingTop:this.headerTargetId?"70px":"15px"}},(((o=this.envelope)===null||o===void 0?void 0:o.documents)||[]).filter(function(i){return i.type!=="certificate"}).map(function(i){var d=W(1,i.pages);return c(I,null,d.map(function(n){return c("verdocs-envelope-document-page",{envelopeId:r.envelopeId,documentId:i.id,endpoint:r.endpoint,type:"filled",virtualWidth:612,virtualHeight:792,pageNumber:n,onPageRendered:function(t){return r.handlePageRendered(t)},layers:[{name:"page",type:"canvas"},{name:"controls",type:"div"}]})}))})),this.showCancelDone&&c("verdocs-ok-dialog",{heading:"Cancelled",message:"This envelope has been cancelled successfully.",onNext:function(){r.showCancelDone=!1}}),this.canceling&&c("div",{class:"loading-indicator"},c("verdocs-loader",null)))},Object.defineProperty(p.prototype,"component",{get:function(){return E(this)},enumerable:!1,configurable:!0}),p}();T.style=C;export{T as verdocs_view};
