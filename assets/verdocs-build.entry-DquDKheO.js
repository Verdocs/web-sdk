import{r as o,c as l,h as d,H as a,g as n}from"./preview-X13RbvS2.js";import{V as r}from"./index-CL2BROP6.js";import{g as p}from"./TemplateStore-df5484bb-Bwk0x2-p.js";import{S as h}from"./errors-887f1e88-DR-_BPTJ.js";import"./index-7456b04f-CtY4qLFG.js";import"./chunk-QN4WKJDJ-Bf_F3oir.js";import"./iframe-DWV1oore.js";import"../sb-preview/runtime.js";import"./index-296aabaf-BfkBbDig.js";import"./TemplateRoleStore-ddc3b96f-DhMDWHWE.js";import"./TemplateFieldStore-d7516adf-DPqtitkf.js";const c='@-webkit-keyframes verdocs-field-pulse{0%{background-color:rgba(0, 0, 0, 0.35)}50%{background-color:rgba(0, 0, 0, 0)}100%{background-color:rgba(0, 0, 0, 0.35)}}@keyframes verdocs-field-pulse{0%{background-color:rgba(0, 0, 0, 0.35)}50%{background-color:rgba(0, 0, 0, 0)}100%{background-color:rgba(0, 0, 0, 0.35)}}verdocs-build{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font-family:"Inter", -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", sans-serif}verdocs-build .content{-ms-flex:1;flex:1;gap:20px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-direction:column;flex-direction:column}verdocs-build verdocs-template-attachments,verdocs-build verdocs-template-roles{margin:20px}verdocs-build verdocs-template-fields{border-top:1px solid #777777}verdocs-build verdocs-template-attachments{padding:20px;background:#ffffff}verdocs-build verdocs-template-fields{width:100%}verdocs-build verdocs-preview{-ms-flex:1;flex:1}verdocs-build .preview-container{-ms-flex-direction:row;flex-direction:row;display:-ms-flexbox;display:flex;width:100%;background-color:#eeeeee;max-height:100%}@media all and (max-width: 450px){verdocs-build .preview-container{-ms-flex-direction:column;flex-direction:column}}verdocs-build .preview-send-wrapper{display:-ms-flexbox;display:flex;-ms-flex:0 0 300px;flex:0 0 300px;background-color:#ffffff;-webkit-box-shadow:1px 1px 6px -2px rgba(0, 0, 0, 0.4980392157);box-shadow:1px 1px 6px -2px rgba(0, 0, 0, 0.4980392157)}@media all and (max-width: 450px){verdocs-build .preview-send-wrapper{-ms-flex:0;flex:0}}verdocs-build .preview-preview-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-pack:center;justify-content:center;overflow-y:scroll}',m=c,v=class{constructor(e){o(this,e),this.sdkError=l(this,"sdkError",7),this.stepChanged=l(this,"stepChanged",7),this.send=l(this,"send",7),this.templateUpdated=l(this,"templateUpdated",7),this.templateCreated=l(this,"templateCreated",7),this.rolesUpdated=l(this,"rolesUpdated",7),this.endpoint=r.getDefault(),this.templateId=null,this.step="preview",this.store=null}onTemplateIdChanged(e){console.log("Template ID changed",e),this.loadTemplate(e).catch(t=>console.log("Unknown Error",t))}onStepChanged(e){console.log("Step changed",e),this.loadTemplate(this.templateId).catch(t=>console.log("Unknown Error",t))}async componentWillLoad(){var e,t,i;try{if(this.endpoint.loadSession(),!this.templateId){console.log("[BUILD] No template ID, activating upload mode"),this.step="attachments";return}if(!this.endpoint.session){console.log("[BUILD] Unable to start builder session, must be authenticated");return}this.loadTemplate(this.templateId).catch(s=>console.log("[BUILD] Unable to load template",s))}catch(s){console.log("[BUILD] Error loading template",s),(e=this.sdkError)===null||e===void 0||e.emit(new h(s.message,(t=s.response)===null||t===void 0?void 0:t.status,(i=s.response)===null||i===void 0?void 0:i.data))}}async loadTemplate(e){e&&(console.log("Loading store",e),this.store=await p(this.endpoint,e,!1))}handleCancel(e){console.log("Cancel",e.detail),this.step="preview"}async handleTemplateCreated(e){var t;await this.loadTemplate(e),this.templateId=e,this.step="roles",(t=this.stepChanged)===null||t===void 0||t.emit("roles")}async handleRolesUpdated(e){var t;(t=this.templateUpdated)===null||t===void 0||t.emit(e.detail)}async handleTemplateUpdated(e){var t;(t=this.templateUpdated)===null||t===void 0||t.emit(e.detail)}handleAttachmentsNext(){var e;this.step="roles",(e=this.stepChanged)===null||e===void 0||e.emit("roles")}handleRolesNext(){var e;this.step="fields",(e=this.stepChanged)===null||e===void 0||e.emit("fields")}handleStepChanged(e){var t;console.log("osc",e),this.step=e,(t=this.stepChanged)===null||t===void 0||t.emit(e)}render(){return this.endpoint.session?this.store?(console.log("[BUILD] Rendering build view",this.templateId,this.step,["attachments","roles","settings","fields","preview"].indexOf(this.step)),d(a,null,d("div",{class:"content"},d("verdocs-template-build-tabs",{endpoint:this.endpoint,templateId:this.templateId,step:this.step,onSdkError:e=>{var t;return(t=this.sdkError)===null||t===void 0?void 0:t.emit(e.detail)},onStepChanged:e=>this.handleStepChanged(e.detail)}),this.step==="attachments"&&d("verdocs-template-attachments",{templateId:this.templateId,endpoint:this.endpoint,onExit:e=>this.handleCancel(e),onNext:()=>this.handleAttachmentsNext(),onTemplateUpdated:e=>this.handleTemplateUpdated(e)}),this.step==="roles"&&d("verdocs-template-roles",{templateId:this.templateId,endpoint:this.endpoint,onExit:e=>this.handleCancel(e),onNext:()=>this.handleRolesNext(),onRolesUpdated:e=>this.handleRolesUpdated(e)}),this.step==="settings"&&d("div",{style:{flexDirection:"column",gap:"20px",display:"flex",maxWidth:"400px",margin:"20px"}},d("verdocs-template-name",{templateId:this.templateId,endpoint:this.endpoint,style:{backgroundColor:"#ffffff",padding:"20px"},onTemplateUpdated:e=>this.handleTemplateUpdated(e)}),d("verdocs-template-reminders",{templateId:this.templateId,endpoint:this.endpoint,style:{backgroundColor:"#ffffff",padding:"20px"},onTemplateUpdated:e=>this.handleTemplateUpdated(e)}),d("verdocs-template-visibility",{templateId:this.templateId,endpoint:this.endpoint,style:{backgroundColor:"#ffffff",padding:"20px"},onTemplateUpdated:e=>this.handleTemplateUpdated(e)})),this.step==="fields"&&d("verdocs-template-fields",{templateId:this.templateId,endpoint:this.endpoint,onTemplateUpdated:e=>this.handleTemplateUpdated(e)}),this.step==="preview"&&d("div",{class:"preview-container"},d("div",{class:"preview-send-wrapper"},d("verdocs-send",{templateId:this.templateId,endpoint:this.endpoint,onSend:e=>{var t;return(t=this.send)===null||t===void 0?void 0:t.emit(e.detail)},style:{width:"100%"}})),d("div",{class:"preview-preview-wrapper"},d("verdocs-preview",{templateId:this.templateId,endpoint:this.endpoint,style:{display:"flex",flex:"1",maxWidth:"1000px"}})))))):(console.log("[BUILD] No template ID, rendering created view"),d(a,null,d("div",{class:"content"},d("verdocs-template-build-tabs",{endpoint:this.endpoint,templateId:this.templateId,step:"attachments",onSdkError:e=>{var t;return(t=this.sdkError)===null||t===void 0?void 0:t.emit(e.detail)},onStepChanged:e=>this.handleStepChanged(e.detail)}),d("verdocs-template-create",{endpoint:this.endpoint,onExit:e=>this.handleCancel(e),onNext:()=>this.handleAttachmentsNext(),onTemplateCreated:e=>this.handleTemplateCreated(e.detail.templateId)})))):d(a,null,d("verdocs-component-error",{message:"You must be authenticated to use this module."}))}get el(){return n(this)}static get watchers(){return{templateId:["onTemplateIdChanged"],step:["onStepChanged"]}}};v.style=m;export{v as verdocs_build};
