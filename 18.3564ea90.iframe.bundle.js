/*! For license information please see 18.3564ea90.iframe.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"./dist/esm/Templates-22116158.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getTemplates})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getTemplate}));var getTemplates=function getTemplates(endpoint,params){return endpoint.api.get("/templates",{params:params}).then((function(r){return r.data}))},getTemplate=function getTemplate(endpoint,templateId){return endpoint.api.get("/templates/".concat(templateId)).then((function(r){return r.data}))}},"./dist/esm/errors-9b5498c8.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return SDKError}));__webpack_require__("./node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("./node_modules/core-js/modules/es.object.get-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.reflect.construct.js"),__webpack_require__("./node_modules/core-js/modules/es.map.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.object.create.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(self)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)},_wrapNativeSuper(Class)}function _construct(Parent,args,Class){return _construct=_isNativeReflectConstruct()?Reflect.construct.bind():function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var SDKError=function(_Error){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(SDKError,_Error);var _super=function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}(SDKError);function SDKError(message,statusCode,response){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SDKError),(_this=_super.call(this,message||"SDK Error")).response=response,_this.statusCode=statusCode,Object.setPrototypeOf(_assertThisInitialized(_this),(this instanceof SDKError?this.constructor:void 0).prototype),_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(SDKError)}(_wrapNativeSuper(Error))},"./dist/esm/utils-74227747.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getRoleIndex})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getRGBA})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getFieldId})),__webpack_require__.d(__webpack_exports__,"d",(function(){return rescale})),__webpack_require__.d(__webpack_exports__,"e",(function(){return fullNameToInitials})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getFieldSettings})),__webpack_require__.d(__webpack_exports__,"g",(function(){return integerSequence})),__webpack_require__.d(__webpack_exports__,"h",(function(){return renderDocumentField})),__webpack_require__.d(__webpack_exports__,"i",(function(){return setControlStyles}));__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.array.fill.js"),__webpack_require__("./node_modules/core-js/modules/es.array.join.js"),__webpack_require__("./node_modules/core-js/modules/es.string.split.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js");function getRGBA(roleIndex){switch(roleIndex%10){case 0:return 0===roleIndex?"rgba(255, 193, 7, 0.4)":"rgba(134, 134, 134, 0.3)";case 1:return"rgba(156, 39, 176, .4)";case 2:return"rgba(33, 150, 243, .4)";case 3:return"rgba(220, 231, 117, 0.3)";case 4:return"rgba(121, 134, 203, 0.3)";case 5:return"rgba(77, 182, 172, 0.3)";case 6:return"rgba(255, 202, 165, 0.3)";case 7:return"rgba(2, 247, 190, 0.3)";case 8:return"rgba(255, 138, 101, 0.3)";case 9:return"rgba(82, 255, 79, 0.3)";default:return"rgba(229, 115, 155, 0.3)"}}function rescale(r,n){return r*n}var integerSequence=function integerSequence(start,count){return Array(count).fill(1).map((function(_,index){return index+start}))},fullNameToInitials=function fullNameToInitials(name){return name.split(" ").map((function(word){return word[0]})).join("")},setControlStyles=function setControlStyles(el,field,xScale,yScale,roleIndex,option){var _a,_b,_c,_d,settings=field.setting||field.settings,_settings$x=settings.x,x=void 0===_settings$x?0:_settings$x,_settings$y=settings.y,y=void 0===_settings$y?0:_settings$y,_settings$width=settings.width,width=void 0===_settings$width?function defaultWidth(field){switch(field.type){case"attachment":case"payment":return 24;case"checkbox":case"checkbox_group":case"radio_button_group":return 14;case"signature":case"initial":return 82}return 150}(field):_settings$width,_settings$height=settings.height,height=void 0===_settings$height?function defaultHeight(field){switch(field.type){case"attachment":case"payment":return 24;case"checkbox":case"checkbox_group":case"radio_button_group":return 14;case"signature":case"initial":return 41}return 50}(field):_settings$height,optionSettings=void 0!==option&&settings.options[option]?settings.options[option]:null;optionSettings&&(x=null!==(_a=optionSettings.x)&&void 0!==_a?_a:x,y=null!==(_b=optionSettings.y)&&void 0!==_b?_b:y,width=null!==(_c=optionSettings.width)&&void 0!==_c?_c:width,height=null!==(_d=optionSettings.height)&&void 0!==_d?_d:height),el.style.width=width+"px",el.style.height=height+"px",el.style.position="absolute",el.style.left=rescale(xScale,x)+"px",el.style.bottom=rescale(yScale,y)+"px",el.style.transform="scale("+xScale+", "+yScale+")",el.style.backgroundColor=field.rgba||getRGBA(roleIndex)},getFieldId=function getFieldId(field){return"verdocs-doc-fld-"+field.name},getFieldOptionId=function getFieldOptionId(field,index){return"verdocs-doc-fld-"+field.name+"-"+index},renderDocumentField=function renderDocumentField(field,docPage,roleIndex,handleFieldChange,disabled){var controlsDiv=document.getElementById(docPage.containerId+"-controls");if(controlsDiv)switch(field.type){case"attachment":case"date":case"dropdown":case"initial":case"payment":case"signature":case"timestamp":case"textarea":case"textbox":var id=getFieldId(field),existingField=document.getElementById(id);if(existingField)return void setControlStyles(existingField,field,docPage.xScale,docPage.yScale,roleIndex);var el=document.createElement("verdocs-field-"+field.type);el.field=field,el.setAttribute("id",id),disabled&&el.setAttribute("disabled",!0),el.addEventListener("fieldChange",(function(e){return handleFieldChange(field,e)})),setControlStyles(el,field,docPage.xScale,docPage.yScale,roleIndex),controlsDiv.appendChild(el);break;case"checkbox_group":field.setting.options.forEach((function(option,checkboxIndex){var id=getFieldOptionId(field,checkboxIndex),existingField=document.getElementById(id);if(existingField)setControlStyles(existingField,field,docPage.xScale,docPage.yScale,roleIndex,checkboxIndex);else{console.log("Adding checkbox",option);var cbEl=document.createElement("verdocs-field-checkbox");cbEl.field=field,cbEl.setAttribute("id",id),cbEl.setAttribute("option",checkboxIndex),disabled&&cbEl.setAttribute("disabled",!0),cbEl.addEventListener("fieldChange",(function(e){return handleFieldChange(field,e)})),setControlStyles(cbEl,field,docPage.xScale,docPage.yScale,roleIndex,checkboxIndex),controlsDiv.appendChild(cbEl)}}));break;case"radio_button_group":field.setting.options.forEach((function(option,buttonIndex){var id=getFieldOptionId(field,buttonIndex),existingField=document.getElementById(id);if(existingField)setControlStyles(existingField,field,docPage.xScale,docPage.yScale,roleIndex,buttonIndex);else{console.log("Adding radio button",option);var cbEl=document.createElement("verdocs-field-radio-button");cbEl.field=field,cbEl.setAttribute("id",id),cbEl.setAttribute("option",buttonIndex),disabled&&cbEl.setAttribute("disabled",!0),cbEl.addEventListener("fieldChange",(function(e){return handleFieldChange(field,e)})),setControlStyles(cbEl,field,docPage.xScale,docPage.yScale,roleIndex,buttonIndex),controlsDiv.appendChild(cbEl)}}));break;default:console.log("[PREVIEW] Skipping unsupported field type",field)}},getRoleIndex=function getRoleIndex(roles,role){return roles.indexOf(role)||0},getFieldSettings=function getFieldSettings(field){return field.setting?field.setting:field.settings?field.settings:{x:0,y:0,required:!1,disabled:!1,result:"",value:""}}},"./dist/esm/verdocs-preview.entry.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"verdocs_preview",(function(){return VerdocsPreview}));__webpack_require__("./node_modules/core-js/modules/es.promise.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js"),__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.async-iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.math.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.json.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.object.create.js"),__webpack_require__("./node_modules/core-js/modules/es.object.get-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.array.reverse.js");var _index_43893f54_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("./dist/esm/index-43893f54.js"),_Templates_22116158_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("./dist/esm/Templates-22116158.js"),_VerdocsEndpoint_9db225a3_js__WEBPACK_IMPORTED_MODULE_28__=(__webpack_require__("./dist/esm/Types-ab9f6af8.js"),__webpack_require__("./dist/esm/VerdocsEndpoint-9db225a3.js")),_utils_74227747_js__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("./dist/esm/utils-74227747.js"),_errors_9b5498c8_js__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("./dist/esm/errors-9b5498c8.js");function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return generator._invoke=function(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}(innerFn,self,context),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==typeof value&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;this._invoke=function(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(void 0===method){if(context.delegate=null,"throw"===context.method){if(delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method))return ContinueSentinel;context.method="throw",context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Gp,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(object){var keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var VerdocsPreview=function(){function VerdocsPreview(hostRef){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VerdocsPreview),Object(_index_43893f54_js__WEBPACK_IMPORTED_MODULE_25__.h)(this,hostRef),this.sdkError=Object(_index_43893f54_js__WEBPACK_IMPORTED_MODULE_25__.d)(this,"sdkError",7),this.endpoint=_VerdocsEndpoint_9db225a3_js__WEBPACK_IMPORTED_MODULE_28__.a.getDefault(),this.templateId=null,this.pdfUrl=null,this.template=null,this.roles=[],this.fields=[]}var _handleFieldChange,_componentDidLoad;return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(VerdocsPreview,[{key:"componentDidLoad",value:(_componentDidLoad=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var _a,_b,_c,_d,template,_this=this;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,console.log("[PREVIEW] Loading template "+this.templateId),_context.next=4,Object(_Templates_22116158_js__WEBPACK_IMPORTED_MODULE_26__.b)(this.endpoint,this.templateId);case 4:template=_context.sent,console.log("[PREVIEW] Got template",this.template),this.template=template,this.pdfUrl=this.endpoint.getBaseURL()+"/templates/"+this.templateId+"/documents/"+(null===(_a=template.template_document)||void 0===_a?void 0:_a.id)+"?file=true",this.roles=template.roles.map((function(role){return role.name})),console.log("[PREVIEW] Loaded roles",this.roles),this.fields=[],template.roles.forEach((function(role){var _this$fields;(_this$fields=_this.fields).push.apply(_this$fields,_toConsumableArray(role.fields))})),console.log("[PREVIEW] Loaded fields",this.fields),_context.next=19;break;case 15:_context.prev=15,_context.t0=_context.catch(0),console.log("[PREVIEW] Error with preview session",_context.t0),null===(_b=this.sdkError)||void 0===_b||_b.emit(new _errors_9b5498c8_js__WEBPACK_IMPORTED_MODULE_30__.a(_context.t0.message,null===(_c=_context.t0.response)||void 0===_c?void 0:_c.status,null===(_d=_context.t0.response)||void 0===_d?void 0:_d.data));case 19:case"end":return _context.stop()}}),_callee,this,[[0,15]])}))),function componentDidLoad(){return _componentDidLoad.apply(this,arguments)})},{key:"handleFieldChange",value:(_handleFieldChange=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(field,e,optionId){return _regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:console.log("[PREVIEW] handleFieldChange",field,e,optionId);case 1:case"end":return _context2.stop()}}),_callee2)}))),function handleFieldChange(_x,_x2,_x3){return _handleFieldChange.apply(this,arguments)})},{key:"handlePageRendered",value:function handlePageRendered(e){var _this2=this,pageInfo=e.detail;console.log("[PREVIEW] Page rendered",pageInfo);var fields=this.fields.filter((function(field){return field.page_sequence===pageInfo.renderedPage.pageNumber}));console.log("[PREVIEW] Fields on page",fields),fields.forEach((function(field){return Object(_utils_74227747_js__WEBPACK_IMPORTED_MODULE_29__.h)(field,pageInfo.renderedPage,Object(_utils_74227747_js__WEBPACK_IMPORTED_MODULE_29__.a)(_this2.roles,field.role_name),_this2.handleFieldChange,!0)}))}},{key:"render",value:function render(){var _this3=this;return Object(_index_43893f54_js__WEBPACK_IMPORTED_MODULE_25__.f)(_index_43893f54_js__WEBPACK_IMPORTED_MODULE_25__.b,null,this.pdfUrl?Object(_index_43893f54_js__WEBPACK_IMPORTED_MODULE_25__.f)("div",{class:"inner"},Object(_index_43893f54_js__WEBPACK_IMPORTED_MODULE_25__.f)("verdocs-view",{source:this.pdfUrl,endpoint:this.endpoint,onPageRendered:function onPageRendered(e){return _this3.handlePageRendered(e)},pageLayers:[{name:"page",type:"canvas"},{name:"controls",type:"div"}]})):Object(_index_43893f54_js__WEBPACK_IMPORTED_MODULE_25__.f)("verdocs-loader",null))}}]),VerdocsPreview}();VerdocsPreview.style=""}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL0B2ZXJkb2NzL2pzLXNkay9UZW1wbGF0ZXMvVGVtcGxhdGVzLmpzIiwid2VicGFjazovLy9zcmMvdXRpbHMvZXJyb3JzLnRzIiwid2VicGFjazovLy9ub2RlX21vZHVsZXMvQHZlcmRvY3MvanMtc2RrL1V0aWxzL0NvbG9ycy5qcyIsIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL0B2ZXJkb2NzL2pzLXNkay9VdGlscy9GaWVsZHMuanMiLCJ3ZWJwYWNrOi8vL3NyYy91dGlscy91dGlscy50cyIsIndlYnBhY2s6Ly8vc3JjL2NvbXBvbmVudHMvZW1iZWRzL3ZlcmRvY3MtcHJldmlldy92ZXJkb2NzLXByZXZpZXcuc2NzcyIsIndlYnBhY2s6Ly8vc3JjL2NvbXBvbmVudHMvZW1iZWRzL3ZlcmRvY3MtcHJldmlldy92ZXJkb2NzLXByZXZpZXcudHN4Il0sIm5hbWVzIjpbImdldFRlbXBsYXRlcyIsImVuZHBvaW50IiwicGFyYW1zIiwiYXBpIiwiZ2V0IiwidGhlbiIsInIiLCJkYXRhIiwiZ2V0VGVtcGxhdGUiLCJ0ZW1wbGF0ZUlkIiwiY29uY2F0IiwiU0RLRXJyb3IiLCJtZXNzYWdlIiwic3RhdHVzQ29kZSIsInJlc3BvbnNlIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJFcnJvciIsImdldFJHQkEiLCJyb2xlSW5kZXgiLCJyZXNjYWxlIiwibiIsImludGVnZXJTZXF1ZW5jZSIsInN0YXJ0IiwiY291bnQiLCJBcnJheSIsImZpbGwiLCJtYXAiLCJfIiwiaW5kZXgiLCJmdWxsTmFtZVRvSW5pdGlhbHMiLCJuYW1lIiwic3BsaXQiLCJ3b3JkIiwiam9pbiIsInNldENvbnRyb2xTdHlsZXMiLCJlbCIsImZpZWxkIiwieFNjYWxlIiwieVNjYWxlIiwib3B0aW9uIiwic2V0dGluZ3MiLCJzZXR0aW5nIiwieCIsInkiLCJ3aWR0aCIsImRlZmF1bHRXaWR0aCIsInR5cGUiLCJoZWlnaHQiLCJkZWZhdWx0SGVpZ2h0Iiwib3B0aW9uU2V0dGluZ3MiLCJ1bmRlZmluZWQiLCJvcHRpb25zIiwiX2EiLCJfYiIsIl9jIiwiX2QiLCJzdHlsZSIsInBvc2l0aW9uIiwibGVmdCIsImJvdHRvbSIsInRyYW5zZm9ybSIsImJhY2tncm91bmRDb2xvciIsImdldEZpZWxkSWQiLCJnZXRGaWVsZE9wdGlvbklkIiwicmVuZGVyRG9jdW1lbnRGaWVsZCIsImRvY1BhZ2UiLCJoYW5kbGVGaWVsZENoYW5nZSIsImRpc2FibGVkIiwiY29udHJvbHNEaXYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGFpbmVySWQiLCJpZCIsImV4aXN0aW5nRmllbGQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJhcHBlbmRDaGlsZCIsImZvckVhY2giLCJjaGVja2JveEluZGV4IiwiY29uc29sZSIsImxvZyIsImNiRWwiLCJidXR0b25JbmRleCIsImdldFJvbGVJbmRleCIsInJvbGVzIiwicm9sZSIsImluZGV4T2YiLCJnZXRGaWVsZFNldHRpbmdzIiwicmVxdWlyZWQiLCJyZXN1bHQiLCJ2YWx1ZSIsIlZlcmRvY3NQcmV2aWV3IiwiVmVyZG9jc0VuZHBvaW50IiwiZ2V0RGVmYXVsdCIsInBkZlVybCIsInRlbXBsYXRlIiwiZmllbGRzIiwidGhpcyIsImdldEJhc2VVUkwiLCJ0ZW1wbGF0ZV9kb2N1bWVudCIsInB1c2giLCJzZGtFcnJvciIsImVtaXQiLCJzdGF0dXMiLCJvcHRpb25JZCIsImhhbmRsZVBhZ2VSZW5kZXJlZCIsInBhZ2VJbmZvIiwiZGV0YWlsIiwiZmlsdGVyIiwicGFnZV9zZXF1ZW5jZSIsInJlbmRlcmVkUGFnZSIsInBhZ2VOdW1iZXIiLCJyb2xlX25hbWUiLCJyZW5kZXIiLCJoIiwiSG9zdCIsImNsYXNzIiwic291cmNlIiwib25QYWdlUmVuZGVyZWQiLCJwYWdlTGF5ZXJzIl0sIm1hcHBpbmdzIjoiO21LQUFBLGlLQXNEVSxJQUFDQSxhQUFlLFNB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LEdBQ3JCLEdBMUR3QixvQkE0RHpCLFNBQUFpRCxTQUFNLGdCQUNKLE9BQ0VDLDJEQUFDQyxtREFBSSxLQUNGbEIsS0FBS0gsT0FDSm9CLGtFQUFLRSxNQUFNLFNBQ1RGLDJFQUNFRyxPQUFRcEIsS0FBS0gsT0FDYmpHLFNBQVVvRyxLQUFLcEcsU0FDZnlILGVBQWdCLHdCQUFBM0MsR0FBQyxPQUFJLE9BQUs4QixtQkFBbUI5QixFQUE1QixFQUNqQjRDLFdBQVksQ0FDVixDQUFDM0YsS0FBTSxPQUFRZ0IsS0FBTSxVQUNyQixDQUFDaEIsS0FBTSxXQUFZZ0IsS0FBTSxXQUsvQnNFLGtGQUlQLEtBaEZ3QixrQixxQkRqQkQsRSIsImZpbGUiOiIxOC4zNTY0ZWE5MC5pZnJhbWUuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBIFRlbXBsYXRlIGRlZmluZXMgaG93IGEgVmVyZG9jcyBzaWduaW5nIGZsb3cgd2lsbCBiZSBwZXJmb3JtZWQsIGluY2x1ZGluZyBhdHRhY2htZW50cywgc2lnbmluZyBmaWVsZHMsIGFuZFxuICogcmVjaXBpZW50cy5cbiAqXG4gKiBAbW9kdWxlXG4gKi9cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG4vKipcbiAqIEdldCBhbGwgdGVtcGxhdGVzIGFjY2Vzc2libGUgYnkgdGhlIGNhbGxlciwgd2l0aCBvcHRpb25hbCBmaWx0ZXJzLlxuICpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7VGVtcGxhdGVzfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzJztcbiAqXG4gKiBhd2FpdCBUZW1wbGF0ZXMuZ2V0VGVtcGxhdGVzKCk7XG4gKiBhd2FpdCBUZW1wbGF0ZXMuZ2V0VGVtcGxhdGVzKHsgaXNfc3RhcnJlZDogdHJ1ZSB9KTtcbiAqIGF3YWl0IFRlbXBsYXRlcy5nZXRUZW1wbGF0ZXMoeyBpc19jcmVhdG9yOiB0cnVlIH0pO1xuICogYXdhaXQgVGVtcGxhdGVzLmdldFRlbXBsYXRlcyh7IGlzX29yZ2FuaXphdGlvbjogdHJ1ZSB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgdmFyIGdldFRlbXBsYXRlcyA9IGZ1bmN0aW9uIChlbmRwb2ludCwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIGVuZHBvaW50LmFwaSAvL1xuICAgICAgICAuZ2V0KCcvdGVtcGxhdGVzJywgeyBwYXJhbXM6IHBhcmFtcyB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5kYXRhOyB9KTtcbn07XG4vKipcbiAqIEdldCBvbmUgdGVtcGxhdGUgYnkgaXRzIElELlxuICpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7VGVtcGxhdGVzfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzJztcbiAqXG4gKiBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IFRlbXBsYXRlcy5nZXRUZW1wbGF0ZSgnODNkYTNkNzAtNzg1Ny00MzkyLWI4NzYtYzQ1OTJhMzA0YmM5Jyk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IHZhciBnZXRUZW1wbGF0ZSA9IGZ1bmN0aW9uIChlbmRwb2ludCwgdGVtcGxhdGVJZCkge1xuICAgIHJldHVybiBlbmRwb2ludC5hcGkgLy9cbiAgICAgICAgLmdldChcIi90ZW1wbGF0ZXMvXCIuY29uY2F0KHRlbXBsYXRlSWQpKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5kYXRhOyB9KTtcbn07XG4vKipcbiAqIEdldCBvd25lciBpbmZvcm1hdGlvbiBmb3IgYSB0ZW1wbGF0ZS5cbiAqXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQge1RlbXBsYXRlc30gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1RlbXBsYXRlcyc7XG4gKlxuICogY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBUZW1wbGF0ZXMuZ2V0VGVtcGxhdGVPd25lckluZm8oJzgzZGEzZDcwLTc4NTctNDM5Mi1iODc2LWM0NTkyYTMwNGJjOScpO1xuICogYGBgXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VGVtcGxhdGVPd25lckluZm8gPSBmdW5jdGlvbiAoZW5kcG9pbnQsIHRlbXBsYXRlSWQpIHtcbiAgICByZXR1cm4gZW5kcG9pbnQuYXBpIC8vXG4gICAgICAgIC5nZXQoXCIvdGVtcGxhdGVzL1wiLmNvbmNhdCh0ZW1wbGF0ZUlkKSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuZGF0YTsgfSk7XG59O1xuLyoqXG4gKiBDcmVhdGUgYSB0ZW1wbGF0ZS5cbiAqXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQge1RlbXBsYXRlc30gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1RlbXBsYXRlcyc7XG4gKlxuICogY29uc3QgbmV3VGVtcGxhdGUgPSBhd2FpdCBUZW1wbGF0ZXMuY3JlYXRlVGVtcGxhdGUoey4uLn0pO1xuICogYGBgXG4gKi9cbmV4cG9ydCB2YXIgY3JlYXRlVGVtcGxhdGUgPSBmdW5jdGlvbiAoZW5kcG9pbnQsIHBhcmFtcykge1xuICAgIHJldHVybiBlbmRwb2ludC5hcGkgLy9cbiAgICAgICAgLnBvc3QoJy90ZW1wbGF0ZXMvJywgcGFyYW1zKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5kYXRhOyB9KTtcbn07XG4vKipcbiAqIFVwZGF0ZSBhIHRlbXBsYXRlLlxuICpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7VGVtcGxhdGVzfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzJztcbiAqXG4gKiBjb25zdCB1cGRhdGVkVGVtcGxhdGUgPSBhd2FpdCBUZW1wbGF0ZXMudXBkYXRlVGVtcGxhdGUoJzgzZGEzZDcwLTc4NTctNDM5Mi1iODc2LWM0NTkyYTMwNGJjOScsIHsgbmFtZTogJ05ldyBOYW1lJyB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZVRlbXBsYXRlID0gZnVuY3Rpb24gKGVuZHBvaW50LCB0ZW1wbGF0ZUlkLCBwYXJhbXMpIHtcbiAgICByZXR1cm4gZW5kcG9pbnQuYXBpIC8vXG4gICAgICAgIC5wdXQoXCIvdGVtcGxhdGVzL1wiLmNvbmNhdCh0ZW1wbGF0ZUlkKSwgcGFyYW1zKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5kYXRhOyB9KTtcbn07XG4vKipcbiAqIFNlYXJjaCBmb3IgdGVtcGxhdGVzIG1hdGNoaW5nIHZhcmlvdXMgY3JpdGVyaWEuXG4gKlxuICogYGBgdHlwZXNjcmlwdFxuICogaW1wb3J0IHtUZW1wbGF0ZXN9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9UZW1wbGF0ZXMnO1xuICpcbiAqIGNvbnN0IHtyZXN1bHQsIHBhZ2UsIHRvdGFsfSA9IGF3YWl0IFRlbXBsYXRlcy5zZWFyY2goeyAuLi4gfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IHZhciBzZWFyY2hUZW1wbGF0ZXMgPSBmdW5jdGlvbiAoZW5kcG9pbnQsIHBhcmFtcykgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBlbmRwb2ludC5hcGkgLy9cbiAgICAgICAgICAgICAgICAucG9zdCgnL3RlbXBsYXRlcy9zZWFyY2gnLCBwYXJhbXMpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuZGF0YTsgfSldO1xuICAgIH0pO1xufSk7IH07XG4vKipcbiAqIEdldCBhIHN1bW1hcnkgb2YgdGVtcGxhdGUgZGF0YSwgdHlwaWNhbGx5IHVzZWQgdG8gcG9wdWxhdGUgYWRtaW4gcGFuZWwgZGFzaGJvYXJkIHBhZ2VzLlxuICpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7VGVtcGxhdGVzfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzJztcbiAqXG4gKiBjb25zdCBzdW1tYXJ5ID0gYXdhaXQgVGVtcGxhdGVzLmdldFN1bW1hcnkoMCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IHZhciBnZXRTdW1tYXJ5ID0gZnVuY3Rpb24gKGVuZHBvaW50LCBwYWdlKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGVuZHBvaW50LmFwaSAvL1xuICAgICAgICAgICAgICAgIC5wb3N0KCcvdGVtcGxhdGVzL3N1bW1hcnknLCB7IHBhZ2U6IHBhZ2UgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5kYXRhOyB9KV07XG4gICAgfSk7XG59KTsgfTtcbiIsIi8qKlxuICogUGFzc2VkIHRvIHBhcmVudCBjb21wb25lbnRzIGluIGNlcnRhaW4gY2FsbGJhY2tzIHdpdGggdGhlIGxvd2VyLWxldmVsIEpTLVNESyBlbWl0cyBhbiBlcnJvclxuICovXG5leHBvcnQgY2xhc3MgU0RLRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvZGU7XG4gIHN0YXR1c0NvZGU7XG4gIHJlc3BvbnNlO1xuXG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgc3RhdHVzQ29kZTogbnVtYmVyLCByZXNwb25zZTogYW55KSB7XG4gICAgc3VwZXIobWVzc2FnZSB8fCAnU0RLIEVycm9yJyk7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIG5ldy50YXJnZXQucHJvdG90eXBlKTtcbiAgfVxufVxuIiwiLyoqXG4gKiBHaXZlbiBhIGByZ2JhKHIsZyxiLGEpYCBzdHJpbmcgdmFsdWUsIHJldHVybnMgdGhlIGhleCBlcXVpdmFsZW50LCBkcm9wcGluZyB0aGUgYWxwaGEgY2hhbm5lbC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJHQihyZ2JhKSB7XG4gICAgdmFyIHJnYk51bWJlcnMgPSByZ2JhLnJlcGxhY2UoJ3JnYmEoJywgJycpLnJlcGxhY2UoJyknLCAnJykuc3BsaXQoJywnKTtcbiAgICB2YXIgcmdiT2JqZWN0ID0ge1xuICAgICAgICByZWQ6ICtyZ2JOdW1iZXJzWzBdLFxuICAgICAgICBncmVlbjogK3JnYk51bWJlcnNbMV0sXG4gICAgICAgIGJsdWU6ICtyZ2JOdW1iZXJzWzJdLFxuICAgICAgICBhbHBoYTogK3JnYk51bWJlcnNbM10sXG4gICAgfTtcbiAgICB2YXIgYWxwaGEgPSAxIC0gcmdiT2JqZWN0LmFscGhhO1xuICAgIHZhciByZWQgPSBNYXRoLnJvdW5kKChyZ2JPYmplY3QuYWxwaGEgKiAocmdiT2JqZWN0LnJlZCAvIDI1NSkgKyBhbHBoYSkgKiAyNTUpO1xuICAgIHZhciBncmVlbiA9IE1hdGgucm91bmQoKHJnYk9iamVjdC5hbHBoYSAqIChyZ2JPYmplY3QuZ3JlZW4gLyAyNTUpICsgYWxwaGEpICogMjU1KTtcbiAgICB2YXIgYmx1ZSA9IE1hdGgucm91bmQoKHJnYk9iamVjdC5hbHBoYSAqIChyZ2JPYmplY3QuYmx1ZSAvIDI1NSkgKyBhbHBoYSkgKiAyNTUpO1xuICAgIHJldHVybiAnIycgKyByZ2JUb0hleChyZWQpICsgcmdiVG9IZXgoZ3JlZW4pICsgcmdiVG9IZXgoYmx1ZSk7XG59XG4vKipcbiAqIEdpdmVuIGFuIFJHQiBzdHJpbmcgdmFsdWUsIHJldHVybnMgdGhlIGhleCBlcXVpdmFsZW50LlxuICovXG5mdW5jdGlvbiByZ2JUb0hleChyZ2IpIHtcbiAgICB2YXIgaGV4ID0gcmdiLnRvU3RyaW5nKDE2KTtcbiAgICBpZiAoaGV4Lmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuICcwJyArIGhleDtcbiAgICB9XG4gICAgcmV0dXJuIGhleDtcbn1cbi8qKlxuICogR2l2ZW4gYSBzaWduZXIgcm9sZSBpbmRleCwgcmV0dXJuIHRoZSBjb2xvciBjb2RlIGZvciB0aGF0IHNpZ25lci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJHQkEocm9sZUluZGV4KSB7XG4gICAgc3dpdGNoIChyb2xlSW5kZXggJSAxMCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gcm9sZUluZGV4ID09PSAwID8gJ3JnYmEoMjU1LCAxOTMsIDcsIDAuNCknIDogJ3JnYmEoMTM0LCAxMzQsIDEzNCwgMC4zKSc7IC8vICNGRkU2OUNcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuICdyZ2JhKDE1NiwgMzksIDE3NiwgLjQpJzsgLy8gJyNFM0MzRTknXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiAncmdiYSgzMywgMTUwLCAyNDMsIC40KSc7IC8vICcjQzFFMUZCJ1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gJ3JnYmEoMjIwLCAyMzEsIDExNywgMC4zKSc7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiAncmdiYSgxMjEsIDEzNCwgMjAzLCAwLjMpJztcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgcmV0dXJuICdyZ2JhKDc3LCAxODIsIDE3MiwgMC4zKSc7XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIHJldHVybiAncmdiYSgyNTUsIDIwMiwgMTY1LCAwLjMpJztcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgcmV0dXJuICdyZ2JhKDIsIDI0NywgMTkwLCAwLjMpJztcbiAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgcmV0dXJuICdyZ2JhKDI1NSwgMTM4LCAxMDEsIDAuMyknO1xuICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICByZXR1cm4gJ3JnYmEoODIsIDI1NSwgNzksIDAuMyknO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuICdyZ2JhKDIyOSwgMTE1LCAxNTUsIDAuMyknO1xuICAgIH1cbn1cbi8qKlxuICogR2l2ZW4gYSByb2xlIG5hbWUsIHJldHVybiBhIGNvbG9yIGNvZGUgZm9yIGl0LiBUaGlzIHdvcmtzIGJ5IGNvbXB1dGluZyBhIGhhc2ggY29kZSBzbyB0aGUgc3BlY2lmaWMgY29sb3IgcmV0dXJuZWRcbiAqIGlzIG5vdCBzcGVjaWZpZWQgZXhwbGljaXRseSwgYnV0IHdpbGwgYmUgdGhlIHNhbWUgZm9yIGV2ZXJ5IGNhbGwgd2l0aCB0aGUgc2FtZSBpbnB1dCB2YWx1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5hbWVUb1JHQkEoc3RyKSB7XG4gICAgaWYgKCEhc3RyKSB7XG4gICAgICAgIHZhciB2YWxpZE51bSA9IHBhcnNlSW50KHN0ci5zbGljZSgtMSksIDEwKTtcbiAgICAgICAgaWYgKCFpc05hTih2YWxpZE51bSkpIHtcbiAgICAgICAgICAgIHN0ciArPSAodmFsaWROdW0gKiA5OSkudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGFzaCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBoYXNoID0gc3RyLmNoYXJDb2RlQXQoaSkgKyAoKGhhc2ggPDwgNSkgLSBoYXNoKTtcbiAgICAgICAgfVxuICAgICAgICBoYXNoID0gTWF0aC5yb3VuZChoYXNoIC8gMS4zKTtcbiAgICAgICAgdmFyIGMgPSAoaGFzaCAmIDB4MDBmZmZmMDgpLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICB2YXIgaGV4ID0gJyMnICsgJzAwMDAwJy5zdWJzdHJpbmcoMCwgNiAtIGMubGVuZ3RoKSArIGM7XG4gICAgICAgIHZhciByZXN1bHQgPSAvXiM/KFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pJC9pLmV4ZWMoaGV4KTtcbiAgICAgICAgdmFyIGNvbG9yID0ge1xuICAgICAgICAgICAgcjogcGFyc2VJbnQocmVzdWx0WzFdLCAxNiksXG4gICAgICAgICAgICBnOiBwYXJzZUludChyZXN1bHRbMl0sIDE2KSxcbiAgICAgICAgICAgIGI6IHBhcnNlSW50KHJlc3VsdFszXSwgMTYpLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gXCJyZ2JhKFwiLmNvbmNhdChjb2xvci5yLCBcIiwgXCIpLmNvbmNhdChjb2xvci5nLCBcIiwgXCIpLmNvbmNhdChjb2xvci5iLCBcIiwgMC4yKVwiKTtcbiAgICB9XG59XG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBvYnRhaW4gYSBjb2xvciBjb2RlIGdpdmVuIGEgcm9sZSBuYW1lIGdpdmVuIHZhcmlvdXMgcG9zc2libGUgaW5wdXRzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Um9sZUNvbG9yKG5hbWUsIHJvbGVzLCBpbmRleCkge1xuICAgIGlmIChpbmRleCkge1xuICAgICAgICByZXR1cm4gZ2V0UkdCQShpbmRleCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJvbGVzICYmIHJvbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmFyIHJvbGVJbmRleCA9IHJvbGVzLmZpbmRJbmRleChmdW5jdGlvbiAocm9sZSkgeyByZXR1cm4gcm9sZS5uYW1lID09PSBuYW1lOyB9KTtcbiAgICAgICAgaWYgKHJvbGVJbmRleCA+IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gcm9sZXNbcm9sZUluZGV4XS5yZ2JhIHx8IGdldFJHQkEocm9sZUluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBuYW1lVG9SR0JBKG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbmFtZVRvUkdCQShuYW1lKTtcbiAgICB9XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gZ2V0UlRvcCh5LCBmaWVsZEhlaWdodCwgaVRleHRIZWlnaHQsIHlSYXRpbykge1xuICAgIHJldHVybiBpVGV4dEhlaWdodCAtICh5ICsgZmllbGRIZWlnaHQpICogeVJhdGlvO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFJMZWZ0KHgsIHJhdGlvKSB7XG4gICAgcmV0dXJuIHggKiByYXRpbztcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRSVmFsdWUoeSwgcmF0aW8pIHtcbiAgICByZXR1cm4geSAqIHJhdGlvO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGJsb2JUb0Jhc2U2NChpbWFnZSkge1xuICAgIHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmaWxlUmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZWplY3QobmV3IERPTUV4Y2VwdGlvbignUHJvYmxlbSByZWFkaW5nIGJsb2IuJykpO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJlc29sdmUoZmlsZVJlYWRlci5yZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoaW1hZ2UpO1xuICAgIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHJlc2NhbGUociwgbikge1xuICAgIHJldHVybiByICogbjtcbn1cbiIsIi8vIFRoZXNlIHNob3VsZCBwcm9iYWJseSBhbGwgbW92ZSB0byBKUy1TREtcbmltcG9ydCB7cmVzY2FsZX0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1V0aWxzL0ZpZWxkcyc7XG5pbXBvcnQge2dldFJHQkF9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9VdGlscy9Db2xvcnMnO1xuaW1wb3J0IHtJVGVtcGxhdGVGaWVsZH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1RlbXBsYXRlcy9UeXBlcyc7XG5pbXBvcnQge0lEb2N1bWVudEZpZWxkfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvRG9jdW1lbnRzL1R5cGVzJztcbmltcG9ydCB7SURvY3VtZW50UGFnZUluZm99IGZyb20gJy4vVHlwZXMnO1xuXG5leHBvcnQgY29uc3QgaW50ZWdlclNlcXVlbmNlID0gKHN0YXJ0OiBudW1iZXIsIGNvdW50OiBudW1iZXIpOiBudW1iZXJbXSA9PlxuICBBcnJheShjb3VudClcbiAgICAuZmlsbCgxKVxuICAgIC5tYXAoKF8sIGluZGV4KSA9PiBpbmRleCArIHN0YXJ0KTtcblxuZXhwb3J0IGNvbnN0IGZ1bGxOYW1lVG9Jbml0aWFscyA9IChuYW1lOiBzdHJpbmcpID0+XG4gIG5hbWVcbiAgICAuc3BsaXQoJyAnKVxuICAgIC5tYXAod29yZCA9PiB3b3JkWzBdKVxuICAgIC5qb2luKCcnKTtcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRXaWR0aCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICBjYXNlICdhdHRhY2htZW50JzpcbiAgICBjYXNlICdwYXltZW50JzpcbiAgICAgIHJldHVybiAyNDtcbiAgICBjYXNlICdjaGVja2JveCc6XG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgIGNhc2UgJ3JhZGlvX2J1dHRvbl9ncm91cCc6XG4gICAgICByZXR1cm4gMTQ7XG4gICAgY2FzZSAnc2lnbmF0dXJlJzpcbiAgICBjYXNlICdpbml0aWFsJzpcbiAgICAgIHJldHVybiA4MjtcbiAgfVxuXG4gIHJldHVybiAxNTA7XG59O1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdEhlaWdodCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICBjYXNlICdhdHRhY2htZW50JzpcbiAgICBjYXNlICdwYXltZW50JzpcbiAgICAgIHJldHVybiAyNDtcbiAgICBjYXNlICdjaGVja2JveCc6XG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgIGNhc2UgJ3JhZGlvX2J1dHRvbl9ncm91cCc6XG4gICAgICByZXR1cm4gMTQ7XG4gICAgY2FzZSAnc2lnbmF0dXJlJzpcbiAgICBjYXNlICdpbml0aWFsJzpcbiAgICAgIHJldHVybiA0MTtcbiAgfVxuXG4gIHJldHVybiA1MDtcbn07XG5cbmV4cG9ydCBjb25zdCBzZXRDb250cm9sU3R5bGVzID0gKGVsOiBIVE1MRWxlbWVudCwgZmllbGQ6IElUZW1wbGF0ZUZpZWxkIHwgSURvY3VtZW50RmllbGQsIHhTY2FsZTogbnVtYmVyLCB5U2NhbGU6IG51bWJlciwgcm9sZUluZGV4OiBudW1iZXIsIG9wdGlvbj86IG51bWJlcikgPT4ge1xuICBjb25zdCBzZXR0aW5ncyA9IChmaWVsZCBhcyBJVGVtcGxhdGVGaWVsZCkuc2V0dGluZyB8fCAoZmllbGQgYXMgSURvY3VtZW50RmllbGQpLnNldHRpbmdzO1xuICBsZXQge3ggPSAwLCB5ID0gMCwgd2lkdGggPSBkZWZhdWx0V2lkdGgoZmllbGQpLCBoZWlnaHQgPSBkZWZhdWx0SGVpZ2h0KGZpZWxkKX0gPSBzZXR0aW5ncztcblxuICBjb25zdCBvcHRpb25TZXR0aW5ncyA9IG9wdGlvbiAhPT0gdW5kZWZpbmVkICYmIHNldHRpbmdzLm9wdGlvbnNbb3B0aW9uXSA/IHNldHRpbmdzLm9wdGlvbnNbb3B0aW9uXSA6IG51bGw7XG4gIGlmIChvcHRpb25TZXR0aW5ncykge1xuICAgIHggPSBvcHRpb25TZXR0aW5ncy54ID8/IHg7XG4gICAgeSA9IG9wdGlvblNldHRpbmdzLnkgPz8geTtcbiAgICB3aWR0aCA9IG9wdGlvblNldHRpbmdzLndpZHRoID8/IHdpZHRoO1xuICAgIGhlaWdodCA9IG9wdGlvblNldHRpbmdzLmhlaWdodCA/PyBoZWlnaHQ7XG4gIH1cblxuICBlbC5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YDtcbiAgZWwuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDtcbiAgZWwuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICBlbC5zdHlsZS5sZWZ0ID0gYCR7cmVzY2FsZSh4U2NhbGUsIHgpfXB4YDtcbiAgZWwuc3R5bGUuYm90dG9tID0gYCR7cmVzY2FsZSh5U2NhbGUsIHkpfXB4YDtcbiAgZWwuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7eFNjYWxlfSwgJHt5U2NhbGV9KWA7XG4gIGVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGZpZWxkWydyZ2JhJ10gfHwgZ2V0UkdCQShyb2xlSW5kZXgpO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEZpZWxkSWQgPSAoZmllbGQ6IElUZW1wbGF0ZUZpZWxkIHwgSURvY3VtZW50RmllbGQpID0+IHtcbiAgcmV0dXJuIGB2ZXJkb2NzLWRvYy1mbGQtJHtmaWVsZC5uYW1lfWA7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RmllbGRPcHRpb25JZCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQsIGluZGV4OiBudW1iZXIpID0+IHtcbiAgcmV0dXJuIGB2ZXJkb2NzLWRvYy1mbGQtJHtmaWVsZC5uYW1lfS0ke2luZGV4fWA7XG59O1xuXG5leHBvcnQgY29uc3QgcmVuZGVyRG9jdW1lbnRGaWVsZCA9IChcbiAgZmllbGQ6IElUZW1wbGF0ZUZpZWxkLFxuICBkb2NQYWdlOiBJRG9jdW1lbnRQYWdlSW5mbyxcbiAgcm9sZUluZGV4OiBudW1iZXIsXG4gIGhhbmRsZUZpZWxkQ2hhbmdlOiAoZmllbGQ6IElUZW1wbGF0ZUZpZWxkLCBlOiBhbnksIG9wdGlvbklkPzogc3RyaW5nKSA9PiB2b2lkLFxuICBkaXNhYmxlZDogYm9vbGVhbixcbikgPT4ge1xuICBjb25zdCBjb250cm9sc0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRvY1BhZ2UuY29udGFpbmVySWQgKyAnLWNvbnRyb2xzJyk7XG4gIGlmICghY29udHJvbHNEaXYpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICBjYXNlICdhdHRhY2htZW50JzpcbiAgICBjYXNlICdkYXRlJzpcbiAgICBjYXNlICdkcm9wZG93bic6XG4gICAgY2FzZSAnaW5pdGlhbCc6XG4gICAgY2FzZSAncGF5bWVudCc6XG4gICAgY2FzZSAnc2lnbmF0dXJlJzpcbiAgICBjYXNlICd0aW1lc3RhbXAnOlxuICAgIGNhc2UgJ3RleHRhcmVhJzpcbiAgICBjYXNlICd0ZXh0Ym94JzpcbiAgICAgIHtcbiAgICAgICAgY29uc3QgaWQgPSBnZXRGaWVsZElkKGZpZWxkKTtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdGaWVsZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICAgICAgaWYgKGV4aXN0aW5nRmllbGQpIHtcbiAgICAgICAgICBzZXRDb250cm9sU3R5bGVzKGV4aXN0aW5nRmllbGQsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUsIHJvbGVJbmRleCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZWw6IGFueSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYHZlcmRvY3MtZmllbGQtJHtmaWVsZC50eXBlfWApO1xuICAgICAgICBlbC5maWVsZCA9IGZpZWxkO1xuICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2lkJywgaWQpO1xuICAgICAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignZmllbGRDaGFuZ2UnLCBlID0+IGhhbmRsZUZpZWxkQ2hhbmdlKGZpZWxkLCBlKSk7XG4gICAgICAgIHNldENvbnRyb2xTdHlsZXMoZWwsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUsIHJvbGVJbmRleCk7XG4gICAgICAgIGNvbnRyb2xzRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgICAgZmllbGQuc2V0dGluZy5vcHRpb25zLmZvckVhY2goKG9wdGlvbiwgY2hlY2tib3hJbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBpZCA9IGdldEZpZWxkT3B0aW9uSWQoZmllbGQsIGNoZWNrYm94SW5kZXgpO1xuICAgICAgICBjb25zdCBleGlzdGluZ0ZpZWxkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICAgICBpZiAoZXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgIHNldENvbnRyb2xTdHlsZXMoZXhpc3RpbmdGaWVsZCwgZmllbGQsIGRvY1BhZ2UueFNjYWxlLCBkb2NQYWdlLnlTY2FsZSwgcm9sZUluZGV4LCBjaGVja2JveEluZGV4KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnQWRkaW5nIGNoZWNrYm94Jywgb3B0aW9uKTtcbiAgICAgICAgY29uc3QgY2JFbDogYW55ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgdmVyZG9jcy1maWVsZC1jaGVja2JveGApO1xuICAgICAgICBjYkVsLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ29wdGlvbicsIGNoZWNrYm94SW5kZXgpO1xuICAgICAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgICAgICBjYkVsLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZpZWxkQ2hhbmdlJywgZSA9PiBoYW5kbGVGaWVsZENoYW5nZShmaWVsZCwgZSkpO1xuICAgICAgICBzZXRDb250cm9sU3R5bGVzKGNiRWwsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUsIHJvbGVJbmRleCwgY2hlY2tib3hJbmRleCk7XG4gICAgICAgIGNvbnRyb2xzRGl2LmFwcGVuZENoaWxkKGNiRWwpO1xuICAgICAgfSk7XG5cbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAncmFkaW9fYnV0dG9uX2dyb3VwJzpcbiAgICAgIGZpZWxkLnNldHRpbmcub3B0aW9ucy5mb3JFYWNoKChvcHRpb24sIGJ1dHRvbkluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gZ2V0RmllbGRPcHRpb25JZChmaWVsZCwgYnV0dG9uSW5kZXgpO1xuICAgICAgICBjb25zdCBleGlzdGluZ0ZpZWxkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICAgICBpZiAoZXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgIHNldENvbnRyb2xTdHlsZXMoZXhpc3RpbmdGaWVsZCwgZmllbGQsIGRvY1BhZ2UueFNjYWxlLCBkb2NQYWdlLnlTY2FsZSwgcm9sZUluZGV4LCBidXR0b25JbmRleCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ0FkZGluZyByYWRpbyBidXR0b24nLCBvcHRpb24pO1xuICAgICAgICBjb25zdCBjYkVsOiBhbnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGB2ZXJkb2NzLWZpZWxkLXJhZGlvLWJ1dHRvbmApO1xuICAgICAgICBjYkVsLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ29wdGlvbicsIGJ1dHRvbkluZGV4KTtcbiAgICAgICAgaWYgKGRpc2FibGVkKSB7XG4gICAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2JFbC5hZGRFdmVudExpc3RlbmVyKCdmaWVsZENoYW5nZScsIGUgPT4gaGFuZGxlRmllbGRDaGFuZ2UoZmllbGQsIGUpKTtcbiAgICAgICAgc2V0Q29udHJvbFN0eWxlcyhjYkVsLCBmaWVsZCwgZG9jUGFnZS54U2NhbGUsIGRvY1BhZ2UueVNjYWxlLCByb2xlSW5kZXgsIGJ1dHRvbkluZGV4KTtcbiAgICAgICAgY29udHJvbHNEaXYuYXBwZW5kQ2hpbGQoY2JFbCk7XG4gICAgICB9KTtcblxuICAgICAgYnJlYWs7XG5cbiAgICAvLyBjYXNlICdhdHRhY2htZW50JzpcbiAgICAvLyAgIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmVyZG9jcy1maWVsZC1hdHRhY2htZW50Jyk7XG4gICAgLy8gICBlbC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgcmVzdWx0IHx8ICcnKTtcbiAgICAvLyAgIGJyZWFrO1xuICAgIC8vIGNhc2UgJ3BheW1lbnQnOlxuICAgIC8vICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2ZXJkb2NzLWZpZWxkLXBheW1lbnQnKTtcbiAgICAvLyAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBjb25zb2xlLmxvZygnW1BSRVZJRVddIFNraXBwaW5nIHVuc3VwcG9ydGVkIGZpZWxkIHR5cGUnLCBmaWVsZCk7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSb2xlSW5kZXggPSAocm9sZXM6IHN0cmluZ1tdLCByb2xlOiBzdHJpbmcpID0+IHJvbGVzLmluZGV4T2Yocm9sZSkgfHwgMDtcblxuLy8gVE9ETzogV2UgY2FuIGNsZWFuIHRoaXMgdXAgYSBsb3QgaWYgd2UgYWx0ZXIgdGhlIEFQSSB0byBlbWl0IGJvdGggc2V0dGluZyBhbmQgc2V0dGluZ3MgcmVnYXJkbGVzcyBvZiB0aGUgc291cmNlIHR5cGUsXG4vLyAgIGJ1dCB0aGVuIG1lcmdlIHRoZSBTREsgdHlwZXMgdG8gZW5jb3VyYWdlIGRldmVsb3BlcnMgdG8gdXNlIGp1c3QgYHNldHRpbmdzYC5cbmV4cG9ydCBjb25zdCBnZXRGaWVsZFNldHRpbmdzID0gKGZpZWxkOiBJVGVtcGxhdGVGaWVsZCB8IElEb2N1bWVudEZpZWxkKSA9PiB7XG4gIGlmICgoZmllbGQgYXMgSVRlbXBsYXRlRmllbGQpLnNldHRpbmcpIHtcbiAgICByZXR1cm4gKGZpZWxkIGFzIElUZW1wbGF0ZUZpZWxkKS5zZXR0aW5nO1xuICB9XG5cbiAgaWYgKChmaWVsZCBhcyBJRG9jdW1lbnRGaWVsZCkuc2V0dGluZ3MpIHtcbiAgICByZXR1cm4gKGZpZWxkIGFzIElEb2N1bWVudEZpZWxkKS5zZXR0aW5ncztcbiAgfVxuXG4gIHJldHVybiB7eDogMCwgeTogMCwgcmVxdWlyZWQ6IGZhbHNlLCBkaXNhYmxlZDogZmFsc2UsIHJlc3VsdDogJycsIHZhbHVlOiAnJ307XG59O1xuIiwiQGltcG9ydCAnLi4vLi4vLi4vdGhlbWUuc2Nzcyc7XG5cbnZlcmRvY3MtcHJldmlldyB7XG4gIC8vZGlzcGxheTogZmxleDtcbiAgLy9vdmVyZmxvdzogaGlkZGVuO1xuICAvL3Bvc2l0aW9uOiByZWxhdGl2ZTtcbiAgLy9taW4taGVpZ2h0OiA2MDBweDtcbiAgLy9mbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAvL2JveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIC8vZm9udC1mYW1pbHk6ICR2ZXJkb2NzLXByaW1hcnktZm9udDtcbiAgLy9cbiAgLy9kaXYge1xuICAvLyAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgLy99XG4gIC8vXG4gIC8vLnRvb2xiYXIge1xuICAvLyAgd2lkdGg6IDEwMCU7XG4gIC8vICBtYXJnaW46IDAgYXV0bztcbiAgLy8gIHBhZGRpbmc6IDAgMTRweDtcbiAgLy8gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgLy99XG4gIC8vXG4gIC8vLnRvb2xzIHtcbiAgLy8gIHdpZHRoOiAxMDAlO1xuICAvLyAgY29sb3I6ICNmZmY7XG4gIC8vICBoZWlnaHQ6IDU2cHg7XG4gIC8vICBkaXNwbGF5OiBmbGV4O1xuICAvLyAgZm9udC1zaXplOiAxMnB4O1xuICAvLyAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgLy8gIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gIC8vICBiYWNrZ3JvdW5kLWNvbG9yOiAkbWVkaXVtLWJnO1xuICAvL31cbiAgLy9cbiAgLy8uY292ZXIge1xuICAvLyAgdG9wOiAwO1xuICAvLyAgbGVmdDogMDtcbiAgLy8gIHJpZ2h0OiAwO1xuICAvLyAgYm90dG9tOiAwO1xuICAvLyAgei1pbmRleDogOTk5O1xuICAvLyAgcG9zaXRpb246IGFic29sdXRlO1xuICAvLyAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuICAvL31cbiAgLy9cbiAgLy8uZG9jdW1lbnQge1xuICAvLyAgZmxleDogMTtcbiAgLy8gIGhlaWdodDogMTAwJTtcbiAgLy8gIGRpc3BsYXk6IGZsZXg7XG4gIC8vICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIC8vICBvdmVyZmxvdy15OiBzY3JvbGw7XG4gIC8vICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAvLyAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgLy8gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAvL1xuICAvLyAgLmlubmVyIHtcbiAgLy8gICAgd2lkdGg6IDEwMCU7XG4gIC8vICAgIG1heC13aWR0aDogMTAyOHB4O1xuICAvLyAgfVxuICAvL31cbiAgLy9cbiAgLy8uYWdyZWUge1xuICAvLyAgZmxleDogMTtcbiAgLy8gIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gIC8vICBkaXNwbGF5OiBmbGV4O1xuICAvLyAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgLy8gIG1hcmdpbi1yaWdodDogMTBweDtcbiAgLy9cbiAgLy8gIC5pbnRybyB7XG4gIC8vICAgIGRpc3BsYXk6IG5vbmU7XG4gIC8vICB9XG4gIC8vXG4gIC8vICAuaGVhZGVyIHtcbiAgLy8gICAgZmxleDogMCAwIDU2cHg7XG4gIC8vICB9XG4gIC8vXG4gIC8vICAuYWdyZWUtY2hlY2tib3gge1xuICAvLyAgICBiYWNrZ3JvdW5kOiAjY2NjO1xuICAvLyAgICBmbGV4OiAwIDAgMjBweDtcbiAgLy8gICAgZGlzcGxheTogZmxleDtcbiAgLy8gICAgd2lkdGg6IDIwcHg7XG4gIC8vICAgIGhlaWdodDogMjBweDtcbiAgLy8gICAgYm9yZGVyLXJhZGl1czogM3B4O1xuICAvLyAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIC8vICAgIG1hcmdpbjogMCAxMHB4IDAgMTRweDtcbiAgLy9cbiAgLy8gICAgaW5wdXRbdHlwZT0nY2hlY2tib3gnXTpjaGVja2VkICsgbGFiZWw6YWZ0ZXIge1xuICAvLyAgICAgIGZpbHRlcjogYWxwaGEob3BhY2l0eT0xMDApO1xuICAvLyAgICAgIG9wYWNpdHk6IDE7XG4gIC8vICAgIH1cbiAgLy9cbiAgLy8gICAgbGFiZWwge1xuICAvLyAgICAgIGxlZnQ6IDJweDtcbiAgLy8gICAgICB0b3A6IDJweDtcbiAgLy8gICAgICB3aWR0aDogMTZweDtcbiAgLy8gICAgICBoZWlnaHQ6IDE2cHg7XG4gIC8vICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAvLyAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgLy8gICAgICBiYWNrZ3JvdW5kOiAjMzMzNTRjO1xuICAvLyAgICAgIGJveC1zaGFkb3c6IGluc2V0IDAgLTFweCAxcHggcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpO1xuICAvL1xuICAvLyAgICAgIC5hZ3JlZS1jaGVja2JveCBsYWJlbDpob3Zlcjo6YWZ0ZXIge1xuICAvLyAgICAgICAgZmlsdGVyOiBhbHBoYShvcGFjaXR5PTMwKTtcbiAgLy8gICAgICAgIG9wYWNpdHk6IDAuMztcbiAgLy8gICAgICB9XG4gIC8vXG4gIC8vICAgICAgJjphZnRlciB7XG4gIC8vICAgICAgICB0b3A6IDJweDtcbiAgLy8gICAgICAgIGxlZnQ6IDNweDtcbiAgLy8gICAgICAgIHdpZHRoOiA4cHg7XG4gIC8vICAgICAgICBvcGFjaXR5OiAwO1xuICAvLyAgICAgICAgaGVpZ2h0OiA1cHg7XG4gIC8vICAgICAgICBjb250ZW50OiAnJztcbiAgLy8gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgLy8gICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuICAvLyAgICAgICAgZmlsdGVyOiBhbHBoYShvcGFjaXR5PTApO1xuICAvLyAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKTtcbiAgLy8gICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICNmY2ZmZjQ7XG4gIC8vICAgICAgICBib3JkZXItdG9wOiBub25lO1xuICAvLyAgICAgICAgYm9yZGVyLXJpZ2h0OiBub25lO1xuICAvLyAgICAgIH1cbiAgLy8gICAgfVxuICAvLyAgfVxuICAvL31cbn1cbiIsImltcG9ydCB7RXZlbnQsIEV2ZW50RW1pdHRlciwgSG9zdH0gZnJvbSAnQHN0ZW5jaWwvY29yZSc7XG5pbXBvcnQge1ZlcmRvY3NFbmRwb2ludH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrJztcbmltcG9ydCB7Q29tcG9uZW50LCBQcm9wLCBTdGF0ZSwgaH0gZnJvbSAnQHN0ZW5jaWwvY29yZSc7XG5pbXBvcnQge2dldFRlbXBsYXRlfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzL1RlbXBsYXRlcyc7XG5pbXBvcnQge0lUZW1wbGF0ZSwgSVRlbXBsYXRlRmllbGR9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9UZW1wbGF0ZXMvVHlwZXMnO1xuaW1wb3J0IHtJUGFnZVJlbmRlckV2ZW50fSBmcm9tICcuLi92ZXJkb2NzLXZpZXcvdmVyZG9jcy12aWV3JztcbmltcG9ydCB7Z2V0Um9sZUluZGV4LCByZW5kZXJEb2N1bWVudEZpZWxkfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQge1NES0Vycm9yfSBmcm9tICcuLi8uLi8uLi91dGlscy9lcnJvcnMnO1xuXG4vKipcbiAqIERpc3BsYXkgYSB0ZW1wbGF0ZSBwcmV2aWV3IGV4cGVyaWVuY2UuXG4gKi9cbkBDb21wb25lbnQoe1xuICB0YWc6ICd2ZXJkb2NzLXByZXZpZXcnLFxuICBzdHlsZVVybDogJ3ZlcmRvY3MtcHJldmlldy5zY3NzJyxcbiAgc2hhZG93OiBmYWxzZSxcbn0pXG5leHBvcnQgY2xhc3MgVmVyZG9jc1ByZXZpZXcge1xuICAvKipcbiAgICogVGhlIGVuZHBvaW50IHRvIHVzZSB0byBjb21tdW5pY2F0ZSB3aXRoIFZlcmRvY3MuIElmIG5vdCBzZXQsIHRoZSBkZWZhdWx0IGVuZHBvaW50IHdpbGwgYmUgdXNlZC5cbiAgICovXG4gIEBQcm9wKCkgZW5kcG9pbnQ6IFZlcmRvY3NFbmRwb2ludCA9IFZlcmRvY3NFbmRwb2ludC5nZXREZWZhdWx0KCk7XG5cbiAgLyoqXG4gICAqIFRoZSBJRCBvZiB0aGUgdGVtcGxhdGUgdG8gY3JlYXRlIHRoZSBkb2N1bWVudCBmcm9tLlxuICAgKi9cbiAgQFByb3AoKSB0ZW1wbGF0ZUlkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICAvKipcbiAgICogRXZlbnQgZmlyZWQgaWYgYW4gZXJyb3Igb2NjdXJzLiBUaGUgZXZlbnQgZGV0YWlscyB3aWxsIGNvbnRhaW4gaW5mb3JtYXRpb24gYWJvdXQgdGhlIGVycm9yLiBNb3N0IGVycm9ycyB3aWxsXG4gICAqIHRlcm1pbmF0ZSB0aGUgcHJvY2VzcywgYW5kIHRoZSBjYWxsaW5nIGFwcGxpY2F0aW9uIHNob3VsZCBjb3JyZWN0IHRoZSBjb25kaXRpb24gYW5kIHJlLXJlbmRlciB0aGUgY29tcG9uZW50LlxuICAgKi9cbiAgQEV2ZW50KHtjb21wb3NlZDogdHJ1ZX0pIHNka0Vycm9yOiBFdmVudEVtaXR0ZXI8U0RLRXJyb3I+O1xuXG4gIEBTdGF0ZSgpIHBkZlVybCA9IG51bGw7XG4gIEBTdGF0ZSgpIHRlbXBsYXRlOiBJVGVtcGxhdGUgfCBudWxsID0gbnVsbDtcblxuICByb2xlczogc3RyaW5nW10gPSBbXTtcbiAgZmllbGRzOiBJVGVtcGxhdGVGaWVsZFtdID0gW107XG5cbiAgYXN5bmMgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coYFtQUkVWSUVXXSBMb2FkaW5nIHRlbXBsYXRlICR7dGhpcy50ZW1wbGF0ZUlkfWApO1xuICAgICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBnZXRUZW1wbGF0ZSh0aGlzLmVuZHBvaW50LCB0aGlzLnRlbXBsYXRlSWQpO1xuXG4gICAgICBjb25zb2xlLmxvZygnW1BSRVZJRVddIEdvdCB0ZW1wbGF0ZScsIHRoaXMudGVtcGxhdGUpO1xuICAgICAgdGhpcy50ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuXG4gICAgICB0aGlzLnBkZlVybCA9IGAke3RoaXMuZW5kcG9pbnQuZ2V0QmFzZVVSTCgpfS90ZW1wbGF0ZXMvJHt0aGlzLnRlbXBsYXRlSWR9L2RvY3VtZW50cy8ke3RlbXBsYXRlLnRlbXBsYXRlX2RvY3VtZW50Py5pZH0/ZmlsZT10cnVlYDtcblxuICAgICAgdGhpcy5yb2xlcyA9IHRlbXBsYXRlLnJvbGVzLm1hcChyb2xlID0+IHJvbGUubmFtZSk7XG4gICAgICBjb25zb2xlLmxvZygnW1BSRVZJRVddIExvYWRlZCByb2xlcycsIHRoaXMucm9sZXMpO1xuXG4gICAgICB0aGlzLmZpZWxkcyA9IFtdO1xuICAgICAgdGVtcGxhdGUucm9sZXMuZm9yRWFjaChyb2xlID0+IHtcbiAgICAgICAgdGhpcy5maWVsZHMucHVzaCguLi5yb2xlLmZpZWxkcyk7XG4gICAgICB9KTtcbiAgICAgIGNvbnNvbGUubG9nKCdbUFJFVklFV10gTG9hZGVkIGZpZWxkcycsIHRoaXMuZmllbGRzKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1BSRVZJRVddIEVycm9yIHdpdGggcHJldmlldyBzZXNzaW9uJywgZSk7XG4gICAgICB0aGlzLnNka0Vycm9yPy5lbWl0KG5ldyBTREtFcnJvcihlLm1lc3NhZ2UsIGUucmVzcG9uc2U/LnN0YXR1cywgZS5yZXNwb25zZT8uZGF0YSkpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGhhbmRsZUZpZWxkQ2hhbmdlKGZpZWxkOiBJVGVtcGxhdGVGaWVsZCwgZTogYW55LCBvcHRpb25JZD86IHN0cmluZykge1xuICAgIGNvbnNvbGUubG9nKCdbUFJFVklFV10gaGFuZGxlRmllbGRDaGFuZ2UnLCBmaWVsZCwgZSwgb3B0aW9uSWQpO1xuICB9XG5cbiAgaGFuZGxlUGFnZVJlbmRlcmVkKGUpIHtcbiAgICBjb25zdCBwYWdlSW5mbyA9IGUuZGV0YWlsIGFzIElQYWdlUmVuZGVyRXZlbnQ7XG4gICAgY29uc29sZS5sb2coJ1tQUkVWSUVXXSBQYWdlIHJlbmRlcmVkJywgcGFnZUluZm8pO1xuXG4gICAgY29uc3QgZmllbGRzID0gdGhpcy5maWVsZHMuZmlsdGVyKGZpZWxkID0+IGZpZWxkLnBhZ2Vfc2VxdWVuY2UgPT09IHBhZ2VJbmZvLnJlbmRlcmVkUGFnZS5wYWdlTnVtYmVyKTtcbiAgICBjb25zb2xlLmxvZygnW1BSRVZJRVddIEZpZWxkcyBvbiBwYWdlJywgZmllbGRzKTtcbiAgICBmaWVsZHMuZm9yRWFjaChmaWVsZCA9PiByZW5kZXJEb2N1bWVudEZpZWxkKGZpZWxkLCBwYWdlSW5mby5yZW5kZXJlZFBhZ2UsIGdldFJvbGVJbmRleCh0aGlzLnJvbGVzLCBmaWVsZC5yb2xlX25hbWUpLCB0aGlzLmhhbmRsZUZpZWxkQ2hhbmdlLCB0cnVlKSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxIb3N0PlxuICAgICAgICB7dGhpcy5wZGZVcmwgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImlubmVyXCI+XG4gICAgICAgICAgICA8dmVyZG9jcy12aWV3XG4gICAgICAgICAgICAgIHNvdXJjZT17dGhpcy5wZGZVcmx9XG4gICAgICAgICAgICAgIGVuZHBvaW50PXt0aGlzLmVuZHBvaW50fVxuICAgICAgICAgICAgICBvblBhZ2VSZW5kZXJlZD17ZSA9PiB0aGlzLmhhbmRsZVBhZ2VSZW5kZXJlZChlKX1cbiAgICAgICAgICAgICAgcGFnZUxheWVycz17W1xuICAgICAgICAgICAgICAgIHtuYW1lOiAncGFnZScsIHR5cGU6ICdjYW52YXMnfSxcbiAgICAgICAgICAgICAgICB7bmFtZTogJ2NvbnRyb2xzJywgdHlwZTogJ2Rpdid9LFxuICAgICAgICAgICAgICBdfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICA8dmVyZG9jcy1sb2FkZXIgLz5cbiAgICAgICAgKX1cbiAgICAgIDwvSG9zdD5cbiAgICApO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9