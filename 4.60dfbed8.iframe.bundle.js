/*! For license information please see 4.60dfbed8.iframe.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./dist/esm/index-fd7b8a34.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createStore}));__webpack_require__("./node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("./node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("./node_modules/core-js/modules/web.timers.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.map.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.object.entries.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.reduce.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js");var _index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./dist/esm/index-f78d163d.js");function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isConnected=function isConnected(maybeElement){return!("isConnected"in maybeElement)||maybeElement.isConnected},cleanupElements=function debounce(fn,ms){var timeoutId;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];timeoutId&&clearTimeout(timeoutId),timeoutId=setTimeout((function(){timeoutId=0,fn.apply(void 0,args)}),ms)}}((function(map){var _step,_iterator=_createForOfIteratorHelper(map.keys());try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value;map.set(key,map.get(key).filter(isConnected))}}catch(err){_iterator.e(err)}finally{_iterator.f()}}),2e3),unwrap=function unwrap(val){return"function"==typeof val?val():val},removeFromArray=function removeFromArray(array,item){var index=array.indexOf(item);index>=0&&(array[index]=array[array.length-1],array.length--)},createStore=function createStore(defaultState,shouldUpdate){var map=function createObservableMap(defaultState){var shouldUpdate=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(a,b){return a!==b},unwrappedState=unwrap(defaultState),states=new Map(Object.entries(null!=unwrappedState?unwrappedState:{})),handlers={dispose:[],get:[],set:[],reset:[]},reset=function reset(){var _a;states=new Map(Object.entries(null!==(_a=unwrap(defaultState))&&void 0!==_a?_a:{})),handlers.reset.forEach((function(cb){return cb()}))},dispose=function dispose(){handlers.dispose.forEach((function(cb){return cb()})),reset()},_get=function get(propName){return handlers.get.forEach((function(cb){return cb(propName)})),states.get(propName)},_set=function set(propName,value){var oldValue=states.get(propName);shouldUpdate(value,oldValue,propName)&&(states.set(propName,value),handlers.set.forEach((function(cb){return cb(propName,value,oldValue)})))},state="undefined"==typeof Proxy?{}:new Proxy(unwrappedState,{get:function get(_,propName){return _get(propName)},ownKeys:function ownKeys(_){return Array.from(states.keys())},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},has:function has(_,propName){return states.has(propName)},set:function set(_,propName,value){return _set(propName,value),!0}}),on=function on(eventName,callback){return handlers[eventName].push(callback),function(){removeFromArray(handlers[eventName],callback)}},onChange=function onChange(propName,cb){var unSet=on("set",(function(key,newValue){key===propName&&cb(newValue)})),unReset=on("reset",(function(){return cb(unwrap(defaultState)[propName])}));return function(){unSet(),unReset()}},use=function use(){for(var _len2=arguments.length,subscriptions=new Array(_len2),_key2=0;_key2<_len2;_key2++)subscriptions[_key2]=arguments[_key2];var unsubs=subscriptions.reduce((function(unsubs,subscription){return subscription.set&&unsubs.push(on("set",subscription.set)),subscription.get&&unsubs.push(on("get",subscription.get)),subscription.reset&&unsubs.push(on("reset",subscription.reset)),subscription.dispose&&unsubs.push(on("dispose",subscription.dispose)),unsubs}),[]);return function(){return unsubs.forEach((function(unsub){return unsub()}))}};return{state:state,get:_get,set:_set,on:on,onChange:onChange,use:use,dispose:dispose,reset:reset,forceUpdate:function forceUpdate(key){var oldValue=states.get(key);handlers.set.forEach((function(cb){return cb(key,oldValue,oldValue)}))}}}(defaultState,shouldUpdate);return map.use(function stencilSubscription(){if("function"!=typeof _index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__.g)return{};var elmsToUpdate=new Map;return{dispose:function dispose(){return elmsToUpdate.clear()},get:function get(propName){var elm=Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__.g)();elm&&function appendToMap(map,propName,value){var items=map.get(propName);items?items.includes(value)||items.push(value):map.set(propName,[value])}(elmsToUpdate,propName,elm)},set:function set(propName){var elements=elmsToUpdate.get(propName);elements&&elmsToUpdate.set(propName,elements.filter(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__.f)),cleanupElements(elmsToUpdate)},reset:function reset(){elmsToUpdate.forEach((function(elms){return elms.forEach(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__.f)})),cleanupElements(elmsToUpdate)}}}()),map}},"./dist/esm/templateStore-97c4a389.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return state}));__webpack_require__("./node_modules/core-js/modules/es.promise.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.async-iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.math.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.json.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.object.create.js"),__webpack_require__("./node_modules/core-js/modules/es.object.get-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.array.reverse.js");var _index_fd7b8a34_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("./dist/esm/index-fd7b8a34.js"),_utils_1a27bb94_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("./dist/esm/utils-1a27bb94.js");function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==typeof value&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var _createStore=Object(_index_fd7b8a34_js__WEBPACK_IMPORTED_MODULE_24__.a)({template:null,loadProgress:0,loading:!0,pageNumbers:[],pageUris:{},roleNames:[],fields:[],dirty:!1}),state=_createStore.state,onChange=_createStore.onChange;onChange("template",function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(newTemplate){return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(newTemplate){_context.next=9;break}return console.log("[TEMPLATESTORE] Clearing template"),state.fields=[],state.roleNames=[],state.pageNumbers=[],state.dirty=!1,state.loading=!1,state.loadProgress=0,_context.abrupt("return");case 9:console.log("[TEMPLATESTORE] Template loaded",newTemplate),state.roleNames=newTemplate.roles.map((function(role){return role.name})),console.log("[TEMPLATESTORE] Loaded roles",state.roleNames),state.fields=[],newTemplate.roles.forEach((function(role){var _state$fields;(_state$fields=state.fields).push.apply(_state$fields,_toConsumableArray(role.fields))})),console.log("[TEMPLATESTORE] Loaded fields",state.fields),state.pageNumbers=Object(_utils_1a27bb94_js__WEBPACK_IMPORTED_MODULE_25__.e)(1,newTemplate.pages.length);case 16:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()),onChange("fields",(function(newField){console.log("[TEMPLATESTORE] Field changed",newField),state.dirty=!0}))},"./dist/esm/utils-1a27bb94.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getRoleIndex})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getFieldId})),__webpack_require__.d(__webpack_exports__,"c",(function(){return fullNameToInitials})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getFieldSettings})),__webpack_require__.d(__webpack_exports__,"e",(function(){return integerSequence})),__webpack_require__.d(__webpack_exports__,"f",(function(){return renderDocumentField})),__webpack_require__.d(__webpack_exports__,"g",(function(){return updateCssTransform}));__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.array.fill.js"),__webpack_require__("./node_modules/core-js/modules/es.array.join.js"),__webpack_require__("./node_modules/core-js/modules/es.string.split.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("./node_modules/core-js/modules/es.string.match-all.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rescale(r,n){return r*n}var integerSequence=function integerSequence(start,count){return Array(count).fill(1).map((function(_,index){return index+start}))},fullNameToInitials=function fullNameToInitials(name){return name.split(" ").map((function(word){return word[0]})).join("")},setControlStyles=function setControlStyles(el,field,xScale,yScale,option){var _a,_b,_c,_d,settings=field.setting||field.settings,_settings$x=settings.x,x=void 0===_settings$x?0:_settings$x,_settings$y=settings.y,y=void 0===_settings$y?0:_settings$y,_settings$width=settings.width,width=void 0===_settings$width?function defaultWidth(field){switch(field.type){case"attachment":case"payment":return 24;case"checkbox":case"checkbox_group":case"radio_button_group":return 14;case"signature":case"initial":return 82}return 150}(field):_settings$width,_settings$height=settings.height,height=void 0===_settings$height?function defaultHeight(field){switch(field.type){case"attachment":case"payment":return 24;case"checkbox":case"checkbox_group":case"radio_button_group":return 14;case"signature":case"initial":return 41}return 50}(field):_settings$height,optionSettings=void 0!==option&&settings.options[option]?settings.options[option]:null;optionSettings&&(x=null!==(_a=optionSettings.x)&&void 0!==_a?_a:x,y=null!==(_b=optionSettings.y)&&void 0!==_b?_b:y,width=null!==(_c=optionSettings.width)&&void 0!==_c?_c:width,height=null!==(_d=optionSettings.height)&&void 0!==_d?_d:height),el.style.width=width+"px",el.style.height=height+"px",el.style.position="absolute",el.style.left=rescale(xScale,x)+"px",el.style.bottom=rescale(yScale,y)+"px",el.style.transform="scale("+xScale+", "+yScale+")"},getFieldId=function getFieldId(field){return"verdocs-doc-fld-"+field.name},getFieldOptionId=function getFieldOptionId(field,index){return"verdocs-doc-fld-"+field.name+"-"+index},renderDocumentField=function renderDocumentField(field,docPage,roleIndex,fieldOptions){var _fieldOptions$disable=fieldOptions.disabled,disabled=void 0!==_fieldOptions$disable&&_fieldOptions$disable,_fieldOptions$editabl=fieldOptions.editable,editable=void 0!==_fieldOptions$editabl&&_fieldOptions$editabl,_fieldOptions$draggab=fieldOptions.draggable,draggable=void 0!==_fieldOptions$draggab&&_fieldOptions$draggab,controlsDiv=document.getElementById(docPage.containerId+"-controls");if(controlsDiv)switch(field.type){case"attachment":case"date":case"dropdown":case"initial":case"payment":case"signature":case"timestamp":case"textarea":case"textbox":var id=getFieldId(field),existingField=document.getElementById(id);if(existingField)return void setControlStyles(existingField,field,docPage.xScale,docPage.yScale);var el=document.createElement("verdocs-field-"+field.type);return el.field=field,el.setAttribute("id",id),el.setAttribute("roleIndex",roleIndex),disabled?(el.setAttribute("tabindex",-1),el.setAttribute("disabled",!0)):el.setAttribute("tabIndex",1),editable&&el.setAttribute("editable",!0),draggable&&el.setAttribute("draggable",!0),setControlStyles(el,field,docPage.xScale,docPage.yScale),controlsDiv.appendChild(el),el;case"checkbox_group":return(field.settings||field.setting||{}).options.map((function(_,checkboxIndex){var id=getFieldOptionId(field,checkboxIndex),existingField=document.getElementById(id);if(!existingField){var cbEl=document.createElement("verdocs-field-checkbox");return cbEl.field=field,cbEl.setAttribute("id",id),cbEl.setAttribute("roleIndex",roleIndex),cbEl.setAttribute("option",checkboxIndex),disabled&&cbEl.setAttribute("disabled",!0),setControlStyles(cbEl,field,docPage.xScale,docPage.yScale,checkboxIndex),controlsDiv.appendChild(cbEl),cbEl}setControlStyles(existingField,field,docPage.xScale,docPage.yScale)}));case"radio_button_group":return(field.settings||field.setting||{}).options.map((function(_,buttonIndex){var id=getFieldOptionId(field,buttonIndex),existingField=document.getElementById(id);if(!existingField){var radioEl=document.createElement("verdocs-field-radio-button");return radioEl.field=field,radioEl.setAttribute("id",id),radioEl.setAttribute("roleIndex",roleIndex),radioEl.setAttribute("option",buttonIndex),disabled&&radioEl.setAttribute("disabled",!0),setControlStyles(radioEl,field,docPage.xScale,docPage.yScale,buttonIndex),controlsDiv.appendChild(radioEl),radioEl}setControlStyles(existingField,field,docPage.xScale,docPage.yScale)}));default:return console.log("[PREVIEW] Skipping unsupported field type",field),null}},getRoleIndex=function getRoleIndex(roles,role){return roles.indexOf(role)||0},getFieldSettings=function getFieldSettings(field){return field.setting?field.setting:field.settings?field.settings:{x:0,y:0,required:!1,disabled:!1,result:"",value:""}},updateCssTransform=function updateCssTransform(el,key,value){var components=_toConsumableArray(el.style.transform.matchAll(/(\w+)\(([^)]*)\)/gi));el.style.transform=[components.filter((function(component){return component[1]!==key})).map((function(component){return component[0]})),key+"("+value+")"].join(" ")}},"./node_modules/core-js/modules/es.array.reduce.js":function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),$reduce=__webpack_require__("./node_modules/core-js/internals/array-reduce.js").left,arrayMethodIsStrict=__webpack_require__("./node_modules/core-js/internals/array-method-is-strict.js"),CHROME_VERSION=__webpack_require__("./node_modules/core-js/internals/engine-v8-version.js"),IS_NODE=__webpack_require__("./node_modules/core-js/internals/engine-is-node.js");$({target:"Array",proto:!0,forced:!arrayMethodIsStrict("reduce")||!IS_NODE&&CHROME_VERSION>79&&CHROME_VERSION<83},{reduce:function reduce(callbackfn){var length=arguments.length;return $reduce(this,callbackfn,length,length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL0BzdGVuY2lsL3N0b3JlL2Rpc3QvaW5kZXgubWpzIiwid2VicGFjazovLy9zcmMvdXRpbHMvdGVtcGxhdGVTdG9yZS50cyIsIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL0B2ZXJkb2NzL2pzLXNkay9VdGlscy9GaWVsZHMuanMiLCJ3ZWJwYWNrOi8vL3NyYy91dGlscy91dGlscy50cyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZS5qcyJdLCJuYW1lcyI6WyJpc0Nvbm5lY3RlZCIsIm1heWJlRWxlbWVudCIsImNsZWFudXBFbGVtZW50cyIsImRlYm91bmNlIiwiZm4iLCJtcyIsInRpbWVvdXRJZCIsImFyZ3MiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwibWFwIiwia2V5cyIsImtleSIsInNldCIsImdldCIsImZpbHRlciIsInVud3JhcCIsInZhbCIsInJlbW92ZUZyb21BcnJheSIsImFycmF5IiwiaXRlbSIsImluZGV4IiwiaW5kZXhPZiIsImxlbmd0aCIsImNyZWF0ZVN0b3JlIiwiZGVmYXVsdFN0YXRlIiwic2hvdWxkVXBkYXRlIiwiY3JlYXRlT2JzZXJ2YWJsZU1hcCIsImEiLCJiIiwidW53cmFwcGVkU3RhdGUiLCJzdGF0ZXMiLCJNYXAiLCJPYmplY3QiLCJlbnRyaWVzIiwiaGFuZGxlcnMiLCJkaXNwb3NlIiwicmVzZXQiLCJfYSIsImZvckVhY2giLCJjYiIsInByb3BOYW1lIiwidmFsdWUiLCJvbGRWYWx1ZSIsInN0YXRlIiwiUHJveHkiLCJfIiwib3duS2V5cyIsIkFycmF5IiwiZnJvbSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJoYXMiLCJvbiIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwicHVzaCIsIm9uQ2hhbmdlIiwidW5TZXQiLCJuZXdWYWx1ZSIsInVuUmVzZXQiLCJ1c2UiLCJzdWJzY3JpcHRpb25zIiwidW5zdWJzIiwicmVkdWNlIiwic3Vic2NyaXB0aW9uIiwidW5zdWIiLCJmb3JjZVVwZGF0ZSIsInN0ZW5jaWxTdWJzY3JpcHRpb24iLCJnZXRSZW5kZXJpbmdSZWYiLCJlbG1zVG9VcGRhdGUiLCJjbGVhciIsImVsbSIsImFwcGVuZFRvTWFwIiwiaXRlbXMiLCJpbmNsdWRlcyIsImVsZW1lbnRzIiwiZWxtcyIsInRlbXBsYXRlIiwibG9hZFByb2dyZXNzIiwibG9hZGluZyIsInBhZ2VOdW1iZXJzIiwicGFnZVVyaXMiLCJyb2xlTmFtZXMiLCJmaWVsZHMiLCJkaXJ0eSIsIm5ld1RlbXBsYXRlIiwiY29uc29sZSIsImxvZyIsInJvbGVzIiwicm9sZSIsIm5hbWUiLCJpbnRlZ2VyU2VxdWVuY2UiLCJwYWdlcyIsIm5ld0ZpZWxkIiwicmVzY2FsZSIsInIiLCJuIiwic3RhcnQiLCJjb3VudCIsImZpbGwiLCJmdWxsTmFtZVRvSW5pdGlhbHMiLCJzcGxpdCIsIndvcmQiLCJqb2luIiwic2V0Q29udHJvbFN0eWxlcyIsImVsIiwiZmllbGQiLCJ4U2NhbGUiLCJ5U2NhbGUiLCJvcHRpb24iLCJzZXR0aW5ncyIsInNldHRpbmciLCJ4IiwieSIsIndpZHRoIiwiZGVmYXVsdFdpZHRoIiwidHlwZSIsImhlaWdodCIsImRlZmF1bHRIZWlnaHQiLCJvcHRpb25TZXR0aW5ncyIsInVuZGVmaW5lZCIsIm9wdGlvbnMiLCJzdHlsZSIsInBvc2l0aW9uIiwibGVmdCIsImJvdHRvbSIsInRyYW5zZm9ybSIsImdldEZpZWxkSWQiLCJnZXRGaWVsZE9wdGlvbklkIiwicmVuZGVyRG9jdW1lbnRGaWVsZCIsImRvY1BhZ2UiLCJyb2xlSW5kZXgiLCJmaWVsZE9wdGlvbnMiLCJkaXNhYmxlZCIsImVkaXRhYmxlIiwiZHJhZ2dhYmxlIiwiY29udHJvbHNEaXYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGFpbmVySWQiLCJpZCIsImV4aXN0aW5nRmllbGQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJjaGVja2JveEluZGV4IiwiY2JFbCIsImJ1dHRvbkluZGV4IiwicmFkaW9FbCIsImdldFJvbGVJbmRleCIsImdldEZpZWxkU2V0dGluZ3MiLCJyZXF1aXJlZCIsInJlc3VsdCIsInVwZGF0ZUNzc1RyYW5zZm9ybSIsImNvbXBvbmVudHMiLCJtYXRjaEFsbCIsImNvbXBvbmVudCIsIiQiLCIkcmVkdWNlIiwiYXJyYXlNZXRob2RJc1N0cmljdCIsIkNIUk9NRV9WRVJTSU9OIiwiSVNfTk9ERSIsInRhcmdldCIsInByb3RvIiwiZm9yY2VkIiwiY2FsbGJhY2tmbiIsImFyZ3VtZW50cyIsInRoaXMiXSwibWFwcGluZ3MiOiI7K3BHQUVBLElBK0JNQSxZQUFjLFNBQWRBLFlBQWVDLGNBQVksUUFBTyxnQkFBaUJBLGVBQWlCQSxhQUFhRCxXQUFXLEVBQzVGRSxnQkF2QlcsU0FBWEMsU0FBWUMsR0FBSUMsSUFDbEIsSUFBSUMsVUFDSixPQUFPLFdBQWEsOEJBQVRDLEtBQUksd0NBQUpBLEtBQUksc0JBQ1BELFdBQ0FFLGFBQWFGLFdBRWpCQSxVQUFZRyxZQUFXLFdBQ25CSCxVQUFZLEVBQ1pGLEdBQUUsYUFBSUcsS0FDbEIsR0FBV0YsR0FDWCxDQUNBLENBWXdCRixFQUFTLFNBQUNPLEtBQVEsSUFDWixNQURZLHFDQUN0QkEsSUFBSUMsUUFBTSxJQUExQixJQUFLLFVBQUwsaUNBQTRCLEtBQW5CQyxJQUFHLFlBQ1JGLElBQUlHLElBQUlELElBQUtGLElBQUlJLElBQUlGLEtBQUtHLE9BQU9mLGFBQ3pDLENBQUssbURBQ0wsR0FBRyxLQThCR2dCLE9BQVMsU0FBVEEsT0FBVUMsS0FBRyxNQUFxQixtQkFBUkEsSUFBcUJBLE1BQVFBLEdBQUcsRUErRzFEQyxnQkFBa0IsU0FBbEJBLGdCQUFtQkMsTUFBT0MsTUFDNUIsSUFBTUMsTUFBUUYsTUFBTUcsUUFBUUYsTUFDeEJDLE9BQVMsSUFDVEYsTUFBTUUsT0FBU0YsTUFBTUEsTUFBTUksT0FBUyxHQUNw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LHlEQUN6QkMsUUFBVSxvQkFBUSxzREFTdEJKLEVBQUUsQ0FBRUssT0FBUSxRQUFTQyxPQUFPLEVBQU1DLFFBUGRMLG9CQUFvQixZQUd0QkUsU0FBV0QsZUFBaUIsSUFBTUEsZUFBaUIsSUFJSyxDQUN4RWpHLE9BQVEsU0FBU0EsT0FBT3NHLFlBQ3RCLElBQUloSixPQUFTaUosVUFBVWpKLE9BQ3ZCLE9BQU95SSxRQUFRUyxLQUFNRixXQUFZaEosT0FBUUEsT0FBUyxFQUFJaUosVUFBVSxRQUFLOUMsRUFDdkUsRyIsImZpbGUiOiI0LjYwZGZiZWQ4LmlmcmFtZS5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRSZW5kZXJpbmdSZWYsIGZvcmNlVXBkYXRlIH0gZnJvbSAnQHN0ZW5jaWwvY29yZSc7XG5cbmNvbnN0IGFwcGVuZFRvTWFwID0gKG1hcCwgcHJvcE5hbWUsIHZhbHVlKSA9PiB7XG4gICAgY29uc3QgaXRlbXMgPSBtYXAuZ2V0KHByb3BOYW1lKTtcbiAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgIG1hcC5zZXQocHJvcE5hbWUsIFt2YWx1ZV0pO1xuICAgIH1cbiAgICBlbHNlIGlmICghaXRlbXMuaW5jbHVkZXModmFsdWUpKSB7XG4gICAgICAgIGl0ZW1zLnB1c2godmFsdWUpO1xuICAgIH1cbn07XG5jb25zdCBkZWJvdW5jZSA9IChmbiwgbXMpID0+IHtcbiAgICBsZXQgdGltZW91dElkO1xuICAgIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgICAgICBpZiAodGltZW91dElkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgfVxuICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRpbWVvdXRJZCA9IDA7XG4gICAgICAgICAgICBmbiguLi5hcmdzKTtcbiAgICAgICAgfSwgbXMpO1xuICAgIH07XG59O1xuXG4vKipcbiAqIENoZWNrIGlmIGEgcG9zc2libGUgZWxlbWVudCBpc0Nvbm5lY3RlZC5cbiAqIFRoZSBwcm9wZXJ0eSBtaWdodCBub3QgYmUgdGhlcmUsIHNvIHdlIGNoZWNrIGZvciBpdC5cbiAqXG4gKiBXZSB3YW50IGl0IHRvIHJldHVybiB0cnVlIGlmIGlzQ29ubmVjdGVkIGlzIG5vdCBhIHByb3BlcnR5LFxuICogb3RoZXJ3aXNlIHdlIHdvdWxkIHJlbW92ZSB0aGVzZSBlbGVtZW50cyBhbmQgd291bGQgbm90IHVwZGF0ZS5cbiAqXG4gKiBCZXR0ZXIgbGVhayBpbiBFZGdlIHRoYW4gdG8gYmUgdXNlbGVzcy5cbiAqL1xuY29uc3QgaXNDb25uZWN0ZWQgPSAobWF5YmVFbGVtZW50KSA9PiAhKCdpc0Nvbm5lY3RlZCcgaW4gbWF5YmVFbGVtZW50KSB8fCBtYXliZUVsZW1lbnQuaXNDb25uZWN0ZWQ7XG5jb25zdCBjbGVhbnVwRWxlbWVudHMgPSBkZWJvdW5jZSgobWFwKSA9PiB7XG4gICAgZm9yIChsZXQga2V5IG9mIG1hcC5rZXlzKCkpIHtcbiAgICAgICAgbWFwLnNldChrZXksIG1hcC5nZXQoa2V5KS5maWx0ZXIoaXNDb25uZWN0ZWQpKTtcbiAgICB9XG59LCAyMDAwKTtcbmNvbnN0IHN0ZW5jaWxTdWJzY3JpcHRpb24gPSAoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBnZXRSZW5kZXJpbmdSZWYgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gSWYgd2UgYXJlIG5vdCBpbiBhIHN0ZW5jaWwgcHJvamVjdCwgd2UgZG8gbm90aGluZy5cbiAgICAgICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBub3QgcmVhbGx5IGV4cG9ydGVkIGJ5IEBzdGVuY2lsL2NvcmUuXG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgY29uc3QgZWxtc1RvVXBkYXRlID0gbmV3IE1hcCgpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGRpc3Bvc2U6ICgpID0+IGVsbXNUb1VwZGF0ZS5jbGVhcigpLFxuICAgICAgICBnZXQ6IChwcm9wTmFtZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxtID0gZ2V0UmVuZGVyaW5nUmVmKCk7XG4gICAgICAgICAgICBpZiAoZWxtKSB7XG4gICAgICAgICAgICAgICAgYXBwZW5kVG9NYXAoZWxtc1RvVXBkYXRlLCBwcm9wTmFtZSwgZWxtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiAocHJvcE5hbWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZWxtc1RvVXBkYXRlLmdldChwcm9wTmFtZSk7XG4gICAgICAgICAgICBpZiAoZWxlbWVudHMpIHtcbiAgICAgICAgICAgICAgICBlbG1zVG9VcGRhdGUuc2V0KHByb3BOYW1lLCBlbGVtZW50cy5maWx0ZXIoZm9yY2VVcGRhdGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNsZWFudXBFbGVtZW50cyhlbG1zVG9VcGRhdGUpO1xuICAgICAgICB9LFxuICAgICAgICByZXNldDogKCkgPT4ge1xuICAgICAgICAgICAgZWxtc1RvVXBkYXRlLmZvckVhY2goKGVsbXMpID0+IGVsbXMuZm9yRWFjaChmb3JjZVVwZGF0ZSkpO1xuICAgICAgICAgICAgY2xlYW51cEVsZW1lbnRzKGVsbXNUb1VwZGF0ZSk7XG4gICAgICAgIH0sXG4gICAgfTtcbn07XG5cbmNvbnN0IHVud3JhcCA9ICh2YWwpID0+ICh0eXBlb2YgdmFsID09PSAnZnVuY3Rpb24nID8gdmFsKCkgOiB2YWwpO1xuY29uc3QgY3JlYXRlT2JzZXJ2YWJsZU1hcCA9IChkZWZhdWx0U3RhdGUsIHNob3VsZFVwZGF0ZSA9IChhLCBiKSA9PiBhICE9PSBiKSA9PiB7XG4gICAgY29uc3QgdW53cmFwcGVkU3RhdGUgPSB1bndyYXAoZGVmYXVsdFN0YXRlKTtcbiAgICBsZXQgc3RhdGVzID0gbmV3IE1hcChPYmplY3QuZW50cmllcyh1bndyYXBwZWRTdGF0ZSAhPT0gbnVsbCAmJiB1bndyYXBwZWRTdGF0ZSAhPT0gdm9pZCAwID8gdW53cmFwcGVkU3RhdGUgOiB7fSkpO1xuICAgIGNvbnN0IGhhbmRsZXJzID0ge1xuICAgICAgICBkaXNwb3NlOiBbXSxcbiAgICAgICAgZ2V0OiBbXSxcbiAgICAgICAgc2V0OiBbXSxcbiAgICAgICAgcmVzZXQ6IFtdLFxuICAgIH07XG4gICAgY29uc3QgcmVzZXQgPSAoKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgLy8gV2hlbiByZXNldHRpbmcgdGhlIHN0YXRlLCB0aGUgZGVmYXVsdCBzdGF0ZSBtYXkgYmUgYSBmdW5jdGlvbiAtIHVud3JhcCBpdCB0byBpbnZva2UgaXQuXG4gICAgICAgIC8vIG90aGVyd2lzZSwgdGhlIHN0YXRlIHdvbid0IGJlIHByb3Blcmx5IHJlc2V0XG4gICAgICAgIHN0YXRlcyA9IG5ldyBNYXAoT2JqZWN0LmVudHJpZXMoKF9hID0gdW53cmFwKGRlZmF1bHRTdGF0ZSkpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHt9KSk7XG4gICAgICAgIGhhbmRsZXJzLnJlc2V0LmZvckVhY2goKGNiKSA9PiBjYigpKTtcbiAgICB9O1xuICAgIGNvbnN0IGRpc3Bvc2UgPSAoKSA9PiB7XG4gICAgICAgIC8vIENhbGwgZmlyc3QgZGlzcG9zZSBhcyByZXNldHRpbmcgdGhlIHN0YXRlIHdvdWxkXG4gICAgICAgIC8vIGNhdXNlIGxlc3MgdXBkYXRlcyA7KVxuICAgICAgICBoYW5kbGVycy5kaXNwb3NlLmZvckVhY2goKGNiKSA9PiBjYigpKTtcbiAgICAgICAgcmVzZXQoKTtcbiAgICB9O1xuICAgIGNvbnN0IGdldCA9IChwcm9wTmFtZSkgPT4ge1xuICAgICAgICBoYW5kbGVycy5nZXQuZm9yRWFjaCgoY2IpID0+IGNiKHByb3BOYW1lKSk7XG4gICAgICAgIHJldHVybiBzdGF0ZXMuZ2V0KHByb3BOYW1lKTtcbiAgICB9O1xuICAgIGNvbnN0IHNldCA9IChwcm9wTmFtZSwgdmFsdWUpID0+IHtcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSBzdGF0ZXMuZ2V0KHByb3BOYW1lKTtcbiAgICAgICAgaWYgKHNob3VsZFVwZGF0ZSh2YWx1ZSwgb2xkVmFsdWUsIHByb3BOYW1lKSkge1xuICAgICAgICAgICAgc3RhdGVzLnNldChwcm9wTmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgaGFuZGxlcnMuc2V0LmZvckVhY2goKGNiKSA9PiBjYihwcm9wTmFtZSwgdmFsdWUsIG9sZFZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHN0YXRlID0gKHR5cGVvZiBQcm94eSA9PT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyB7fVxuICAgICAgICA6IG5ldyBQcm94eSh1bndyYXBwZWRTdGF0ZSwge1xuICAgICAgICAgICAgZ2V0KF8sIHByb3BOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldChwcm9wTmFtZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb3duS2V5cyhfKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oc3RhdGVzLmtleXMoKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhhcyhfLCBwcm9wTmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZXMuaGFzKHByb3BOYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQoXywgcHJvcE5hbWUsIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgc2V0KHByb3BOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KSk7XG4gICAgY29uc3Qgb24gPSAoZXZlbnROYW1lLCBjYWxsYmFjaykgPT4ge1xuICAgICAgICBoYW5kbGVyc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgcmVtb3ZlRnJvbUFycmF5KGhhbmRsZXJzW2V2ZW50TmFtZV0sIGNhbGxiYWNrKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIGNvbnN0IG9uQ2hhbmdlID0gKHByb3BOYW1lLCBjYikgPT4ge1xuICAgICAgICBjb25zdCB1blNldCA9IG9uKCdzZXQnLCAoa2V5LCBuZXdWYWx1ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGtleSA9PT0gcHJvcE5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYihuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBXZSBuZWVkIHRvIHVud3JhcCB0aGUgZGVmYXVsdFN0YXRlIGJlY2F1c2UgaXQgbWlnaHQgYmUgYSBmdW5jdGlvbi5cbiAgICAgICAgLy8gT3RoZXJ3aXNlIHdlIG1pZ2h0IG5vdCBiZSBzZW5kaW5nIHRoZSByaWdodCByZXNldCB2YWx1ZS5cbiAgICAgICAgY29uc3QgdW5SZXNldCA9IG9uKCdyZXNldCcsICgpID0+IGNiKHVud3JhcChkZWZhdWx0U3RhdGUpW3Byb3BOYW1lXSkpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdW5TZXQoKTtcbiAgICAgICAgICAgIHVuUmVzZXQoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIGNvbnN0IHVzZSA9ICguLi5zdWJzY3JpcHRpb25zKSA9PiB7XG4gICAgICAgIGNvbnN0IHVuc3VicyA9IHN1YnNjcmlwdGlvbnMucmVkdWNlKCh1bnN1YnMsIHN1YnNjcmlwdGlvbikgPT4ge1xuICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5zZXQpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnMucHVzaChvbignc2V0Jywgc3Vic2NyaXB0aW9uLnNldCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5nZXQpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnMucHVzaChvbignZ2V0Jywgc3Vic2NyaXB0aW9uLmdldCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5yZXNldCkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdyZXNldCcsIHN1YnNjcmlwdGlvbi5yZXNldCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5kaXNwb3NlKSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzLnB1c2gob24oJ2Rpc3Bvc2UnLCBzdWJzY3JpcHRpb24uZGlzcG9zZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuc3VicztcbiAgICAgICAgfSwgW10pO1xuICAgICAgICByZXR1cm4gKCkgPT4gdW5zdWJzLmZvckVhY2goKHVuc3ViKSA9PiB1bnN1YigpKTtcbiAgICB9O1xuICAgIGNvbnN0IGZvcmNlVXBkYXRlID0gKGtleSkgPT4ge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHN0YXRlcy5nZXQoa2V5KTtcbiAgICAgICAgaGFuZGxlcnMuc2V0LmZvckVhY2goKGNiKSA9PiBjYihrZXksIG9sZFZhbHVlLCBvbGRWYWx1ZSkpO1xuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGdldCxcbiAgICAgICAgc2V0LFxuICAgICAgICBvbixcbiAgICAgICAgb25DaGFuZ2UsXG4gICAgICAgIHVzZSxcbiAgICAgICAgZGlzcG9zZSxcbiAgICAgICAgcmVzZXQsXG4gICAgICAgIGZvcmNlVXBkYXRlLFxuICAgIH07XG59O1xuY29uc3QgcmVtb3ZlRnJvbUFycmF5ID0gKGFycmF5LCBpdGVtKSA9PiB7XG4gICAgY29uc3QgaW5kZXggPSBhcnJheS5pbmRleE9mKGl0ZW0pO1xuICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgIGFycmF5W2luZGV4XSA9IGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdO1xuICAgICAgICBhcnJheS5sZW5ndGgtLTtcbiAgICB9XG59O1xuXG5jb25zdCBjcmVhdGVTdG9yZSA9IChkZWZhdWx0U3RhdGUsIHNob3VsZFVwZGF0ZSkgPT4ge1xuICAgIGNvbnN0IG1hcCA9IGNyZWF0ZU9ic2VydmFibGVNYXAoZGVmYXVsdFN0YXRlLCBzaG91bGRVcGRhdGUpO1xuICAgIG1hcC51c2Uoc3RlbmNpbFN1YnNjcmlwdGlvbigpKTtcbiAgICByZXR1cm4gbWFwO1xufTtcblxuZXhwb3J0IHsgY3JlYXRlT2JzZXJ2YWJsZU1hcCwgY3JlYXRlU3RvcmUgfTtcbiIsIi8vIE5PVEU6IERvIG5vdCBhdHRlbXB0IHRvIGNvbnZlcnQgdGhpcyB0byBhIG5hbWVkLWV4cG9ydCBtb2R1bGUuIEl0IHRyaWdnZXJzIGNvbXBpbGF0aW9uIGlzc3VlcyBpbiBSb2xsdXAgdGhhdCBJIHNwZW50IGRheXMgdHJ5aW5nIHRvXG4vLyByZXNvbHZlLiBUaGlzIG5lZWRzIHRvIGV4cG9ydCBhIHNpbmdsZSBkZWZhdWx0IHZhbHVlIG9mIHRoZSBzdG9yZSdzIHN0YXRlLiBBbnkgaGVscGVyIGZ1bmN0aW9ucyBzaG91bGQgZ28gaW4gVGVtcGxhdGVzLnRzIGhlcmUuXG5cbmltcG9ydCB7Y3JlYXRlU3RvcmV9IGZyb20gJ0BzdGVuY2lsL3N0b3JlJztcbmltcG9ydCB7SVRlbXBsYXRlLCBJVGVtcGxhdGVGaWVsZH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1RlbXBsYXRlcy9UeXBlcyc7XG4vLyBpbXBvcnQge1ZlcmRvY3NFbmRwb2ludH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrJztcbi8vIGltcG9ydCB7Z2V0VGVtcGxhdGV9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9UZW1wbGF0ZXMvVGVtcGxhdGVzJztcbmltcG9ydCB7aW50ZWdlclNlcXVlbmNlfSBmcm9tICcuL3V0aWxzJztcbi8vIGltcG9ydCB7Z2V0UGFnZUltYWdlfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzL1BhZ2VzJztcblxuY29uc3Qge3N0YXRlLCBvbkNoYW5nZX0gPSBjcmVhdGVTdG9yZSh7XG4gIHRlbXBsYXRlOiBudWxsIGFzIElUZW1wbGF0ZSB8IG51bGwsXG4gIGxvYWRQcm9ncmVzczogMCxcbiAgbG9hZGluZzogdHJ1ZSxcblxuICBwYWdlTnVtYmVyczogW10gYXMgbnVtYmVyW10sXG4gIHBhZ2VVcmlzOiB7fSBhcyBSZWNvcmQ8bnVtYmVyLCBzdHJpbmc+LFxuICByb2xlTmFtZXM6IFtdIGFzIHN0cmluZ1tdLFxuICBmaWVsZHM6IFtdIGFzIElUZW1wbGF0ZUZpZWxkW10sXG4gIGRpcnR5OiBmYWxzZSxcbn0pO1xuXG5vbkNoYW5nZSgndGVtcGxhdGUnLCBhc3luYyBuZXdUZW1wbGF0ZSA9PiB7XG4gIGlmICghbmV3VGVtcGxhdGUpIHtcbiAgICBjb25zb2xlLmxvZygnW1RFTVBMQVRFU1RPUkVdIENsZWFyaW5nIHRlbXBsYXRlJyk7XG4gICAgc3RhdGUuZmllbGRzID0gW107XG4gICAgc3RhdGUucm9sZU5hbWVzID0gW107XG4gICAgc3RhdGUucGFnZU51bWJlcnMgPSBbXTtcbiAgICBzdGF0ZS5kaXJ0eSA9IGZhbHNlO1xuICAgIHN0YXRlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICBzdGF0ZS5sb2FkUHJvZ3Jlc3MgPSAwO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnNvbGUubG9nKCdbVEVNUExBVEVTVE9SRV0gVGVtcGxhdGUgbG9hZGVkJywgbmV3VGVtcGxhdGUpO1xuXG4gIHN0YXRlLnJvbGVOYW1lcyA9IG5ld1RlbXBsYXRlLnJvbGVzLm1hcChyb2xlID0+IHJvbGUubmFtZSk7XG4gIGNvbnNvbGUubG9nKCdbVEVNUExBVEVTVE9SRV0gTG9hZGVkIHJvbGVzJywgc3RhdGUucm9sZU5hbWVzKTtcblxuICBzdGF0ZS5maWVsZHMgPSBbXTtcbiAgbmV3VGVtcGxhdGUucm9sZXMuZm9yRWFjaChyb2xlID0+IHtcbiAgICBzdGF0ZS5maWVsZHMucHVzaCguLi5yb2xlLmZpZWxkcyk7XG4gIH0pO1xuXG4gIGNvbnNvbGUubG9nKCdbVEVNUExBVEVTVE9SRV0gTG9hZGVkIGZpZWxkcycsIHN0YXRlLmZpZWxkcyk7XG5cbiAgc3RhdGUucGFnZU51bWJlcnMgPSBpbnRlZ2VyU2VxdWVuY2UoMSwgbmV3VGVtcGxhdGUucGFnZXMubGVuZ3RoKTtcbn0pO1xuXG5vbkNoYW5nZSgnZmllbGRzJywgbmV3RmllbGQgPT4ge1xuICBjb25zb2xlLmxvZygnW1RFTVBMQVRFU1RPUkVdIEZpZWxkIGNoYW5nZWQnLCBuZXdGaWVsZCk7XG4gIHN0YXRlLmRpcnR5ID0gdHJ1ZTtcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBzdGF0ZTtcbiIsImV4cG9ydCBmdW5jdGlvbiBnZXRSVG9wKHksIGZpZWxkSGVpZ2h0LCBpVGV4dEhlaWdodCwgeVJhdGlvKSB7XG4gICAgcmV0dXJuIGlUZXh0SGVpZ2h0IC0gKHkgKyBmaWVsZEhlaWdodCkgKiB5UmF0aW87XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0UkxlZnQoeCwgcmF0aW8pIHtcbiAgICByZXR1cm4geCAqIHJhdGlvO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFJWYWx1ZSh5LCByYXRpbykge1xuICAgIHJldHVybiB5ICogcmF0aW87XG59XG5leHBvcnQgZnVuY3Rpb24gYmxvYlRvQmFzZTY0KGltYWdlKSB7XG4gICAgdmFyIGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZpbGVSZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRE9NRXhjZXB0aW9uKCdQcm9ibGVtIHJlYWRpbmcgYmxvYi4nKSk7XG4gICAgICAgIH07XG4gICAgICAgIGZpbGVSZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmVzb2x2ZShmaWxlUmVhZGVyLnJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICAgIGZpbGVSZWFkZXIucmVhZEFzRGF0YVVSTChpbWFnZSk7XG4gICAgfSk7XG59XG5leHBvcnQgZnVuY3Rpb24gcmVzY2FsZShyLCBuKSB7XG4gICAgcmV0dXJuIHIgKiBuO1xufVxuIiwiLy8gVGhlc2Ugc2hvdWxkIHByb2JhYmx5IGFsbCBtb3ZlIHRvIEpTLVNES1xuaW1wb3J0IHtyZXNjYWxlfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVXRpbHMvRmllbGRzJztcbi8vIGltcG9ydCB7Z2V0UkdCQX0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1V0aWxzL0NvbG9ycyc7XG5pbXBvcnQge0lUZW1wbGF0ZUZpZWxkfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzL1R5cGVzJztcbmltcG9ydCB7SURvY3VtZW50RmllbGR9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9FbnZlbG9wZXMvVHlwZXMnO1xuaW1wb3J0IHtJRG9jdW1lbnRQYWdlSW5mb30gZnJvbSAnLi9UeXBlcyc7XG5cbmV4cG9ydCBjb25zdCBpbnRlZ2VyU2VxdWVuY2UgPSAoc3RhcnQ6IG51bWJlciwgY291bnQ6IG51bWJlcik6IG51bWJlcltdID0+XG4gIEFycmF5KGNvdW50KVxuICAgIC5maWxsKDEpXG4gICAgLm1hcCgoXywgaW5kZXgpID0+IGluZGV4ICsgc3RhcnQpO1xuXG5leHBvcnQgY29uc3QgZnVsbE5hbWVUb0luaXRpYWxzID0gKG5hbWU6IHN0cmluZykgPT5cbiAgbmFtZVxuICAgIC5zcGxpdCgnICcpXG4gICAgLm1hcCh3b3JkID0+IHdvcmRbMF0pXG4gICAgLmpvaW4oJycpO1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdFdpZHRoID0gKGZpZWxkOiBJVGVtcGxhdGVGaWVsZCB8IElEb2N1bWVudEZpZWxkKSA9PiB7XG4gIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgIGNhc2UgJ2F0dGFjaG1lbnQnOlxuICAgIGNhc2UgJ3BheW1lbnQnOlxuICAgICAgcmV0dXJuIDI0O1xuICAgIGNhc2UgJ2NoZWNrYm94JzpcbiAgICBjYXNlICdjaGVja2JveF9ncm91cCc6XG4gICAgY2FzZSAncmFkaW9fYnV0dG9uX2dyb3VwJzpcbiAgICAgIHJldHVybiAxNDtcbiAgICBjYXNlICdzaWduYXR1cmUnOlxuICAgIGNhc2UgJ2luaXRpYWwnOlxuICAgICAgcmV0dXJuIDgyO1xuICB9XG5cbiAgcmV0dXJuIDE1MDtcbn07XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0SGVpZ2h0ID0gKGZpZWxkOiBJVGVtcGxhdGVGaWVsZCB8IElEb2N1bWVudEZpZWxkKSA9PiB7XG4gIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgIGNhc2UgJ2F0dGFjaG1lbnQnOlxuICAgIGNhc2UgJ3BheW1lbnQnOlxuICAgICAgcmV0dXJuIDI0O1xuICAgIGNhc2UgJ2NoZWNrYm94JzpcbiAgICBjYXNlICdjaGVja2JveF9ncm91cCc6XG4gICAgY2FzZSAncmFkaW9fYnV0dG9uX2dyb3VwJzpcbiAgICAgIHJldHVybiAxNDtcbiAgICBjYXNlICdzaWduYXR1cmUnOlxuICAgIGNhc2UgJ2luaXRpYWwnOlxuICAgICAgcmV0dXJuIDQxO1xuICB9XG5cbiAgcmV0dXJuIDUwO1xufTtcblxuZXhwb3J0IGNvbnN0IHNldENvbnRyb2xTdHlsZXMgPSAoZWw6IEhUTUxFbGVtZW50LCBmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCwgeFNjYWxlOiBudW1iZXIsIHlTY2FsZTogbnVtYmVyLCBvcHRpb24/OiBudW1iZXIpID0+IHtcbiAgY29uc3Qgc2V0dGluZ3MgPSAoZmllbGQgYXMgSVRlbXBsYXRlRmllbGQpLnNldHRpbmcgfHwgKGZpZWxkIGFzIElEb2N1bWVudEZpZWxkKS5zZXR0aW5ncztcbiAgbGV0IHt4ID0gMCwgeSA9IDAsIHdpZHRoID0gZGVmYXVsdFdpZHRoKGZpZWxkKSwgaGVpZ2h0ID0gZGVmYXVsdEhlaWdodChmaWVsZCl9ID0gc2V0dGluZ3M7XG5cbiAgY29uc3Qgb3B0aW9uU2V0dGluZ3MgPSBvcHRpb24gIT09IHVuZGVmaW5lZCAmJiBzZXR0aW5ncy5vcHRpb25zW29wdGlvbl0gPyBzZXR0aW5ncy5vcHRpb25zW29wdGlvbl0gOiBudWxsO1xuICBpZiAob3B0aW9uU2V0dGluZ3MpIHtcbiAgICB4ID0gb3B0aW9uU2V0dGluZ3MueCA/PyB4O1xuICAgIHkgPSBvcHRpb25TZXR0aW5ncy55ID8/IHk7XG4gICAgd2lkdGggPSBvcHRpb25TZXR0aW5ncy53aWR0aCA/PyB3aWR0aDtcbiAgICBoZWlnaHQgPSBvcHRpb25TZXR0aW5ncy5oZWlnaHQgPz8gaGVpZ2h0O1xuICB9XG5cbiAgZWwuc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XG4gIGVsLnN0eWxlLmhlaWdodCA9IGAke2hlaWdodH1weGA7XG4gIGVsLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgZWwuc3R5bGUubGVmdCA9IGAke3Jlc2NhbGUoeFNjYWxlLCB4KX1weGA7XG4gIGVsLnN0eWxlLmJvdHRvbSA9IGAke3Jlc2NhbGUoeVNjYWxlLCB5KX1weGA7XG4gIGVsLnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgke3hTY2FsZX0sICR7eVNjYWxlfSlgO1xuICAvLyBlbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBmaWVsZFsncmdiYSddIHx8IGdldFJHQkEocm9sZUluZGV4KTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRGaWVsZElkID0gKGZpZWxkOiBJVGVtcGxhdGVGaWVsZCB8IElEb2N1bWVudEZpZWxkKSA9PiB7XG4gIHJldHVybiBgdmVyZG9jcy1kb2MtZmxkLSR7ZmllbGQubmFtZX1gO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEZpZWxkT3B0aW9uSWQgPSAoZmllbGQ6IElUZW1wbGF0ZUZpZWxkIHwgSURvY3VtZW50RmllbGQsIGluZGV4OiBudW1iZXIpID0+IHtcbiAgcmV0dXJuIGB2ZXJkb2NzLWRvYy1mbGQtJHtmaWVsZC5uYW1lfS0ke2luZGV4fWA7XG59O1xuXG5pbnRlcmZhY2UgSUZpZWxkT3B0aW9ucyB7XG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgZWRpdGFibGU/OiBib29sZWFuO1xuICBkcmFnZ2FibGU/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY29uc3QgcmVuZGVyRG9jdW1lbnRGaWVsZCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCwgZG9jUGFnZTogSURvY3VtZW50UGFnZUluZm8sIHJvbGVJbmRleDogbnVtYmVyLCBmaWVsZE9wdGlvbnM6IElGaWVsZE9wdGlvbnMpID0+IHtcbiAgY29uc3Qge2Rpc2FibGVkID0gZmFsc2UsIGVkaXRhYmxlID0gZmFsc2UsIGRyYWdnYWJsZSA9IGZhbHNlfSA9IGZpZWxkT3B0aW9ucztcbiAgY29uc3QgY29udHJvbHNEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkb2NQYWdlLmNvbnRhaW5lcklkICsgJy1jb250cm9scycpO1xuICBpZiAoIWNvbnRyb2xzRGl2KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc3dpdGNoIChmaWVsZC50eXBlKSB7XG4gICAgY2FzZSAnYXR0YWNobWVudCc6XG4gICAgY2FzZSAnZGF0ZSc6XG4gICAgY2FzZSAnZHJvcGRvd24nOlxuICAgIGNhc2UgJ2luaXRpYWwnOlxuICAgIGNhc2UgJ3BheW1lbnQnOlxuICAgIGNhc2UgJ3NpZ25hdHVyZSc6XG4gICAgY2FzZSAndGltZXN0YW1wJzpcbiAgICBjYXNlICd0ZXh0YXJlYSc6XG4gICAgY2FzZSAndGV4dGJveCc6IHtcbiAgICAgIGNvbnN0IGlkID0gZ2V0RmllbGRJZChmaWVsZCk7XG4gICAgICBjb25zdCBleGlzdGluZ0ZpZWxkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICAgaWYgKGV4aXN0aW5nRmllbGQpIHtcbiAgICAgICAgc2V0Q29udHJvbFN0eWxlcyhleGlzdGluZ0ZpZWxkLCBmaWVsZCwgZG9jUGFnZS54U2NhbGUsIGRvY1BhZ2UueVNjYWxlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBlbDogYW55ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgdmVyZG9jcy1maWVsZC0ke2ZpZWxkLnR5cGV9YCk7XG4gICAgICBlbC5maWVsZCA9IGZpZWxkO1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgncm9sZUluZGV4Jywgcm9sZUluZGV4KTtcblxuICAgICAgaWYgKGRpc2FibGVkKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAtMSk7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgndGFiSW5kZXgnLCAxKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGVkaXRhYmxlKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZWRpdGFibGUnLCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRyYWdnYWJsZSkge1xuICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2RyYWdnYWJsZScsIHRydWUpO1xuICAgICAgfVxuICAgICAgc2V0Q29udHJvbFN0eWxlcyhlbCwgZmllbGQsIGRvY1BhZ2UueFNjYWxlLCBkb2NQYWdlLnlTY2FsZSk7XG4gICAgICBjb250cm9sc0Rpdi5hcHBlbmRDaGlsZChlbCk7XG5cbiAgICAgIHJldHVybiBlbDtcbiAgICB9XG5cbiAgICBjYXNlICdjaGVja2JveF9ncm91cCc6XG4gICAgICByZXR1cm4gKChmaWVsZCBhcyBhbnkpLnNldHRpbmdzIHx8IChmaWVsZCBhcyBhbnkpLnNldHRpbmcgfHwge30pLm9wdGlvbnMubWFwKChfLCBjaGVja2JveEluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gZ2V0RmllbGRPcHRpb25JZChmaWVsZCwgY2hlY2tib3hJbmRleCk7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRmllbGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgICAgIGlmIChleGlzdGluZ0ZpZWxkKSB7XG4gICAgICAgICAgc2V0Q29udHJvbFN0eWxlcyhleGlzdGluZ0ZpZWxkLCBmaWVsZCwgZG9jUGFnZS54U2NhbGUsIGRvY1BhZ2UueVNjYWxlKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYkVsOiBhbnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGB2ZXJkb2NzLWZpZWxkLWNoZWNrYm94YCk7XG4gICAgICAgIGNiRWwuZmllbGQgPSBmaWVsZDtcbiAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ2lkJywgaWQpO1xuICAgICAgICBjYkVsLnNldEF0dHJpYnV0ZSgncm9sZUluZGV4Jywgcm9sZUluZGV4KTtcbiAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ29wdGlvbicsIGNoZWNrYm94SW5kZXgpO1xuICAgICAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgICAgICBjYkVsLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRDb250cm9sU3R5bGVzKGNiRWwsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUsIGNoZWNrYm94SW5kZXgpO1xuICAgICAgICBjb250cm9sc0Rpdi5hcHBlbmRDaGlsZChjYkVsKTtcblxuICAgICAgICByZXR1cm4gY2JFbDtcbiAgICAgIH0pO1xuXG4gICAgY2FzZSAncmFkaW9fYnV0dG9uX2dyb3VwJzpcbiAgICAgIHJldHVybiAoKGZpZWxkIGFzIGFueSkuc2V0dGluZ3MgfHwgKGZpZWxkIGFzIGFueSkuc2V0dGluZyB8fCB7fSkub3B0aW9ucy5tYXAoKF8sIGJ1dHRvbkluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gZ2V0RmllbGRPcHRpb25JZChmaWVsZCwgYnV0dG9uSW5kZXgpO1xuICAgICAgICBjb25zdCBleGlzdGluZ0ZpZWxkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICAgICBpZiAoZXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgIHNldENvbnRyb2xTdHlsZXMoZXhpc3RpbmdGaWVsZCwgZmllbGQsIGRvY1BhZ2UueFNjYWxlLCBkb2NQYWdlLnlTY2FsZSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmFkaW9FbDogYW55ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgdmVyZG9jcy1maWVsZC1yYWRpby1idXR0b25gKTtcbiAgICAgICAgcmFkaW9FbC5maWVsZCA9IGZpZWxkO1xuICAgICAgICByYWRpb0VsLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XG4gICAgICAgIHJhZGlvRWwuc2V0QXR0cmlidXRlKCdyb2xlSW5kZXgnLCByb2xlSW5kZXgpO1xuICAgICAgICByYWRpb0VsLnNldEF0dHJpYnV0ZSgnb3B0aW9uJywgYnV0dG9uSW5kZXgpO1xuICAgICAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgICAgICByYWRpb0VsLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRDb250cm9sU3R5bGVzKHJhZGlvRWwsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUsIGJ1dHRvbkluZGV4KTtcbiAgICAgICAgY29udHJvbHNEaXYuYXBwZW5kQ2hpbGQocmFkaW9FbCk7XG5cbiAgICAgICAgcmV0dXJuIHJhZGlvRWw7XG4gICAgICB9KTtcblxuICAgIC8vIGNhc2UgJ2F0dGFjaG1lbnQnOlxuICAgIC8vICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2ZXJkb2NzLWZpZWxkLWF0dGFjaG1lbnQnKTtcbiAgICAvLyAgIGVsLnNldEF0dHJpYnV0ZSgndmFsdWUnLCByZXN1bHQgfHwgJycpO1xuICAgIC8vICAgYnJlYWs7XG4gICAgLy8gY2FzZSAncGF5bWVudCc6XG4gICAgLy8gICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZlcmRvY3MtZmllbGQtcGF5bWVudCcpO1xuICAgIC8vICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUubG9nKCdbUFJFVklFV10gU2tpcHBpbmcgdW5zdXBwb3J0ZWQgZmllbGQgdHlwZScsIGZpZWxkKTtcbiAgICAgIHJldHVybiBudWxsO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0Um9sZUluZGV4ID0gKHJvbGVzOiBzdHJpbmdbXSwgcm9sZTogc3RyaW5nKSA9PiByb2xlcy5pbmRleE9mKHJvbGUpIHx8IDA7XG5cbi8vIFRPRE86IFdlIGNhbiBjbGVhbiB0aGlzIHVwIGEgbG90IGlmIHdlIGFsdGVyIHRoZSBBUEkgdG8gZW1pdCBib3RoIHNldHRpbmcgYW5kIHNldHRpbmdzIHJlZ2FyZGxlc3Mgb2YgdGhlIHNvdXJjZSB0eXBlLFxuLy8gICBidXQgdGhlbiBtZXJnZSB0aGUgU0RLIHR5cGVzIHRvIGVuY291cmFnZSBkZXZlbG9wZXJzIHRvIHVzZSBqdXN0IGBzZXR0aW5nc2AuXG5leHBvcnQgY29uc3QgZ2V0RmllbGRTZXR0aW5ncyA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICBpZiAoKGZpZWxkIGFzIElUZW1wbGF0ZUZpZWxkKS5zZXR0aW5nKSB7XG4gICAgcmV0dXJuIChmaWVsZCBhcyBJVGVtcGxhdGVGaWVsZCkuc2V0dGluZztcbiAgfVxuXG4gIGlmICgoZmllbGQgYXMgSURvY3VtZW50RmllbGQpLnNldHRpbmdzKSB7XG4gICAgcmV0dXJuIChmaWVsZCBhcyBJRG9jdW1lbnRGaWVsZCkuc2V0dGluZ3M7XG4gIH1cblxuICByZXR1cm4ge3g6IDAsIHk6IDAsIHJlcXVpcmVkOiBmYWxzZSwgZGlzYWJsZWQ6IGZhbHNlLCByZXN1bHQ6ICcnLCB2YWx1ZTogJyd9O1xufTtcblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gc2FmZWx5IHNldC91cGRhdGUgY29tcG9uZW50cyBpbiBhIENTUyB0cmFuc2Zvcm0gYXR0cmlidXRlLiBUcmFuc2Zvcm0gaXMgbm9ybWFsbHkgc2V0IGFzIGEgc3RyaW5nIG9mXG4gKiBgb3BlcmF0aW9uMShwYXJhbSkgb3BlcmF0aW9uMihwYXJhbSkgLi4uYCBjb21wb25lbnRzLCB3aGljaCBtYWtlcyB1cGRhdGluZyB0aGVtIGEgYml0IG9mIGEgcGFpbi4gVGhpcyB3aWxsIHJlbW92ZSB0aGVcbiAqIHNwZWNpZmllZCBjb21wb25lbnQgaWYgaXQncyBhbHJlYWR5IHNldCBhbmQgcmVwbGFjZSBpdCB3aXRoIHRoZSBuZXcgdmFsdWUsIHdpdGhvdXQgdG91Y2hpbmcgdGhlIG90aGVyIGNvbXBvbmVudHMgdGhhdFxuICogbWF5IGFscmVhZHkgYmUgc2V0LiBOb3RlIHRoYXQgdGhpcyBvcGVyYXRpb24gbW92ZXMgdGhlIGNvbXBvbmVudCB0byB0aGUgZW5kIG9mIHRoZSB0cmFuc2Zvcm0gY2hhaW4gc28gaXQncyBub3QgbWVhbnRcbiAqIHRvIGJlIHVzZWQgZm9yIG9yZGVyLXNlbnNpdGl2ZSBjb21wb25lbnRzIGUuZy4gdHJhbnNsYXRlLXRoZW4tcm90YXRlLlxuICovXG5leHBvcnQgY29uc3QgdXBkYXRlQ3NzVHJhbnNmb3JtID0gKGVsOiBIVE1MRWxlbWVudCwga2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgLy8gZS5nLiAnc2NhbGUoMS44NzkwOCwgMS44NzkwOCkgdHJhbnNsYXRlKDBweCwgMHB4KTsnXG4gIGNvbnN0IGN1cnJlbnRUcmFuc2Zvcm0gPSBlbC5zdHlsZS50cmFuc2Zvcm07XG4gIC8vIGUuZy4gWydzY2FsZSgxLjg3OTA4LCAxLjg3OTA4KScsICdzY2FsZScsICcxLjg3OTA4LCAxLjg3OTA4JywgLi4uXSwgWyAndHJhbnNsYXRlKDBweCwgMHB4KScsICd0cmFuc2xhdGUnLCAnMHB4LCAwcHgnXV1cbiAgY29uc3QgY29tcG9uZW50cyA9IFsuLi5jdXJyZW50VHJhbnNmb3JtLm1hdGNoQWxsKC8oXFx3KylcXCgoW14pXSopXFwpL2dpKV07XG4gIGVsLnN0eWxlLnRyYW5zZm9ybSA9IFtcbiAgICBjb21wb25lbnRzIC8vXG4gICAgICAuZmlsdGVyKGNvbXBvbmVudCA9PiBjb21wb25lbnRbMV0gIT09IGtleSkgLy8gUmVtb3ZlIHRoZSBlbnRyeSBpZiBpdCdzIGFscmVhZHkgc2V0XG4gICAgICAubWFwKGNvbXBvbmVudCA9PiBjb21wb25lbnRbMF0pLCAvLyBDb252ZXJ0IGJhY2sgdGhlIHJlbWFpbmluZyBlbnRyaWVzXG4gICAgYCR7a2V5fSgke3ZhbHVlfSlgLFxuICBdLmpvaW4oJyAnKTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG52YXIgJCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9leHBvcnQnKTtcbnZhciAkcmVkdWNlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FycmF5LXJlZHVjZScpLmxlZnQ7XG52YXIgYXJyYXlNZXRob2RJc1N0cmljdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9hcnJheS1tZXRob2QtaXMtc3RyaWN0Jyk7XG52YXIgQ0hST01FX1ZFUlNJT04gPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZW5naW5lLXY4LXZlcnNpb24nKTtcbnZhciBJU19OT0RFID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2VuZ2luZS1pcy1ub2RlJyk7XG5cbnZhciBTVFJJQ1RfTUVUSE9EID0gYXJyYXlNZXRob2RJc1N0cmljdCgncmVkdWNlJyk7XG4vLyBDaHJvbWUgODAtODIgaGFzIGEgY3JpdGljYWwgYnVnXG4vLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0xMDQ5OTgyXG52YXIgQ0hST01FX0JVRyA9ICFJU19OT0RFICYmIENIUk9NRV9WRVJTSU9OID4gNzkgJiYgQ0hST01FX1ZFUlNJT04gPCA4MztcblxuLy8gYEFycmF5LnByb3RvdHlwZS5yZWR1Y2VgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheS5wcm90b3R5cGUucmVkdWNlXG4kKHsgdGFyZ2V0OiAnQXJyYXknLCBwcm90bzogdHJ1ZSwgZm9yY2VkOiAhU1RSSUNUX01FVEhPRCB8fCBDSFJPTUVfQlVHIH0sIHtcbiAgcmVkdWNlOiBmdW5jdGlvbiByZWR1Y2UoY2FsbGJhY2tmbiAvKiAsIGluaXRpYWxWYWx1ZSAqLykge1xuICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIHJldHVybiAkcmVkdWNlKHRoaXMsIGNhbGxiYWNrZm4sIGxlbmd0aCwgbGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7XG4gIH1cbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==