(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"./dist/esm/verdocs-auth.entry.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"verdocs_auth",(function(){return VerdocsAuth}));__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js");var _index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./dist/esm/index-5d92e60f.js"),_VerdocsEndpoint_9353e4a0_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./dist/esm/VerdocsEndpoint-9353e4a0.js");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var VerdocsAuth=function(){function VerdocsAuth(hostRef){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VerdocsAuth),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.h)(this,hostRef),this.authenticated=Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.d)(this,"authenticated",7),this.endpoint=_VerdocsEndpoint_9353e4a0_js__WEBPACK_IMPORTED_MODULE_2__.a.getDefault(),this.visible=!0,this.logo="https://verdocs.com/assets/blue-logo.svg",this.debug=!1,this.isAuthenticated=!1,this.displayMode="login",this.username="",this.password="",this.loggingIn=!1,this.activeSession=null,this.loginError=null}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(VerdocsAuth,[{key:"componentDidLoad",value:function componentDidLoad(){console.log("loaded",this),this.endpoint.loadSession(),this.endpoint.session?(this.isAuthenticated=!0,this.activeSession=this.endpoint.session,this.authenticated.emit({authenticated:!0,session:this.endpoint.session})):this.authenticated.emit({authenticated:!1,session:null})}},{key:"handleLogin",value:function handleLogin(){var _this=this;this.loggingIn=!0,function authenticateUser(endpoint,params){return endpoint.api.post("/authentication/login",params).then((function(r){return r.data}))}(this.endpoint,{username:this.username,password:this.password}).then((function(r){_this.loggingIn=!1,_this.endpoint.setToken(r.accessToken),_this.activeSession=_this.endpoint.session,_this.isAuthenticated=!0,_this.authenticated.emit({authenticated:!0,session:_this.endpoint.session})})).catch((function(e){var _a;console.log("[VERDOCS] Login error",e.response,JSON.stringify(e)),_this.loggingIn=!1,_this.activeSession=null,_this.authenticated.emit({authenticated:!1,session:null}),403===(null===(_a=null==e?void 0:e.response)||void 0===_a?void 0:_a.status)&&(_this.loginError="Please check your username and password and try again.")}))}},{key:"handleLogout",value:function handleLogout(){this.endpoint.clearSession(),this.isAuthenticated=!1,this.authenticated.emit({authenticated:!1,session:null})}},{key:"handleClearError",value:function handleClearError(){this.loginError=null}},{key:"render",value:function render(){var _this2=this;return this.visible?this.isAuthenticated?this.debug?Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("div",{class:"status-result debug"},Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-button",{label:"Logout",disabled:this.loggingIn,onPress:function onPress(){return _this2.handleLogout()}})):Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("div",{class:"status-result"},"Authenticated"):"signup"===this.displayMode?Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("div",{class:"signup-form"},Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("img",{src:this.logo,alt:"Verdocs Logo",class:"logo"}),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("h3",null,"Sign up for an account"),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("h4",null,"Already have an account?",Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-button",{label:"Log In",variant:"text",onClick:function onClick(){return _this2.displayMode="login"},disabled:this.loggingIn})),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("form",{onSubmit:function onSubmit(){return _this2.handleLogin()}},Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-text-input",{label:"Email",autocomplete:"username",value:this.username,onFieldInput:function onFieldInput(e){return _this2.username=e.detail},disabled:this.loggingIn}),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-text-input",{label:"Password",type:"password",autocomplete:"current-password",value:this.password,onFieldInput:function onFieldInput(e){return _this2.password=e.detail},disabled:this.loggingIn}),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-button",{label:"Signup",disabled:this.loggingIn,onPress:function onPress(){return _this2.handleLogin()},style:{display:"flex",justifyContent:"center",margin:"30px auto 0"}}))):Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("div",{class:"login-form"},Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("img",{src:this.logo,alt:"Verdocs Logo",class:"logo"}),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("h3",null,"Log in to your account"),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("h4",null,"Don't have an account?",Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-button",{label:"Sign Up",variant:"text",onClick:function onClick(){return _this2.displayMode="signup"},disabled:this.loggingIn})),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("form",{onSubmit:function onSubmit(){return _this2.handleLogin()}},Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-text-input",{label:"Email",autocomplete:"username",value:this.username,onFieldInput:function onFieldInput(e){return _this2.username=e.detail},disabled:this.loggingIn}),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-text-input",{label:"Password",type:"password",autocomplete:"current-password",value:this.password,onFieldInput:function onFieldInput(e){return _this2.password=e.detail},disabled:this.loggingIn}),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-button",{label:"Forgot Your Password?",variant:"text",onClick:function onClick(){return _this2.displayMode="signup"},disabled:this.loggingIn,style:{display:"flex",justifyContent:"center",margin:"10px auto 20px"}}),Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-button",{label:"Login",disabled:this.loggingIn,onPress:function onPress(){return _this2.handleLogin()},style:{display:"flex",justifyContent:"center",margin:"10px auto 0"}})),this.loginError?Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("verdocs-ok-dialog",{open:!0,heading:"Login Error",message:this.loginError,onClosed:function onClosed(){return _this2.handleClearError()}}):Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("div",null)):Object(_index_5d92e60f_js__WEBPACK_IMPORTED_MODULE_1__.f)("div",{style:{display:"none"}},"Verdocs Auth Placeholder")}}]),VerdocsAuth}();VerdocsAuth.style='verdocs-auth{font-family:"Inter", -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", sans-serif;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}verdocs-auth .login-form,verdocs-auth .signup-form{background:#ffffff;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;-ms-flex-direction:column;flex-direction:column;display:-ms-flexbox;display:flex;padding:20px;width:300px;max-width:100%}verdocs-auth .logo{margin:20px 0 30px;width:128px;max-width:100%}verdocs-auth h3{text-align:center;font-weight:400;font-size:16px;line-height:1.75;margin:0}verdocs-auth h4{text-align:center;font-weight:400;font-size:14px;line-height:1.43;margin:0}verdocs-auth .status-result{display:none}verdocs-auth .status-result.debug{white-space:pre-wrap;font-size:14px;background:#fff;padding:10px;display:block;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:center;justify-content:center}verdocs-auth form{width:100%}verdocs-auth verdocs-text-input{margin-bottom:10px}'}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL0B2ZXJkb2NzL2pzLXNkay9Vc2Vycy9BdXRoLmpzIiwid2VicGFjazovLy9zcmMvY29tcG9uZW50cy9lbWJlZHMvdmVyZG9jcy1hdXRoL3ZlcmRvY3MtYXV0aC50c3giLCJ3ZWJwYWNrOi8vL3NyYy9jb21wb25lbnRzL2VtYmVkcy92ZXJkb2NzLWF1dGgvdmVyZG9jcy1hdXRoLnNjc3MiXSwibmFtZXMiOlsiVmVyZG9jc0F1dGgiLCJlbmRwb2ludCIsIlZlcmRvY3NFbmRwb2ludCIsImdldERlZmF1bHQiLCJ2aXNpYmxlIiwibG9nbyIsImRlYnVnIiwiaXNBdXRoZW50aWNhdGVkIiwiZGlzcGxheU1vZGUiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwibG9nZ2luZ0luIiwiYWN0aXZlU2Vzc2lvbiIsImxvZ2luRXJyb3IiLCJjb21wb25lbnREaWRMb2FkIiwiY29uc29sZSIsImxvZyIsInRoaXMiLCJsb2FkU2Vzc2lvbiIsInNlc3Npb24iLCJhdXRoZW50aWNhdGVkIiwiZW1pdCIsImhhbmRsZUxvZ2luIiwiYXV0aGVudGljYXRlVXNlciIsInBhcmFtcyIsImFwaSIsInBvc3QiLCJ0aGVuIiwiciIsImRhdGEiLCJBdXRoLmF1dGhlbnRpY2F0ZVVzZXIiLCJzZXRUb2tlbiIsImFjY2Vzc1Rva2VuIiwiZSIsInJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsIl9hIiwic3RhdHVzIiwiaGFuZGxlTG9nb3V0IiwiY2xlYXJTZXNzaW9uIiwiaGFuZGxlQ2xlYXJFcnJvciIsInJlbmRlciIsImgiLCJjbGFzcyIsImxhYmVsIiwiZGlzYWJsZWQiLCJvblByZXNzIiwic3JjIiwiYWx0IiwidmFyaWFudCIsIm9uQ2xpY2siLCJvblN1Ym1pdCIsImF1dG9jb21wbGV0ZSIsInZhbHVlIiwib25GaWVsZElucHV0IiwiZGV0YWlsIiwidHlwZSIsInN0eWxlIiwiZGlzcGxheSIsImp1c3RpZnlDb250ZW50IiwibWFyZ2luIiwib3Bl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VHNDLFNBQVU3QixLQUFLTixVQUNmK0MsTUFBTyxDQUFDQyxRQUFTLE9BQVFDLGVBQWdCLFNBQVVDLE9BQVEsb0JBRzdEbEIsNEVBQWdCRSxNQUFNLFFBQVFDLFNBQVU3QixLQUFLTixVQUFXb0MsUUFBUywwQkFBTSxPQUFLekIsYUFBWCxFQUEwQm9DLE1BQU8sQ0FBQ0MsUUFBUyxPQUFRQyxlQUFnQixTQUFVQyxPQUFRLGtCQUd2SjVDLEtBQUtKLFdBQWE4QiwrRUFBbUJtQixNQUFNLEVBQU1DLFFBQVEsY0FBY0MsUUFBUy9DLEtBQUtKLFdBQVlvRCxTQUFVLDJCQUFNLE9BQUt4QixrQkFBWCxJQUFvQ0UsdUVBaEYzSUEsaUVBQUtlLE1BQU8sQ0FBQ0MsUUFBUyxTQUFPLDJCQW1GdkMsS0E5S3FCLGUsa0JDMUNELHVsQyIsImZpbGUiOiIyMC42OGRmOTY1My5pZnJhbWUuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBdXRoZW50aWNhdGUgdG8gVmVyZG9jcyB2aWEgdXNlci9wYXNzd29yZCBhdXRoZW50aWNhdGlvblxuICpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7QXV0aH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL0F1dGgnO1xuICogaW1wb3J0IHtUcmFuc3BvcnR9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9IVFRQJztcbiAqXG4gKiBjb25zdCB7YWNjZXNzVG9rZW59ID0gYXdhaXQgQXV0aC5hdXRoZW50aWNhdGVVc2VyKHsgdXNlcm5hbWU6ICd0ZXN0QHRlc3QuY29tJywgcGFzc3dvcmQ6ICdQQVNTV09SRCcgfSk7XG4gKiBUcmFuc3BvcnQuc2V0QXV0aFRva2VuKGFjY2Vzc1Rva2VuKTtcbiAqIGBgYFxuICovXG5leHBvcnQgdmFyIGF1dGhlbnRpY2F0ZVVzZXIgPSBmdW5jdGlvbiAoZW5kcG9pbnQsIHBhcmFtcykge1xuICAgIHJldHVybiBlbmRwb2ludC5hcGkgLy9cbiAgICAgICAgLnBvc3QoJy9hdXRoZW50aWNhdGlvbi9sb2dpbicsIHBhcmFtcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuZGF0YTsgfSk7XG59O1xuLyoqXG4gKiBBdXRoZW50aWNhdGUgdG8gVmVyZG9jcyB2aWEgY2xpZW50IElEIC8gU2VjcmV0IGF1dGhlbnRpY2F0aW9uLiAqKk5PVEU6IFRoaXMgaXMgb25seSBzdWl0YWJsZSBmb3JcbiAqIE5vZGVKUyBzZXJ2ZXItc2lkZSBhcHBsaWNhdGlvbnMuIE5ldmVyIGV4cG9zZSB5b3VyIENsaWVudCBTZWNyZXQgaW4gYSBXZWIgb3IgTW9iaWxlIGFwcCEqKiBBbHNvIG5vdGVcbiAqIHRoYXQgYWNjZXNzIHRva2VucyBtYXkgYmUgY2FjaGVkIGJ5IHNlcnZlci1zaWRlIGFwcHMgKGFuZCB0aGlzIGlzIHJlY29tbWVuZGVkKSBidXQgZG8gZXhwaXJlIGFmdGVyIDJcbiAqIGhvdXJzLiBUaGlzIGV4cGlyYXRpb24gbWF5IGNoYW5nZSBiYXNlZCBvbiBmdXR1cmUgc2VjdXJpdHkgbmVlZHMuIEFwcGxpY2F0aW9uIGRldmVsb3BlcnMgYXJlIGVuY291cmFnZWRcbiAqIHRvIGNoZWNrIHRoZSBgZXhwYCBleHBpcmF0aW9uIGZpZWxkIGluIHRoZSByZXNwb25zZSBhY2Nlc3NUb2tlbiBhbmQgcmVuZXcgdG9rZW5zIGFmdGVyIHRoZXkgZXhwaXJlLlxuICpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7QXV0aH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL0F1dGgnO1xuICogaW1wb3J0IHtUcmFuc3BvcnR9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9IVFRQJztcbiAqXG4gKiBjb25zdCB7YWNjZXNzVG9rZW59ID0gYXdhaXQgQXV0aC5hdXRoZW50aWNhdGVBcHAoeyBjbGllbnRfaWQ6ICdDTElFTlRJRCcsIGNsaWVudF9zZWNyZXQ6ICdTRUNSRVQnIH0pO1xuICogVHJhbnNwb3J0LnNldEF1dGhUb2tlbihhY2Nlc3NUb2tlbik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IHZhciBhdXRoZW50aWNhdGVBcHAgPSBmdW5jdGlvbiAoZW5kcG9pbnQsIHBhcmFtcykge1xuICAgIHJldHVybiBlbmRwb2ludC5hcGkgLy9cbiAgICAgICAgLnBvc3QoJy9hdXRoZW50aWNhdGlvbi9sb2dpbl9jbGllbnQnLCB7fSwgeyBoZWFkZXJzOiBwYXJhbXMgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuZGF0YTsgfSk7XG59O1xuLyoqXG4gKiBWYWxpZGF0ZSBhIHRva2VuLiBPbmx5IFZlcmRvY3MgdG9rZW5zIHdpbGwgYmUgYWNjZXB0ZWQuIE1vc3QgYXBwbGljYXRpb25zIGNhbiBkZWNvZGUgdG9rZW5zIGxvY2FsbHksXG4gKiBiZWNhdXNlIHRva2VucyB3aWxsIGJlIHZhbGlkYXRlZCB3aGVuIEFQSSBjYWxscyBhcmUgbWFkZSBhbnl3YXkuIEhvd2V2ZXIsIGhpZ2gtc2VjdXJpdHkgYXBwbGljYXRpb25zXG4gKiBtYXkgdXNlIHRoaXMgZW5kcG9pbnQgdG8gY2hlY2sgaWYgYSB0b2tlbiBoYXMgYmVlbiByZXZva2VkLlxuICpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7QXV0aH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL0F1dGgnO1xuICpcbiAqIGNvbnN0IHt2YWxpZH0gPSBhd2FpdCBBdXRoLnZhbGlkYXRlVG9rZW4oeyB0b2tlbiB9KTtcbiAqIGlmICghdmFsaWQpIHtcbiAqICAgd2luZG93LmFsZXJ0KCdTZXNzaW9uIGludmFsaWQgb3IgZXhwaXJlZC4gUGxlYXNlIHJlLWF1dGhlbnRpY2F0ZS4nKTtcbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgdmFyIHZhbGlkYXRlVG9rZW4gPSBmdW5jdGlvbiAoZW5kcG9pbnQsIHBhcmFtcykge1xuICAgIHJldHVybiBlbmRwb2ludC5hcGkgLy9cbiAgICAgICAgLnBvc3QoJy90b2tlbi9pc1ZhbGlkJywgcGFyYW1zKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5kYXRhOyB9KTtcbn07XG4vKipcbiAqIElmIGNhbGxlZCBiZWZvcmUgdGhlIHNlc3Npb24gZXhwaXJlcywgdGhpcyB3aWxsIHJlZnJlc2ggdGhlIGNhbGxlcidzIHNlc3Npb24gYW5kIHRva2Vucy5cbiAqXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQge0F1dGh9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9BdXRoJztcbiAqIGltcG9ydCB7VHJhbnNwb3J0fSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvSFRUUCc7XG4gKlxuICogY29uc3Qge2FjY2Vzc1Rva2VufSA9IGF3YWl0IEF1dGgucmVmcmVzaFRva2VucygpO1xuICogVHJhbnNwb3J0LnNldEF1dGhUb2tlbihhY2Nlc3NUb2tlbik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoVG9rZW5zID0gZnVuY3Rpb24gKGVuZHBvaW50KSB7XG4gICAgcmV0dXJuIGVuZHBvaW50LmFwaSAvL1xuICAgICAgICAuZ2V0KCcvdG9rZW4nKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5kYXRhOyB9KTtcbn07XG4vKipcbiAqIFVwZGF0ZSB0aGUgY2FsbGVyJ3MgcGFzc3dvcmQuIFRvIGhlbHAgcHJldmVudCBDU1JGIGF0dGFjayB2ZWN0b3JzLCB0aGUgdXNlcidzIG9sZCBwYXNzd29yZCBhbmQgZW1haWwgYWRkcmVzcyBhcmUgcmVxdWlyZWQuXG4gKlxuICogYGBgdHlwZXNjcmlwdFxuICogaW1wb3J0IHtBdXRofSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvQXV0aCc7XG4gKlxuICogY29uc3Qge3N0YXR1cywgbWVzc2FnZX0gPSBhd2FpdCBBdXRoLnVwZGF0ZVBhc3N3b3JkKHsgZW1haWwsIG9sZFBhc3N3b3JkLCBuZXdQYXNzd29yZCB9KTtcbiAqIGlmIChzdGF0dXMgIT09ICdPSycpIHtcbiAqICAgd2luZG93LmFsZXJ0KGBQYXNzd29yZCByZXNldCBlcnJvcjogJHttZXNzYWdlfWApO1xuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlUGFzc3dvcmQgPSBmdW5jdGlvbiAoZW5kcG9pbnQsIHBhcmFtcykge1xuICAgIHJldHVybiBlbmRwb2ludC5hcGkgLy9cbiAgICAgICAgLnB1dCgnL3VzZXIvdXBkYXRlX3Bhc3N3b3JkJywgcGFyYW1zKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocikgeyByZXR1cm4gci5kYXRhOyB9KTtcbn07XG4vKipcbiAqIFVwZGF0ZSB0aGUgY2FsbGVyJ3MgZW1haWwgYWRkcmVzcy5cbiAqXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQge0F1dGh9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9BdXRoJztcbiAqXG4gKiBjb25zdCB7cHJvZmlsZXN9ID0gYXdhaXQgQXV0aC51cGRhdGVFbWFpbCh7IGVtYWlsOiBuZXdFbWFpbCB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUVtYWlsID0gZnVuY3Rpb24gKGVuZHBvaW50LCBwYXJhbXMpIHtcbiAgICByZXR1cm4gZW5kcG9pbnQuYXBpIC8vXG4gICAgICAgIC5wdXQoJy91c2VyL3VwZGF0ZV9lbWFpbCcsIHBhcmFtcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuZGF0YTsgfSk7XG59O1xuIiwiaW1wb3J0IHtBdXRofSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVXNlcnMnO1xuaW1wb3J0IHtDb21wb25lbnQsIFByb3AsIFN0YXRlLCBoLCBFdmVudCwgRXZlbnRFbWl0dGVyfSBmcm9tICdAc3RlbmNpbC9jb3JlJztcbmltcG9ydCB7VmVyZG9jc0VuZHBvaW50LCBUU2Vzc2lvbn0gZnJvbSAnQHZlcmRvY3MvanMtc2RrJztcblxuZXhwb3J0IGludGVyZmFjZSBJQXV0aFN0YXR1cyB7XG4gIGF1dGhlbnRpY2F0ZWQ6IGJvb2xlYW47XG4gIHNlc3Npb246IFRTZXNzaW9uO1xufVxuXG4vKipcbiAqIERpc3BsYXkgYW4gYXV0aGVudGljYXRpb24gZGlhbG9nIHRoYXQgYWxsb3dzIHRoZSB1c2VyIHRvIGxvZ2luIG9yIHNpZ24gdXAuIENhbGxiYWNrcyBhcmUgcHJvdmlkZWQgZm9yIGV2ZW50cyB0aGF0XG4gKiBvY2N1ciBkdXJpbmcgdGhlIHByb2Nlc3MgKGVzcGVjaWFsbHkgc3VjY2Vzc2Z1bCBjb21wbGV0aW9uKS4gVGhlIHN1Y2Nlc3MgY2FsbGJhY2sgd2lsbCBiZSBmaXJlZCBpbW1lZGlhdGVseSBpZiB0aGVcbiAqIHVzZXIgaXMgYWxyZWFkeSBhdXRoZW50aWNhdGVkIHdpdGggYSB2YWxpZCBzZXNzaW9uLCBzbyB0aGlzIGNvbXBvbmVudCBtYXkgbm90IGFsd2F5cyBkaXNwbGF5IHZpc2libHkuXG4gKlxuICogVG8gc2ltcGxpZnkgc29tZSB0eXBlcyBvZiBhdXRoZW50aWNhdGlvbiBmbG93cywgYSB2aXNpYmlsaXR5IGZsYWcgY2FuIGZvcmNlIHRoaXMgY29tcG9uZW50IHRvIG5ldmVyIGRpc3BsYXkuIFRoaXNcbiAqIGFsbG93cyB5b3UgdG8gc3VzYmNyaWJlIHRvIG5vdGlmaWNhdGlvbnMgZnJvbSB0aGVcbiAqXG4gKiBUaGlzIGVtYmVkIGlzIHJlc3BvbnNpdmUgLyBtb2JpbGUtZnJpZW5kbHksIGJ1dCB0aGUgY2FsbGluZyBhcHBsaWNhdGlvbiBzaG91bGQgcHJvdmlkZSBhdCBsZWFzdCBhIDMwMHB4IHdpZGVcbiAqIGNvbnRhaW5lciB0byBhbGxvdyBzdWZmaWNpZW50IHNwYWNlIGZvciB0aGUgcmVxdWlyZWQgZm9ybXMuXG4gKlxuICogQXMgbm90ZWQgYmVsb3csIHRoZSBwcmltYXJ5IGV2ZW50IGlzIGBhdXRoZW50aWNhdGVkYC4gVGhpcyB3aWxsIGFsd2F5cyBiZSBmaXJlZCBhdCBsZWFzdCBvbmNlLCBpbW1lZGlhdGVseSBhZnRlclxuICogdGhlIHdpZGdldCBpcyByZW5kZXJlZCBhbmQgdGhlIHVzZXIncyBzdGF0dXMgaGFzIGJlZW4gY2hlY2tlZC4gSXQgbWF5IGJlIGZpcmVkIGFnYWluIGFzIHRoZSB1c2VyIGNvbXBsZXRlcyAob3JcbiAqIGNhbmNlbHMpIGF1dGhlbnRpY2F0aW9uIHN0ZXBzLlxuICpcbiAqIEF1dGhlbnRpY2F0aW9uIGlzIHJlcXVpcmVkIHRvIGRlbW9uc3RyYXRlIHRoaXMgRWxlbWVudC4gWW91IG1heSBkbyB0aGlzIGluIFN0b3J5Ym9vayBieSB1c2luZyB0aGUgQXV0aFxuICogZW1iZWQuIFRoaXMgRWxlbWVudCB3aWxsIHJldXNlIHRoZSBzYW1lIHNlc3Npb24gcHJvZHVjZWQgYnkgbG9nZ2luZyBpbiB2aWEgdGhhdCBFbWJlZC5cbiAqXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbnRlcmZhY2UgSUF1dGhTdGF0dXMge1xuICogICAvLyBJZiB0cnVlLCB0aGUgdXNlciBpcyBhdXRoZW50aWNhdGVkIHdpdGggYSB2YWxpZCBzZXNzaW9uXG4gKiAgIGF1dGhlbnRpY2F0ZWQ6IGJvb2xlYW47XG4gKlxuICogICAvLyBEZXRhaWxzIGZvciB0aGUgdXNlcidzIHNlc3Npb25cbiAqICAgc2Vzc2lvbjogSUFjdGl2ZVNlc3Npb24gfCBudWxsO1xuICogfVxuICogYGBgXG4gKi9cbkBDb21wb25lbnQoe1xuICB0YWc6ICd2ZXJkb2NzLWF1dGgnLFxuICBzdHlsZVVybDogJ3ZlcmRvY3MtYXV0aC5zY3NzJyxcbiAgc2hhZG93OiBmYWxzZSxcbn0pXG5leHBvcnQgY2xhc3MgVmVyZG9jc0F1dGgge1xuICAvKipcbiAgICogVGhlIGVuZHBvaW50IHRvIHVzZSB0byBjb21tdW5pY2F0ZSB3aXRoIFZlcmRvY3MuIElmIG5vdCBzZXQsIHRoZSBkZWZhdWx0IGVuZHBvaW50IHdpbGwgYmUgdXNlZC5cbiAgICovXG4gIEBQcm9wKCkgZW5kcG9pbnQ6IFZlcmRvY3NFbmRwb2ludD0gVmVyZG9jc0VuZHBvaW50LmdldERlZmF1bHQoKTtcblxuICAvKipcbiAgICogTm9ybWFsbHksIGlmIHRoZSB1c2VyIGhhcyBhIHZhbGlkIHNlc3Npb24sIHRoaXMgZW1iZWQgd2lsbCBiZSBpbnZpc2libGUsIG90aGVyd2lzZSBpdCB3aWxsIGRpc3BsYXlcbiAgICogbG9naW4gLyBzaWdudXAgZm9ybXMuIElmIHRoaXMgaXMgc2V0IHRvIGZhbHNlLCB0aGlzIGVtYmVkIHdpbGwgYmUgaW52aXNpYmxlIGluIGJvdGggY2FzZXMuIEFwcHMgbWF5XG4gICAqIHVzZSB0aGlzIHRvIHZlcmlmeSBpZiBhIHVzZXIgaGFzIGEgdmFsaWQgc2Vzc2lvbiB3aXRob3V0IG5lZWRpbmcgYSBzZXBhcmF0ZSBjYWxsIHRvIFZlcmRvY3MgSlMgU0RLLlxuICAgKi9cbiAgQFByb3AoKSB2aXNpYmxlOiBib29sZWFuID0gdHJ1ZTtcblxuICAvKipcbiAgICogQnkgZGVmYXVsdCwgYSBWZXJkb2NzIGxvZ28gd2lsbCBiZSBkaXNwbGF5ZWQgYWJvdmUgdGhlIGxvZ2luL3NpZ251cCBmb3Jtcy4gVGhpcyBtYXkgYmUgdXNlZCB0b1xuICAgKiBvdmVycmlkZSBpdHMgc291cmNlLiAoQWx0ZXJuYXRpdmVseSwgeW91IG1heSBzaW1wbHkgaGlkZSBpdCB2aWEgQ1NTIG92ZXJyaWRlcy4pIExvZ29zIHNob3VsZCBiZVxuICAgKiBpbiBTVkcgZm9ybWF0IGZvciBiZXN0IHJlc3VsdHMuXG4gICAqL1xuICBAUHJvcCgpIGxvZ286IHN0cmluZyA9ICdodHRwczovL3ZlcmRvY3MuY29tL2Fzc2V0cy9ibHVlLWxvZ28uc3ZnJztcblxuICAvKipcbiAgICogSWYgdGhlIHVzZXIgaXMgYXV0aGVudGljYXRlZCwgdGhpcyBlbWJlZCB3aWxsIG5vcm1hbGx5IHJlbmRlciBpbnZpc2libHkuIElmIGRlYnVnIGlzIHNldCB0cnVlLCBhIHN1bW1hcnlcbiAgICogaWYgdGhlIHVzZXIncyBzZXNzaW9uIGRldGFpbHMgd2lsbCBiZSBkaXNwbGF5ZWQgaW5zdGVhZC4gVGhpcyBtYXkgYmUgdXNlZnVsIHdoaWxlIGRlYnVnZ2luZyBhdXRoZW50aWNhdGlvblxuICAgKiBmbG93cyBpbiBuZXcgYXBwbGljYXRpb25zLlxuICAgKi9cbiAgQFByb3AoKSBkZWJ1ZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBFdmVudCBmaXJlZCB3aGVuIHNlc3Npb24gYXV0aGVudGljYXRpb24gcHJvY2VzcyBoYXMgY29tcGxldGVkLiBDaGVjayB0aGUgZXZlbnQgY29udGVudHMgZm9yIGNvbXBsZXRpb24gc3RhdHVzLlxuICAgKi9cbiAgQEV2ZW50KHtjb21wb3NlZDogdHJ1ZX0pIGF1dGhlbnRpY2F0ZWQ6IEV2ZW50RW1pdHRlcjxJQXV0aFN0YXR1cz47XG5cbiAgQFN0YXRlKCkgaXNBdXRoZW50aWNhdGVkOiBib29sZWFuID0gZmFsc2U7XG4gIEBTdGF0ZSgpIGRpc3BsYXlNb2RlOiBzdHJpbmcgPSAnbG9naW4nO1xuICBAU3RhdGUoKSB1c2VybmFtZTogc3RyaW5nID0gJyc7XG4gIEBTdGF0ZSgpIHBhc3N3b3JkOiBzdHJpbmcgPSAnJztcbiAgQFN0YXRlKCkgbG9nZ2luZ0luOiBib29sZWFuID0gZmFsc2U7XG4gIEBTdGF0ZSgpIGFjdGl2ZVNlc3Npb246IFRTZXNzaW9uID0gbnVsbDtcbiAgQFN0YXRlKCkgbG9naW5FcnJvcjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICBjb25zb2xlLmxvZygnbG9hZGVkJywgdGhpcyk7XG4gICAgdGhpcy5lbmRwb2ludC5sb2FkU2Vzc2lvbigpO1xuICAgIGlmICh0aGlzLmVuZHBvaW50LnNlc3Npb24pIHtcbiAgICAgIHRoaXMuaXNBdXRoZW50aWNhdGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuYWN0aXZlU2Vzc2lvbiA9IHRoaXMuZW5kcG9pbnQuc2Vzc2lvbjtcbiAgICAgIHRoaXMuYXV0aGVudGljYXRlZC5lbWl0KHthdXRoZW50aWNhdGVkOiB0cnVlLCBzZXNzaW9uOiB0aGlzLmVuZHBvaW50LnNlc3Npb259KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hdXRoZW50aWNhdGVkLmVtaXQoe2F1dGhlbnRpY2F0ZWQ6IGZhbHNlLCBzZXNzaW9uOiBudWxsfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gaGFuZGxlU2VsZWN0T3B0aW9uKG9wdGlvbjogSU1lbnVPcHRpb24pIHtcbiAgLy8gICB0aGlzLmlzQXV0aGVudGljYXRlZCA9IGZhbHNlO1xuICAvLyAgIHRoaXMuYXV0aGVudGljYXRlZC5lbWl0KG9wdGlvbik7XG4gIC8vIH1cblxuICBoYW5kbGVMb2dpbigpIHtcbiAgICB0aGlzLmxvZ2dpbmdJbiA9IHRydWU7XG4gICAgQXV0aC5hdXRoZW50aWNhdGVVc2VyKHRoaXMuZW5kcG9pbnQsIHt1c2VybmFtZTogdGhpcy51c2VybmFtZSwgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmR9KVxuICAgICAgLnRoZW4ociA9PiB7XG4gICAgICAgIHRoaXMubG9nZ2luZ0luID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZW5kcG9pbnQuc2V0VG9rZW4oci5hY2Nlc3NUb2tlbik7XG4gICAgICAgIHRoaXMuYWN0aXZlU2Vzc2lvbiA9IHRoaXMuZW5kcG9pbnQuc2Vzc2lvbjtcbiAgICAgICAgdGhpcy5pc0F1dGhlbnRpY2F0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmF1dGhlbnRpY2F0ZWQuZW1pdCh7YXV0aGVudGljYXRlZDogdHJ1ZSwgc2Vzc2lvbjogdGhpcy5lbmRwb2ludC5zZXNzaW9ufSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGUgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnW1ZFUkRPQ1NdIExvZ2luIGVycm9yJywgZS5yZXNwb25zZSwgSlNPTi5zdHJpbmdpZnkoZSkpO1xuICAgICAgICB0aGlzLmxvZ2dpbmdJbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmFjdGl2ZVNlc3Npb24gPSBudWxsO1xuICAgICAgICB0aGlzLmF1dGhlbnRpY2F0ZWQuZW1pdCh7YXV0aGVudGljYXRlZDogZmFsc2UsIHNlc3Npb246IG51bGx9KTtcblxuICAgICAgICBpZiAoZT8ucmVzcG9uc2U/LnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgICAgdGhpcy5sb2dpbkVycm9yID0gJ1BsZWFzZSBjaGVjayB5b3VyIHVzZXJuYW1lIGFuZCBwYXNzd29yZCBhbmQgdHJ5IGFnYWluLic7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlTG9nb3V0KCkge1xuICAgIHRoaXMuZW5kcG9pbnQuY2xlYXJTZXNzaW9uKCk7XG4gICAgdGhpcy5pc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmF1dGhlbnRpY2F0ZWQuZW1pdCh7YXV0aGVudGljYXRlZDogZmFsc2UsIHNlc3Npb246IG51bGx9KTtcbiAgfVxuXG4gIGhhbmRsZUNsZWFyRXJyb3IoKSB7XG4gICAgdGhpcy5sb2dpbkVycm9yID0gbnVsbDtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBpZiAoIXRoaXMudmlzaWJsZSkge1xuICAgICAgcmV0dXJuIDxkaXYgc3R5bGU9e3tkaXNwbGF5OiAnbm9uZSd9fT5WZXJkb2NzIEF1dGggUGxhY2Vob2xkZXI8L2Rpdj47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNBdXRoZW50aWNhdGVkKSB7XG4gICAgICBpZiAodGhpcy5kZWJ1Zykge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdGF0dXMtcmVzdWx0IGRlYnVnXCI+XG4gICAgICAgICAgICA8dmVyZG9jcy1idXR0b24gbGFiZWw9XCJMb2dvdXRcIiBkaXNhYmxlZD17dGhpcy5sb2dnaW5nSW59IG9uUHJlc3M9eygpID0+IHRoaXMuaGFuZGxlTG9nb3V0KCl9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiA8ZGl2IGNsYXNzPVwic3RhdHVzLXJlc3VsdFwiPkF1dGhlbnRpY2F0ZWQ8L2Rpdj47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGlzcGxheU1vZGUgPT09ICdzaWdudXAnKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8ZGl2IGNsYXNzPVwic2lnbnVwLWZvcm1cIj5cbiAgICAgICAgICA8aW1nIHNyYz17dGhpcy5sb2dvfSBhbHQ9XCJWZXJkb2NzIExvZ29cIiBjbGFzcz1cImxvZ29cIiAvPlxuXG4gICAgICAgICAgPGgzPlNpZ24gdXAgZm9yIGFuIGFjY291bnQ8L2gzPlxuICAgICAgICAgIDxoND5cbiAgICAgICAgICAgIEFscmVhZHkgaGF2ZSBhbiBhY2NvdW50P1xuICAgICAgICAgICAgPHZlcmRvY3MtYnV0dG9uIGxhYmVsPVwiTG9nIEluXCIgdmFyaWFudD1cInRleHRcIiBvbkNsaWNrPXsoKSA9PiAodGhpcy5kaXNwbGF5TW9kZSA9ICdsb2dpbicpfSBkaXNhYmxlZD17dGhpcy5sb2dnaW5nSW59IC8+XG4gICAgICAgICAgPC9oND5cblxuICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXsoKSA9PiB0aGlzLmhhbmRsZUxvZ2luKCl9PlxuICAgICAgICAgICAgPHZlcmRvY3MtdGV4dC1pbnB1dCBsYWJlbD1cIkVtYWlsXCIgYXV0b2NvbXBsZXRlPVwidXNlcm5hbWVcIiB2YWx1ZT17dGhpcy51c2VybmFtZX0gb25GaWVsZElucHV0PXtlID0+ICh0aGlzLnVzZXJuYW1lID0gZS5kZXRhaWwpfSBkaXNhYmxlZD17dGhpcy5sb2dnaW5nSW59IC8+XG4gICAgICAgICAgICA8dmVyZG9jcy10ZXh0LWlucHV0XG4gICAgICAgICAgICAgIGxhYmVsPVwiUGFzc3dvcmRcIlxuICAgICAgICAgICAgICB0eXBlPVwicGFzc3dvcmRcIlxuICAgICAgICAgICAgICBhdXRvY29tcGxldGU9XCJjdXJyZW50LXBhc3N3b3JkXCJcbiAgICAgICAgICAgICAgdmFsdWU9e3RoaXMucGFzc3dvcmR9XG4gICAgICAgICAgICAgIG9uRmllbGRJbnB1dD17ZSA9PiAodGhpcy5wYXNzd29yZCA9IGUuZGV0YWlsKX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMubG9nZ2luZ0lufVxuICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgPHZlcmRvY3MtYnV0dG9uXG4gICAgICAgICAgICAgIGxhYmVsPVwiU2lnbnVwXCJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMubG9nZ2luZ0lufVxuICAgICAgICAgICAgICBvblByZXNzPXsoKSA9PiB0aGlzLmhhbmRsZUxvZ2luKCl9XG4gICAgICAgICAgICAgIHN0eWxlPXt7ZGlzcGxheTogJ2ZsZXgnLCBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsIG1hcmdpbjogJzMwcHggYXV0byAwJ319XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgPC9kaXY+XG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzPVwibG9naW4tZm9ybVwiPlxuICAgICAgICA8aW1nIHNyYz17dGhpcy5sb2dvfSBhbHQ9XCJWZXJkb2NzIExvZ29cIiBjbGFzcz1cImxvZ29cIiAvPlxuXG4gICAgICAgIDxoMz5Mb2cgaW4gdG8geW91ciBhY2NvdW50PC9oMz5cbiAgICAgICAgPGg0PlxuICAgICAgICAgIERvbid0IGhhdmUgYW4gYWNjb3VudD9cbiAgICAgICAgICA8dmVyZG9jcy1idXR0b24gbGFiZWw9XCJTaWduIFVwXCIgdmFyaWFudD1cInRleHRcIiBvbkNsaWNrPXsoKSA9PiAodGhpcy5kaXNwbGF5TW9kZSA9ICdzaWdudXAnKX0gZGlzYWJsZWQ9e3RoaXMubG9nZ2luZ0lufSAvPlxuICAgICAgICA8L2g0PlxuXG4gICAgICAgIDxmb3JtIG9uU3VibWl0PXsoKSA9PiB0aGlzLmhhbmRsZUxvZ2luKCl9PlxuICAgICAgICAgIDx2ZXJkb2NzLXRleHQtaW5wdXQgbGFiZWw9XCJFbWFpbFwiIGF1dG9jb21wbGV0ZT1cInVzZXJuYW1lXCIgdmFsdWU9e3RoaXMudXNlcm5hbWV9IG9uRmllbGRJbnB1dD17ZSA9PiAodGhpcy51c2VybmFtZSA9IGUuZGV0YWlsKX0gZGlzYWJsZWQ9e3RoaXMubG9nZ2luZ0lufSAvPlxuICAgICAgICAgIDx2ZXJkb2NzLXRleHQtaW5wdXRcbiAgICAgICAgICAgIGxhYmVsPVwiUGFzc3dvcmRcIlxuICAgICAgICAgICAgdHlwZT1cInBhc3N3b3JkXCJcbiAgICAgICAgICAgIGF1dG9jb21wbGV0ZT1cImN1cnJlbnQtcGFzc3dvcmRcIlxuICAgICAgICAgICAgdmFsdWU9e3RoaXMucGFzc3dvcmR9XG4gICAgICAgICAgICBvbkZpZWxkSW5wdXQ9e2UgPT4gKHRoaXMucGFzc3dvcmQgPSBlLmRldGFpbCl9XG4gICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5sb2dnaW5nSW59XG4gICAgICAgICAgLz5cblxuICAgICAgICAgIDx2ZXJkb2NzLWJ1dHRvblxuICAgICAgICAgICAgbGFiZWw9XCJGb3Jnb3QgWW91ciBQYXNzd29yZD9cIlxuICAgICAgICAgICAgdmFyaWFudD1cInRleHRcIlxuICAgICAgICAgICAgb25DbGljaz17KCkgPT4gKHRoaXMuZGlzcGxheU1vZGUgPSAnc2lnbnVwJyl9XG4gICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5sb2dnaW5nSW59XG4gICAgICAgICAgICBzdHlsZT17e2Rpc3BsYXk6ICdmbGV4JywganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBtYXJnaW46ICcxMHB4IGF1dG8gMjBweCd9fVxuICAgICAgICAgIC8+XG5cbiAgICAgICAgICA8dmVyZG9jcy1idXR0b24gbGFiZWw9XCJMb2dpblwiIGRpc2FibGVkPXt0aGlzLmxvZ2dpbmdJbn0gb25QcmVzcz17KCkgPT4gdGhpcy5oYW5kbGVMb2dpbigpfSBzdHlsZT17e2Rpc3BsYXk6ICdmbGV4JywganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBtYXJnaW46ICcxMHB4IGF1dG8gMCd9fSAvPlxuICAgICAgICA8L2Zvcm0+XG5cbiAgICAgICAge3RoaXMubG9naW5FcnJvciA/IDx2ZXJkb2NzLW9rLWRpYWxvZyBvcGVuPXt0cnVlfSBoZWFkaW5nPVwiTG9naW4gRXJyb3JcIiBtZXNzYWdlPXt0aGlzLmxvZ2luRXJyb3J9IG9uQ2xvc2VkPXsoKSA9PiB0aGlzLmhhbmRsZUNsZWFyRXJyb3IoKX0gLz4gOiA8ZGl2IC8+fVxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufVxuIiwiQGltcG9ydCAnLi4vLi4vLi4vdGhlbWUuc2Nzcyc7XG5cbnZlcmRvY3MtYXV0aCB7XG4gIGZvbnQtZmFtaWx5OiAkdmVyZG9jcy1wcmltYXJ5LWZvbnQ7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXG4gIC5sb2dpbi1mb3JtLFxuICAuc2lnbnVwLWZvcm0ge1xuICAgIGJhY2tncm91bmQ6ICR2ZXJkb2NzLWdyZXktNDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBwYWRkaW5nOiAyMHB4O1xuICAgIHdpZHRoOiAzMDBweDtcbiAgICBtYXgtd2lkdGg6IDEwMCU7XG4gIH1cblxuICAubG9nbyB7XG4gICAgbWFyZ2luOiAyMHB4IDAgMzBweDtcbiAgICB3aWR0aDogMTI4cHg7XG4gICAgbWF4LXdpZHRoOiAxMDAlO1xuICB9XG5cbiAgaDMge1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICBmb250LXdlaWdodDogNDAwO1xuICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICBsaW5lLWhlaWdodDogMS43NTtcbiAgICBtYXJnaW46IDA7XG4gIH1cblxuICBoNCB7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIGZvbnQtd2VpZ2h0OiA0MDA7XG4gICAgZm9udC1zaXplOiAxNHB4O1xuICAgIGxpbmUtaGVpZ2h0OiAxLjQzO1xuICAgIG1hcmdpbjogMDtcbiAgfVxuXG4gIC5zdGF0dXMtcmVzdWx0IHtcbiAgICBkaXNwbGF5OiBub25lO1xuXG4gICAgJi5kZWJ1ZyB7XG4gICAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7XG4gICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICBiYWNrZ3JvdW5kOiAjZmZmO1xuICAgICAgcGFkZGluZzogMTBweDtcbiAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIH1cbiAgfVxuXG4gIGZvcm0ge1xuICAgIHdpZHRoOiAxMDAlO1xuICB9XG5cbiAgdmVyZG9jcy10ZXh0LWlucHV0IHtcbiAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9