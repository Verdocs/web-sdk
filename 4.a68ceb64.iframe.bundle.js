/*! For license information please see 4.a68ceb64.iframe.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./dist/esm/index-fd7b8a34.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createStore}));__webpack_require__("./node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("./node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("./node_modules/core-js/modules/web.timers.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.map.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.object.entries.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.reduce.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js");var _index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./dist/esm/index-f78d163d.js");function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isConnected=function isConnected(maybeElement){return!("isConnected"in maybeElement)||maybeElement.isConnected},cleanupElements=function debounce(fn,ms){var timeoutId;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];timeoutId&&clearTimeout(timeoutId),timeoutId=setTimeout((function(){timeoutId=0,fn.apply(void 0,args)}),ms)}}((function(map){var _step,_iterator=_createForOfIteratorHelper(map.keys());try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value;map.set(key,map.get(key).filter(isConnected))}}catch(err){_iterator.e(err)}finally{_iterator.f()}}),2e3),unwrap=function unwrap(val){return"function"==typeof val?val():val},removeFromArray=function removeFromArray(array,item){var index=array.indexOf(item);index>=0&&(array[index]=array[array.length-1],array.length--)},createStore=function createStore(defaultState,shouldUpdate){var map=function createObservableMap(defaultState){var shouldUpdate=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(a,b){return a!==b},unwrappedState=unwrap(defaultState),states=new Map(Object.entries(null!=unwrappedState?unwrappedState:{})),handlers={dispose:[],get:[],set:[],reset:[]},reset=function reset(){var _a;states=new Map(Object.entries(null!==(_a=unwrap(defaultState))&&void 0!==_a?_a:{})),handlers.reset.forEach((function(cb){return cb()}))},dispose=function dispose(){handlers.dispose.forEach((function(cb){return cb()})),reset()},_get=function get(propName){return handlers.get.forEach((function(cb){return cb(propName)})),states.get(propName)},_set=function set(propName,value){var oldValue=states.get(propName);shouldUpdate(value,oldValue,propName)&&(states.set(propName,value),handlers.set.forEach((function(cb){return cb(propName,value,oldValue)})))},state="undefined"==typeof Proxy?{}:new Proxy(unwrappedState,{get:function get(_,propName){return _get(propName)},ownKeys:function ownKeys(_){return Array.from(states.keys())},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},has:function has(_,propName){return states.has(propName)},set:function set(_,propName,value){return _set(propName,value),!0}}),on=function on(eventName,callback){return handlers[eventName].push(callback),function(){removeFromArray(handlers[eventName],callback)}},onChange=function onChange(propName,cb){var unSet=on("set",(function(key,newValue){key===propName&&cb(newValue)})),unReset=on("reset",(function(){return cb(unwrap(defaultState)[propName])}));return function(){unSet(),unReset()}},use=function use(){for(var _len2=arguments.length,subscriptions=new Array(_len2),_key2=0;_key2<_len2;_key2++)subscriptions[_key2]=arguments[_key2];var unsubs=subscriptions.reduce((function(unsubs,subscription){return subscription.set&&unsubs.push(on("set",subscription.set)),subscription.get&&unsubs.push(on("get",subscription.get)),subscription.reset&&unsubs.push(on("reset",subscription.reset)),subscription.dispose&&unsubs.push(on("dispose",subscription.dispose)),unsubs}),[]);return function(){return unsubs.forEach((function(unsub){return unsub()}))}};return{state:state,get:_get,set:_set,on:on,onChange:onChange,use:use,dispose:dispose,reset:reset,forceUpdate:function forceUpdate(key){var oldValue=states.get(key);handlers.set.forEach((function(cb){return cb(key,oldValue,oldValue)}))}}}(defaultState,shouldUpdate);return map.use(function stencilSubscription(){if("function"!=typeof _index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__.g)return{};var elmsToUpdate=new Map;return{dispose:function dispose(){return elmsToUpdate.clear()},get:function get(propName){var elm=Object(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__.g)();elm&&function appendToMap(map,propName,value){var items=map.get(propName);items?items.includes(value)||items.push(value):map.set(propName,[value])}(elmsToUpdate,propName,elm)},set:function set(propName){var elements=elmsToUpdate.get(propName);elements&&elmsToUpdate.set(propName,elements.filter(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__.f)),cleanupElements(elmsToUpdate)},reset:function reset(){elmsToUpdate.forEach((function(elms){return elms.forEach(_index_f78d163d_js__WEBPACK_IMPORTED_MODULE_21__.f)})),cleanupElements(elmsToUpdate)}}}()),map}},"./dist/esm/templateStore-b8512d36.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return state}));__webpack_require__("./node_modules/core-js/modules/es.promise.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.async-iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.math.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.json.to-string-tag.js"),__webpack_require__("./node_modules/core-js/modules/es.object.create.js"),__webpack_require__("./node_modules/core-js/modules/es.object.get-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("./node_modules/core-js/modules/es.array.reverse.js");var _index_fd7b8a34_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("./dist/esm/index-fd7b8a34.js"),_utils_2e6beff8_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("./dist/esm/utils-2e6beff8.js");function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==typeof value&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var _createStore=Object(_index_fd7b8a34_js__WEBPACK_IMPORTED_MODULE_24__.a)({template:null,loadProgress:0,loading:!0,pageNumbers:[],pageUris:{},roleNames:[],fields:[],dirty:!1}),state=_createStore.state,onChange=_createStore.onChange;onChange("template",function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(newTemplate){return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(newTemplate){_context.next=9;break}return console.log("[TEMPLATESTORE] Clearing template"),state.fields=[],state.roleNames=[],state.pageNumbers=[],state.dirty=!1,state.loading=!1,state.loadProgress=0,_context.abrupt("return");case 9:console.log("[TEMPLATESTORE] Template loaded",newTemplate),state.roleNames=newTemplate.roles.map((function(role){return role.name})),console.log("[TEMPLATESTORE] Loaded roles",state.roleNames),state.fields=[],newTemplate.roles.forEach((function(role){var _state$fields;(_state$fields=state.fields).push.apply(_state$fields,_toConsumableArray(role.fields))})),console.log("[TEMPLATESTORE] Loaded fields",state.fields),state.pageNumbers=Object(_utils_2e6beff8_js__WEBPACK_IMPORTED_MODULE_25__.e)(1,newTemplate.pages.length);case 16:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()),onChange("fields",(function(newField){console.log("[TEMPLATESTORE] Field changed",newField),state.dirty=!0}))},"./dist/esm/utils-2e6beff8.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getRoleIndex})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getFieldId})),__webpack_require__.d(__webpack_exports__,"c",(function(){return fullNameToInitials})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getFieldSettings})),__webpack_require__.d(__webpack_exports__,"e",(function(){return integerSequence})),__webpack_require__.d(__webpack_exports__,"f",(function(){return renderDocumentField})),__webpack_require__.d(__webpack_exports__,"g",(function(){return updateCssTransform}));__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.array.fill.js"),__webpack_require__("./node_modules/core-js/modules/es.array.join.js"),__webpack_require__("./node_modules/core-js/modules/es.string.split.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("./node_modules/core-js/modules/es.string.match-all.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rescale(r,n){return r*n}var integerSequence=function integerSequence(start,count){return Array(count).fill(1).map((function(_,index){return index+start}))},fullNameToInitials=function fullNameToInitials(name){return name.split(" ").map((function(word){return word[0]})).join("")},setControlStyles=function setControlStyles(el,field,xScale,yScale,option){var _a,_b,_c,_d,settings=field.setting||field.settings,_settings$x=settings.x,x=void 0===_settings$x?0:_settings$x,_settings$y=settings.y,y=void 0===_settings$y?0:_settings$y,_settings$width=settings.width,width=void 0===_settings$width?function defaultWidth(field){switch(field.type){case"attachment":case"payment":return 24;case"checkbox":case"checkbox_group":case"radio_button_group":return 14;case"signature":case"initial":return 82}return 150}(field):_settings$width,_settings$height=settings.height,height=void 0===_settings$height?function defaultHeight(field){switch(field.type){case"attachment":case"payment":return 24;case"checkbox":case"checkbox_group":case"radio_button_group":return 14;case"signature":case"initial":return 41}return 50}(field):_settings$height,optionSettings=void 0!==option&&settings.options[option]?settings.options[option]:null;optionSettings&&(x=null!==(_a=optionSettings.x)&&void 0!==_a?_a:x,y=null!==(_b=optionSettings.y)&&void 0!==_b?_b:y,width=null!==(_c=optionSettings.width)&&void 0!==_c?_c:width,height=null!==(_d=optionSettings.height)&&void 0!==_d?_d:height),el.style.width=width+"px",el.style.height=height+"px",el.style.position="absolute",el.style.left=rescale(xScale,x)+"px",el.style.bottom=rescale(yScale,y)+"px",el.style.transform="scale("+xScale+", "+yScale+")"},getFieldId=function getFieldId(field){return"verdocs-doc-fld-"+field.name},getFieldOptionId=function getFieldOptionId(field,index){return"verdocs-doc-fld-"+field.name+"-"+index},renderDocumentField=function renderDocumentField(field,docPage,roleIndex,fieldOptions){var _fieldOptions$disable=fieldOptions.disabled,disabled=void 0!==_fieldOptions$disable&&_fieldOptions$disable,_fieldOptions$editabl=fieldOptions.editable,editable=void 0!==_fieldOptions$editabl&&_fieldOptions$editabl,_fieldOptions$draggab=fieldOptions.draggable,draggable=void 0!==_fieldOptions$draggab&&_fieldOptions$draggab,controlsDiv=document.getElementById(docPage.containerId+"-controls");if(controlsDiv)switch(field.type){case"attachment":case"date":case"dropdown":case"initial":case"payment":case"signature":case"timestamp":case"textarea":case"textbox":var id=getFieldId(field),existingField=document.getElementById(id);if(existingField)return void setControlStyles(existingField,field,docPage.xScale,docPage.yScale);var el=document.createElement("verdocs-field-"+field.type);return el.field=field,el.setAttribute("id",id),el.setAttribute("roleIndex",roleIndex),disabled&&el.setAttribute("disabled",!0),editable&&el.setAttribute("editable",!0),draggable&&el.setAttribute("draggable",!0),setControlStyles(el,field,docPage.xScale,docPage.yScale),controlsDiv.appendChild(el),el;case"checkbox_group":(field.settings||field.setting||{}).options.forEach((function(_,checkboxIndex){var id=getFieldOptionId(field,checkboxIndex),existingField=document.getElementById(id);if(!existingField){var cbEl=document.createElement("verdocs-field-checkbox");return cbEl.field=field,cbEl.setAttribute("id",id),cbEl.setAttribute("roleIndex",roleIndex),cbEl.setAttribute("option",checkboxIndex),disabled&&cbEl.setAttribute("disabled",!0),setControlStyles(cbEl,field,docPage.xScale,docPage.yScale,checkboxIndex),controlsDiv.appendChild(cbEl),cbEl}setControlStyles(existingField,field,docPage.xScale,docPage.yScale)}));break;case"radio_button_group":(field.settings||field.setting||{}).options.forEach((function(_,buttonIndex){var id=getFieldOptionId(field,buttonIndex),existingField=document.getElementById(id);if(!existingField){var cbEl=document.createElement("verdocs-field-radio-button");return cbEl.field=field,cbEl.setAttribute("id",id),cbEl.setAttribute("roleIndex",roleIndex),cbEl.setAttribute("option",buttonIndex),disabled&&cbEl.setAttribute("disabled",!0),setControlStyles(cbEl,field,docPage.xScale,docPage.yScale,buttonIndex),controlsDiv.appendChild(cbEl),cbEl}setControlStyles(existingField,field,docPage.xScale,docPage.yScale)}));break;default:return console.log("[PREVIEW] Skipping unsupported field type",field),null}},getRoleIndex=function getRoleIndex(roles,role){return roles.indexOf(role)||0},getFieldSettings=function getFieldSettings(field){return field.setting?field.setting:field.settings?field.settings:{x:0,y:0,required:!1,disabled:!1,result:"",value:""}},updateCssTransform=function updateCssTransform(el,key,value){var components=_toConsumableArray(el.style.transform.matchAll(/(\w+)\(([^)]*)\)/gi));el.style.transform=[components.filter((function(component){return component[1]!==key})).map((function(component){return component[0]})),key+"("+value+")"].join(" ")}},"./node_modules/core-js/modules/es.array.reduce.js":function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),$reduce=__webpack_require__("./node_modules/core-js/internals/array-reduce.js").left,arrayMethodIsStrict=__webpack_require__("./node_modules/core-js/internals/array-method-is-strict.js"),CHROME_VERSION=__webpack_require__("./node_modules/core-js/internals/engine-v8-version.js"),IS_NODE=__webpack_require__("./node_modules/core-js/internals/engine-is-node.js");$({target:"Array",proto:!0,forced:!arrayMethodIsStrict("reduce")||!IS_NODE&&CHROME_VERSION>79&&CHROME_VERSION<83},{reduce:function reduce(callbackfn){var length=arguments.length;return $reduce(this,callbackfn,length,length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL0BzdGVuY2lsL3N0b3JlL2Rpc3QvaW5kZXgubWpzIiwid2VicGFjazovLy9zcmMvdXRpbHMvdGVtcGxhdGVTdG9yZS50cyIsIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL0B2ZXJkb2NzL2pzLXNkay9VdGlscy9GaWVsZHMuanMiLCJ3ZWJwYWNrOi8vL3NyYy91dGlscy91dGlscy50cyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZS5qcyJdLCJuYW1lcyI6WyJpc0Nvbm5lY3RlZCIsIm1heWJlRWxlbWVudCIsImNsZWFudXBFbGVtZW50cyIsImRlYm91bmNlIiwiZm4iLCJtcyIsInRpbWVvdXRJZCIsImFyZ3MiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwibWFwIiwia2V5cyIsImtleSIsInNldCIsImdldCIsImZpbHRlciIsInVud3JhcCIsInZhbCIsInJlbW92ZUZyb21BcnJheSIsImFycmF5IiwiaXRlbSIsImluZGV4IiwiaW5kZXhPZiIsImxlbmd0aCIsImNyZWF0ZVN0b3JlIiwiZGVmYXVsdFN0YXRlIiwic2hvdWxkVXBkYXRlIiwiY3JlYXRlT2JzZXJ2YWJsZU1hcCIsImEiLCJiIiwidW53cmFwcGVkU3RhdGUiLCJzdGF0ZXMiLCJNYXAiLCJPYmplY3QiLCJlbnRyaWVzIiwiaGFuZGxlcnMiLCJkaXNwb3NlIiwicmVzZXQiLCJfYSIsImZvckVhY2giLCJjYiIsInByb3BOYW1lIiwidmFsdWUiLCJvbGRWYWx1ZSIsInN0YXRlIiwiUHJveHkiLCJfIiwib3duS2V5cyIsIkFycmF5IiwiZnJvbSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJoYXMiLCJvbiIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwicHVzaCIsIm9uQ2hhbmdlIiwidW5TZXQiLCJuZXdWYWx1ZSIsInVuUmVzZXQiLCJ1c2UiLCJzdWJzY3JpcHRpb25zIiwidW5zdWJzIiwicmVkdWNlIiwic3Vic2NyaXB0aW9uIiwidW5zdWIiLCJmb3JjZVVwZGF0ZSIsInN0ZW5jaWxTdWJzY3JpcHRpb24iLCJnZXRSZW5kZXJpbmdSZWYiLCJlbG1zVG9VcGRhdGUiLCJjbGVhciIsImVsbSIsImFwcGVuZFRvTWFwIiwiaXRlbXMiLCJpbmNsdWRlcyIsImVsZW1lbnRzIiwiZWxtcyIsInRlbXBsYXRlIiwibG9hZFByb2dyZXNzIiwibG9hZGluZyIsInBhZ2VOdW1iZXJzIiwicGFnZVVyaXMiLCJyb2xlTmFtZXMiLCJmaWVsZHMiLCJkaXJ0eSIsIm5ld1RlbXBsYXRlIiwiY29uc29sZSIsImxvZyIsInJvbGVzIiwicm9sZSIsIm5hbWUiLCJpbnRlZ2VyU2VxdWVuY2UiLCJwYWdlcyIsIm5ld0ZpZWxkIiwicmVzY2FsZSIsInIiLCJuIiwic3RhcnQiLCJjb3VudCIsImZpbGwiLCJmdWxsTmFtZVRvSW5pdGlhbHMiLCJzcGxpdCIsIndvcmQiLCJqb2luIiwic2V0Q29udHJvbFN0eWxlcyIsImVsIiwiZmllbGQiLCJ4U2NhbGUiLCJ5U2NhbGUiLCJvcHRpb24iLCJzZXR0aW5ncyIsInNldHRpbmciLCJ4IiwieSIsIndpZHRoIiwiZGVmYXVsdFdpZHRoIiwidHlwZSIsImhlaWdodCIsImRlZmF1bHRIZWlnaHQiLCJvcHRpb25TZXR0aW5ncyIsInVuZGVmaW5lZCIsIm9wdGlvbnMiLCJzdHlsZSIsInBvc2l0aW9uIiwibGVmdCIsImJvdHRvbSIsInRyYW5zZm9ybSIsImdldEZpZWxkSWQiLCJnZXRGaWVsZE9wdGlvbklkIiwicmVuZGVyRG9jdW1lbnRGaWVsZCIsImRvY1BhZ2UiLCJyb2xlSW5kZXgiLCJmaWVsZE9wdGlvbnMiLCJkaXNhYmxlZCIsImVkaXRhYmxlIiwiZHJhZ2dhYmxlIiwiY29udHJvbHNEaXYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGFpbmVySWQiLCJpZCIsImV4aXN0aW5nRmllbGQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJjaGVja2JveEluZGV4IiwiY2JFbCIsImJ1dHRvbkluZGV4IiwiZ2V0Um9sZUluZGV4IiwiZ2V0RmllbGRTZXR0aW5ncyIsInJlcXVpcmVkIiwicmVzdWx0IiwidXBkYXRlQ3NzVHJhbnNmb3JtIiwiY29tcG9uZW50cyIsIm1hdGNoQWxsIiwiY29tcG9uZW50IiwiJCIsIiRyZWR1Y2UiLCJhcnJheU1ldGhvZElzU3RyaWN0IiwiQ0hST01FX1ZFUlNJT04iLCJJU19OT0RFIiwidGFyZ2V0IiwicHJvdG8iLCJmb3JjZWQiLCJjYWxsYmFja2ZuIiwiYXJndW1lbnRzIiwidGhpcyJdLCJtYXBwaW5ncyI6IjsrcEdBRUEsSUErQk1BLFlBQWMsU0FBZEEsWUFBZUMsY0FBWSxRQUFPLGdCQUFpQkEsZUFBaUJBLGFBQWFELFdBQVcsRUFDNUZFLGdCQXZCVyxTQUFYQyxTQUFZQyxHQUFJQyxJQUNsQixJQUFJQyxVQUNKLE9BQU8sV0FBYSw4QkFBVEMsS0FBSSx3Q0FBSkEsS0FBSSxzQkFDUEQsV0FDQUUsYUFBYUYsV0FFakJBLFVBQVlHLFlBQVcsV0FDbkJILFVBQVksRUFDWkYsR0FBRSxhQUFJRyxLQUNsQixHQUFXRixHQUNYLENBQ0EsQ0FZd0JGLEVBQVMsU0FBQ08sS0FBUSxJQUNaLE1BRFkscUNBQ3RCQSxJQUFJQyxRQUFNLElBQTFCLElBQUssVUFBTCxpQ0FBNEIsS0FBbkJDLElBQUcsWUFDUkYsSUFBSUcsSUFBSUQsSUFBS0YsSUFBSUksSUFBSUYsS0FBS0csT0FBT2YsYUFDekMsQ0FBSyxtREFDTCxHQUFHLEtBOEJHZ0IsT0FBUyxTQUFUQSxPQUFVQyxLQUFHLE1BQXFCLG1CQUFSQSxJQUFxQkEsTUFBUUEsR0FBRyxFQStHMURDLGdCQUFrQixTQUFsQkEsZ0JBQW1CQyxNQUFPQyxNQUM1QixJQUFNQyxNQUFRRixNQUFNRyxRQUFRRixNQUN4QkMsT0FBUyxJQUNURixNQUFNRSxPQUFTRixNQUFNQSxNQUFNSSxPQUFTLEdBQ3BDSixNQUFNSSxT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TCxvQkFBb0IsWUFHdEJFLFNBQVdELGVBQWlCLElBQU1BLGVBQWlCLElBSUssQ0FDeEVoRyxPQUFRLFNBQVNBLE9BQU9xRyxZQUN0QixJQUFJL0ksT0FBU2dKLFVBQVVoSixPQUN2QixPQUFPd0ksUUFBUVMsS0FBTUYsV0FBWS9JLE9BQVFBLE9BQVMsRUFBSWdKLFVBQVUsUUFBSzdDLEVBQ3ZFLEciLCJmaWxlIjoiNC5hNjhjZWI2NC5pZnJhbWUuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0UmVuZGVyaW5nUmVmLCBmb3JjZVVwZGF0ZSB9IGZyb20gJ0BzdGVuY2lsL2NvcmUnO1xuXG5jb25zdCBhcHBlbmRUb01hcCA9IChtYXAsIHByb3BOYW1lLCB2YWx1ZSkgPT4ge1xuICAgIGNvbnN0IGl0ZW1zID0gbWFwLmdldChwcm9wTmFtZSk7XG4gICAgaWYgKCFpdGVtcykge1xuICAgICAgICBtYXAuc2V0KHByb3BOYW1lLCBbdmFsdWVdKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoIWl0ZW1zLmluY2x1ZGVzKHZhbHVlKSkge1xuICAgICAgICBpdGVtcy5wdXNoKHZhbHVlKTtcbiAgICB9XG59O1xuY29uc3QgZGVib3VuY2UgPSAoZm4sIG1zKSA9PiB7XG4gICAgbGV0IHRpbWVvdXRJZDtcbiAgICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgaWYgKHRpbWVvdXRJZCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aW1lb3V0SWQgPSAwO1xuICAgICAgICAgICAgZm4oLi4uYXJncyk7XG4gICAgICAgIH0sIG1zKTtcbiAgICB9O1xufTtcblxuLyoqXG4gKiBDaGVjayBpZiBhIHBvc3NpYmxlIGVsZW1lbnQgaXNDb25uZWN0ZWQuXG4gKiBUaGUgcHJvcGVydHkgbWlnaHQgbm90IGJlIHRoZXJlLCBzbyB3ZSBjaGVjayBmb3IgaXQuXG4gKlxuICogV2Ugd2FudCBpdCB0byByZXR1cm4gdHJ1ZSBpZiBpc0Nvbm5lY3RlZCBpcyBub3QgYSBwcm9wZXJ0eSxcbiAqIG90aGVyd2lzZSB3ZSB3b3VsZCByZW1vdmUgdGhlc2UgZWxlbWVudHMgYW5kIHdvdWxkIG5vdCB1cGRhdGUuXG4gKlxuICogQmV0dGVyIGxlYWsgaW4gRWRnZSB0aGFuIHRvIGJlIHVzZWxlc3MuXG4gKi9cbmNvbnN0IGlzQ29ubmVjdGVkID0gKG1heWJlRWxlbWVudCkgPT4gISgnaXNDb25uZWN0ZWQnIGluIG1heWJlRWxlbWVudCkgfHwgbWF5YmVFbGVtZW50LmlzQ29ubmVjdGVkO1xuY29uc3QgY2xlYW51cEVsZW1lbnRzID0gZGVib3VuY2UoKG1hcCkgPT4ge1xuICAgIGZvciAobGV0IGtleSBvZiBtYXAua2V5cygpKSB7XG4gICAgICAgIG1hcC5zZXQoa2V5LCBtYXAuZ2V0KGtleSkuZmlsdGVyKGlzQ29ubmVjdGVkKSk7XG4gICAgfVxufSwgMjAwMCk7XG5jb25zdCBzdGVuY2lsU3Vic2NyaXB0aW9uID0gKCkgPT4ge1xuICAgIGlmICh0eXBlb2YgZ2V0UmVuZGVyaW5nUmVmICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIElmIHdlIGFyZSBub3QgaW4gYSBzdGVuY2lsIHByb2plY3QsIHdlIGRvIG5vdGhpbmcuXG4gICAgICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMgbm90IHJlYWxseSBleHBvcnRlZCBieSBAc3RlbmNpbC9jb3JlLlxuICAgICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGNvbnN0IGVsbXNUb1VwZGF0ZSA9IG5ldyBNYXAoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBkaXNwb3NlOiAoKSA9PiBlbG1zVG9VcGRhdGUuY2xlYXIoKSxcbiAgICAgICAgZ2V0OiAocHJvcE5hbWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsbSA9IGdldFJlbmRlcmluZ1JlZigpO1xuICAgICAgICAgICAgaWYgKGVsbSkge1xuICAgICAgICAgICAgICAgIGFwcGVuZFRvTWFwKGVsbXNUb1VwZGF0ZSwgcHJvcE5hbWUsIGVsbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogKHByb3BOYW1lKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IGVsbXNUb1VwZGF0ZS5nZXQocHJvcE5hbWUpO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnRzKSB7XG4gICAgICAgICAgICAgICAgZWxtc1RvVXBkYXRlLnNldChwcm9wTmFtZSwgZWxlbWVudHMuZmlsdGVyKGZvcmNlVXBkYXRlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjbGVhbnVwRWxlbWVudHMoZWxtc1RvVXBkYXRlKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVzZXQ6ICgpID0+IHtcbiAgICAgICAgICAgIGVsbXNUb1VwZGF0ZS5mb3JFYWNoKChlbG1zKSA9PiBlbG1zLmZvckVhY2goZm9yY2VVcGRhdGUpKTtcbiAgICAgICAgICAgIGNsZWFudXBFbGVtZW50cyhlbG1zVG9VcGRhdGUpO1xuICAgICAgICB9LFxuICAgIH07XG59O1xuXG5jb25zdCB1bndyYXAgPSAodmFsKSA9PiAodHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJyA/IHZhbCgpIDogdmFsKTtcbmNvbnN0IGNyZWF0ZU9ic2VydmFibGVNYXAgPSAoZGVmYXVsdFN0YXRlLCBzaG91bGRVcGRhdGUgPSAoYSwgYikgPT4gYSAhPT0gYikgPT4ge1xuICAgIGNvbnN0IHVud3JhcHBlZFN0YXRlID0gdW53cmFwKGRlZmF1bHRTdGF0ZSk7XG4gICAgbGV0IHN0YXRlcyA9IG5ldyBNYXAoT2JqZWN0LmVudHJpZXModW53cmFwcGVkU3RhdGUgIT09IG51bGwgJiYgdW53cmFwcGVkU3RhdGUgIT09IHZvaWQgMCA/IHVud3JhcHBlZFN0YXRlIDoge30pKTtcbiAgICBjb25zdCBoYW5kbGVycyA9IHtcbiAgICAgICAgZGlzcG9zZTogW10sXG4gICAgICAgIGdldDogW10sXG4gICAgICAgIHNldDogW10sXG4gICAgICAgIHJlc2V0OiBbXSxcbiAgICB9O1xuICAgIGNvbnN0IHJlc2V0ID0gKCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIC8vIFdoZW4gcmVzZXR0aW5nIHRoZSBzdGF0ZSwgdGhlIGRlZmF1bHQgc3RhdGUgbWF5IGJlIGEgZnVuY3Rpb24gLSB1bndyYXAgaXQgdG8gaW52b2tlIGl0LlxuICAgICAgICAvLyBvdGhlcndpc2UsIHRoZSBzdGF0ZSB3b24ndCBiZSBwcm9wZXJseSByZXNldFxuICAgICAgICBzdGF0ZXMgPSBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKChfYSA9IHVud3JhcChkZWZhdWx0U3RhdGUpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB7fSkpO1xuICAgICAgICBoYW5kbGVycy5yZXNldC5mb3JFYWNoKChjYikgPT4gY2IoKSk7XG4gICAgfTtcbiAgICBjb25zdCBkaXNwb3NlID0gKCkgPT4ge1xuICAgICAgICAvLyBDYWxsIGZpcnN0IGRpc3Bvc2UgYXMgcmVzZXR0aW5nIHRoZSBzdGF0ZSB3b3VsZFxuICAgICAgICAvLyBjYXVzZSBsZXNzIHVwZGF0ZXMgOylcbiAgICAgICAgaGFuZGxlcnMuZGlzcG9zZS5mb3JFYWNoKChjYikgPT4gY2IoKSk7XG4gICAgICAgIHJlc2V0KCk7XG4gICAgfTtcbiAgICBjb25zdCBnZXQgPSAocHJvcE5hbWUpID0+IHtcbiAgICAgICAgaGFuZGxlcnMuZ2V0LmZvckVhY2goKGNiKSA9PiBjYihwcm9wTmFtZSkpO1xuICAgICAgICByZXR1cm4gc3RhdGVzLmdldChwcm9wTmFtZSk7XG4gICAgfTtcbiAgICBjb25zdCBzZXQgPSAocHJvcE5hbWUsIHZhbHVlKSA9PiB7XG4gICAgICAgIGNvbnN0IG9sZFZhbHVlID0gc3RhdGVzLmdldChwcm9wTmFtZSk7XG4gICAgICAgIGlmIChzaG91bGRVcGRhdGUodmFsdWUsIG9sZFZhbHVlLCBwcm9wTmFtZSkpIHtcbiAgICAgICAgICAgIHN0YXRlcy5zZXQocHJvcE5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIGhhbmRsZXJzLnNldC5mb3JFYWNoKChjYikgPT4gY2IocHJvcE5hbWUsIHZhbHVlLCBvbGRWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBzdGF0ZSA9ICh0eXBlb2YgUHJveHkgPT09ICd1bmRlZmluZWQnXG4gICAgICAgID8ge31cbiAgICAgICAgOiBuZXcgUHJveHkodW53cmFwcGVkU3RhdGUsIHtcbiAgICAgICAgICAgIGdldChfLCBwcm9wTmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXQocHJvcE5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG93bktleXMoXykge1xuICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHN0YXRlcy5rZXlzKCkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldE93blByb3BlcnR5RGVzY3JpcHRvcigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoYXMoXywgcHJvcE5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGVzLmhhcyhwcm9wTmFtZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0KF8sIHByb3BOYW1lLCB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHNldChwcm9wTmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSkpO1xuICAgIGNvbnN0IG9uID0gKGV2ZW50TmFtZSwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgaGFuZGxlcnNbZXZlbnROYW1lXS5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIHJlbW92ZUZyb21BcnJheShoYW5kbGVyc1tldmVudE5hbWVdLCBjYWxsYmFjayk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBjb25zdCBvbkNoYW5nZSA9IChwcm9wTmFtZSwgY2IpID0+IHtcbiAgICAgICAgY29uc3QgdW5TZXQgPSBvbignc2V0JywgKGtleSwgbmV3VmFsdWUpID0+IHtcbiAgICAgICAgICAgIGlmIChrZXkgPT09IHByb3BOYW1lKSB7XG4gICAgICAgICAgICAgICAgY2IobmV3VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gV2UgbmVlZCB0byB1bndyYXAgdGhlIGRlZmF1bHRTdGF0ZSBiZWNhdXNlIGl0IG1pZ2h0IGJlIGEgZnVuY3Rpb24uXG4gICAgICAgIC8vIE90aGVyd2lzZSB3ZSBtaWdodCBub3QgYmUgc2VuZGluZyB0aGUgcmlnaHQgcmVzZXQgdmFsdWUuXG4gICAgICAgIGNvbnN0IHVuUmVzZXQgPSBvbigncmVzZXQnLCAoKSA9PiBjYih1bndyYXAoZGVmYXVsdFN0YXRlKVtwcm9wTmFtZV0pKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIHVuU2V0KCk7XG4gICAgICAgICAgICB1blJlc2V0KCk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBjb25zdCB1c2UgPSAoLi4uc3Vic2NyaXB0aW9ucykgPT4ge1xuICAgICAgICBjb25zdCB1bnN1YnMgPSBzdWJzY3JpcHRpb25zLnJlZHVjZSgodW5zdWJzLCBzdWJzY3JpcHRpb24pID0+IHtcbiAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uc2V0KSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzLnB1c2gob24oJ3NldCcsIHN1YnNjcmlwdGlvbi5zZXQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uZ2V0KSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzLnB1c2gob24oJ2dldCcsIHN1YnNjcmlwdGlvbi5nZXQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24ucmVzZXQpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnMucHVzaChvbigncmVzZXQnLCBzdWJzY3JpcHRpb24ucmVzZXQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uZGlzcG9zZSkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdkaXNwb3NlJywgc3Vic2NyaXB0aW9uLmRpc3Bvc2UpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bnN1YnM7XG4gICAgICAgIH0sIFtdKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHVuc3Vicy5mb3JFYWNoKCh1bnN1YikgPT4gdW5zdWIoKSk7XG4gICAgfTtcbiAgICBjb25zdCBmb3JjZVVwZGF0ZSA9IChrZXkpID0+IHtcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSBzdGF0ZXMuZ2V0KGtleSk7XG4gICAgICAgIGhhbmRsZXJzLnNldC5mb3JFYWNoKChjYikgPT4gY2Ioa2V5LCBvbGRWYWx1ZSwgb2xkVmFsdWUpKTtcbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXRlLFxuICAgICAgICBnZXQsXG4gICAgICAgIHNldCxcbiAgICAgICAgb24sXG4gICAgICAgIG9uQ2hhbmdlLFxuICAgICAgICB1c2UsXG4gICAgICAgIGRpc3Bvc2UsXG4gICAgICAgIHJlc2V0LFxuICAgICAgICBmb3JjZVVwZGF0ZSxcbiAgICB9O1xufTtcbmNvbnN0IHJlbW92ZUZyb21BcnJheSA9IChhcnJheSwgaXRlbSkgPT4ge1xuICAgIGNvbnN0IGluZGV4ID0gYXJyYXkuaW5kZXhPZihpdGVtKTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICBhcnJheVtpbmRleF0gPSBhcnJheVthcnJheS5sZW5ndGggLSAxXTtcbiAgICAgICAgYXJyYXkubGVuZ3RoLS07XG4gICAgfVxufTtcblxuY29uc3QgY3JlYXRlU3RvcmUgPSAoZGVmYXVsdFN0YXRlLCBzaG91bGRVcGRhdGUpID0+IHtcbiAgICBjb25zdCBtYXAgPSBjcmVhdGVPYnNlcnZhYmxlTWFwKGRlZmF1bHRTdGF0ZSwgc2hvdWxkVXBkYXRlKTtcbiAgICBtYXAudXNlKHN0ZW5jaWxTdWJzY3JpcHRpb24oKSk7XG4gICAgcmV0dXJuIG1hcDtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZU9ic2VydmFibGVNYXAsIGNyZWF0ZVN0b3JlIH07XG4iLCIvLyBOT1RFOiBEbyBub3QgYXR0ZW1wdCB0byBjb252ZXJ0IHRoaXMgdG8gYSBuYW1lZC1leHBvcnQgbW9kdWxlLiBJdCB0cmlnZ2VycyBjb21waWxhdGlvbiBpc3N1ZXMgaW4gUm9sbHVwIHRoYXQgSSBzcGVudCBkYXlzIHRyeWluZyB0b1xuLy8gcmVzb2x2ZS4gVGhpcyBuZWVkcyB0byBleHBvcnQgYSBzaW5nbGUgZGVmYXVsdCB2YWx1ZSBvZiB0aGUgc3RvcmUncyBzdGF0ZS4gQW55IGhlbHBlciBmdW5jdGlvbnMgc2hvdWxkIGdvIGluIFRlbXBsYXRlcy50cyBoZXJlLlxuXG5pbXBvcnQge2NyZWF0ZVN0b3JlfSBmcm9tICdAc3RlbmNpbC9zdG9yZSc7XG5pbXBvcnQge0lUZW1wbGF0ZSwgSVRlbXBsYXRlRmllbGR9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9UZW1wbGF0ZXMvVHlwZXMnO1xuLy8gaW1wb3J0IHtWZXJkb2NzRW5kcG9pbnR9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkayc7XG4vLyBpbXBvcnQge2dldFRlbXBsYXRlfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvVGVtcGxhdGVzL1RlbXBsYXRlcyc7XG5pbXBvcnQge2ludGVnZXJTZXF1ZW5jZX0gZnJvbSAnLi91dGlscyc7XG4vLyBpbXBvcnQge2dldFBhZ2VJbWFnZX0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1RlbXBsYXRlcy9QYWdlcyc7XG5cbmNvbnN0IHtzdGF0ZSwgb25DaGFuZ2V9ID0gY3JlYXRlU3RvcmUoe1xuICB0ZW1wbGF0ZTogbnVsbCBhcyBJVGVtcGxhdGUgfCBudWxsLFxuICBsb2FkUHJvZ3Jlc3M6IDAsXG4gIGxvYWRpbmc6IHRydWUsXG5cbiAgcGFnZU51bWJlcnM6IFtdIGFzIG51bWJlcltdLFxuICBwYWdlVXJpczoge30gYXMgUmVjb3JkPG51bWJlciwgc3RyaW5nPixcbiAgcm9sZU5hbWVzOiBbXSBhcyBzdHJpbmdbXSxcbiAgZmllbGRzOiBbXSBhcyBJVGVtcGxhdGVGaWVsZFtdLFxuICBkaXJ0eTogZmFsc2UsXG59KTtcblxub25DaGFuZ2UoJ3RlbXBsYXRlJywgYXN5bmMgbmV3VGVtcGxhdGUgPT4ge1xuICBpZiAoIW5ld1RlbXBsYXRlKSB7XG4gICAgY29uc29sZS5sb2coJ1tURU1QTEFURVNUT1JFXSBDbGVhcmluZyB0ZW1wbGF0ZScpO1xuICAgIHN0YXRlLmZpZWxkcyA9IFtdO1xuICAgIHN0YXRlLnJvbGVOYW1lcyA9IFtdO1xuICAgIHN0YXRlLnBhZ2VOdW1iZXJzID0gW107XG4gICAgc3RhdGUuZGlydHkgPSBmYWxzZTtcbiAgICBzdGF0ZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgc3RhdGUubG9hZFByb2dyZXNzID0gMDtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zb2xlLmxvZygnW1RFTVBMQVRFU1RPUkVdIFRlbXBsYXRlIGxvYWRlZCcsIG5ld1RlbXBsYXRlKTtcblxuICBzdGF0ZS5yb2xlTmFtZXMgPSBuZXdUZW1wbGF0ZS5yb2xlcy5tYXAocm9sZSA9PiByb2xlLm5hbWUpO1xuICBjb25zb2xlLmxvZygnW1RFTVBMQVRFU1RPUkVdIExvYWRlZCByb2xlcycsIHN0YXRlLnJvbGVOYW1lcyk7XG5cbiAgc3RhdGUuZmllbGRzID0gW107XG4gIG5ld1RlbXBsYXRlLnJvbGVzLmZvckVhY2gocm9sZSA9PiB7XG4gICAgc3RhdGUuZmllbGRzLnB1c2goLi4ucm9sZS5maWVsZHMpO1xuICB9KTtcblxuICBjb25zb2xlLmxvZygnW1RFTVBMQVRFU1RPUkVdIExvYWRlZCBmaWVsZHMnLCBzdGF0ZS5maWVsZHMpO1xuXG4gIHN0YXRlLnBhZ2VOdW1iZXJzID0gaW50ZWdlclNlcXVlbmNlKDEsIG5ld1RlbXBsYXRlLnBhZ2VzLmxlbmd0aCk7XG59KTtcblxub25DaGFuZ2UoJ2ZpZWxkcycsIG5ld0ZpZWxkID0+IHtcbiAgY29uc29sZS5sb2coJ1tURU1QTEFURVNUT1JFXSBGaWVsZCBjaGFuZ2VkJywgbmV3RmllbGQpO1xuICBzdGF0ZS5kaXJ0eSA9IHRydWU7XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgc3RhdGU7XG4iLCJleHBvcnQgZnVuY3Rpb24gZ2V0UlRvcCh5LCBmaWVsZEhlaWdodCwgaVRleHRIZWlnaHQsIHlSYXRpbykge1xuICAgIHJldHVybiBpVGV4dEhlaWdodCAtICh5ICsgZmllbGRIZWlnaHQpICogeVJhdGlvO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFJMZWZ0KHgsIHJhdGlvKSB7XG4gICAgcmV0dXJuIHggKiByYXRpbztcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRSVmFsdWUoeSwgcmF0aW8pIHtcbiAgICByZXR1cm4geSAqIHJhdGlvO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGJsb2JUb0Jhc2U2NChpbWFnZSkge1xuICAgIHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmaWxlUmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZWplY3QobmV3IERPTUV4Y2VwdGlvbignUHJvYmxlbSByZWFkaW5nIGJsb2IuJykpO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJlc29sdmUoZmlsZVJlYWRlci5yZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoaW1hZ2UpO1xuICAgIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHJlc2NhbGUociwgbikge1xuICAgIHJldHVybiByICogbjtcbn1cbiIsIi8vIFRoZXNlIHNob3VsZCBwcm9iYWJseSBhbGwgbW92ZSB0byBKUy1TREtcbmltcG9ydCB7cmVzY2FsZX0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1V0aWxzL0ZpZWxkcyc7XG4vLyBpbXBvcnQge2dldFJHQkF9IGZyb20gJ0B2ZXJkb2NzL2pzLXNkay9VdGlscy9Db2xvcnMnO1xuaW1wb3J0IHtJVGVtcGxhdGVGaWVsZH0gZnJvbSAnQHZlcmRvY3MvanMtc2RrL1RlbXBsYXRlcy9UeXBlcyc7XG5pbXBvcnQge0lEb2N1bWVudEZpZWxkfSBmcm9tICdAdmVyZG9jcy9qcy1zZGsvRW52ZWxvcGVzL1R5cGVzJztcbmltcG9ydCB7SURvY3VtZW50UGFnZUluZm99IGZyb20gJy4vVHlwZXMnO1xuXG5leHBvcnQgY29uc3QgaW50ZWdlclNlcXVlbmNlID0gKHN0YXJ0OiBudW1iZXIsIGNvdW50OiBudW1iZXIpOiBudW1iZXJbXSA9PlxuICBBcnJheShjb3VudClcbiAgICAuZmlsbCgxKVxuICAgIC5tYXAoKF8sIGluZGV4KSA9PiBpbmRleCArIHN0YXJ0KTtcblxuZXhwb3J0IGNvbnN0IGZ1bGxOYW1lVG9Jbml0aWFscyA9IChuYW1lOiBzdHJpbmcpID0+XG4gIG5hbWVcbiAgICAuc3BsaXQoJyAnKVxuICAgIC5tYXAod29yZCA9PiB3b3JkWzBdKVxuICAgIC5qb2luKCcnKTtcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRXaWR0aCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICBjYXNlICdhdHRhY2htZW50JzpcbiAgICBjYXNlICdwYXltZW50JzpcbiAgICAgIHJldHVybiAyNDtcbiAgICBjYXNlICdjaGVja2JveCc6XG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgIGNhc2UgJ3JhZGlvX2J1dHRvbl9ncm91cCc6XG4gICAgICByZXR1cm4gMTQ7XG4gICAgY2FzZSAnc2lnbmF0dXJlJzpcbiAgICBjYXNlICdpbml0aWFsJzpcbiAgICAgIHJldHVybiA4MjtcbiAgfVxuXG4gIHJldHVybiAxNTA7XG59O1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdEhlaWdodCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICBjYXNlICdhdHRhY2htZW50JzpcbiAgICBjYXNlICdwYXltZW50JzpcbiAgICAgIHJldHVybiAyNDtcbiAgICBjYXNlICdjaGVja2JveCc6XG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgIGNhc2UgJ3JhZGlvX2J1dHRvbl9ncm91cCc6XG4gICAgICByZXR1cm4gMTQ7XG4gICAgY2FzZSAnc2lnbmF0dXJlJzpcbiAgICBjYXNlICdpbml0aWFsJzpcbiAgICAgIHJldHVybiA0MTtcbiAgfVxuXG4gIHJldHVybiA1MDtcbn07XG5cbmV4cG9ydCBjb25zdCBzZXRDb250cm9sU3R5bGVzID0gKGVsOiBIVE1MRWxlbWVudCwgZmllbGQ6IElUZW1wbGF0ZUZpZWxkIHwgSURvY3VtZW50RmllbGQsIHhTY2FsZTogbnVtYmVyLCB5U2NhbGU6IG51bWJlciwgb3B0aW9uPzogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IHNldHRpbmdzID0gKGZpZWxkIGFzIElUZW1wbGF0ZUZpZWxkKS5zZXR0aW5nIHx8IChmaWVsZCBhcyBJRG9jdW1lbnRGaWVsZCkuc2V0dGluZ3M7XG4gIGxldCB7eCA9IDAsIHkgPSAwLCB3aWR0aCA9IGRlZmF1bHRXaWR0aChmaWVsZCksIGhlaWdodCA9IGRlZmF1bHRIZWlnaHQoZmllbGQpfSA9IHNldHRpbmdzO1xuXG4gIGNvbnN0IG9wdGlvblNldHRpbmdzID0gb3B0aW9uICE9PSB1bmRlZmluZWQgJiYgc2V0dGluZ3Mub3B0aW9uc1tvcHRpb25dID8gc2V0dGluZ3Mub3B0aW9uc1tvcHRpb25dIDogbnVsbDtcbiAgaWYgKG9wdGlvblNldHRpbmdzKSB7XG4gICAgeCA9IG9wdGlvblNldHRpbmdzLnggPz8geDtcbiAgICB5ID0gb3B0aW9uU2V0dGluZ3MueSA/PyB5O1xuICAgIHdpZHRoID0gb3B0aW9uU2V0dGluZ3Mud2lkdGggPz8gd2lkdGg7XG4gICAgaGVpZ2h0ID0gb3B0aW9uU2V0dGluZ3MuaGVpZ2h0ID8/IGhlaWdodDtcbiAgfVxuXG4gIGVsLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xuICBlbC5zdHlsZS5oZWlnaHQgPSBgJHtoZWlnaHR9cHhgO1xuICBlbC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gIGVsLnN0eWxlLmxlZnQgPSBgJHtyZXNjYWxlKHhTY2FsZSwgeCl9cHhgO1xuICBlbC5zdHlsZS5ib3R0b20gPSBgJHtyZXNjYWxlKHlTY2FsZSwgeSl9cHhgO1xuICBlbC5zdHlsZS50cmFuc2Zvcm0gPSBgc2NhbGUoJHt4U2NhbGV9LCAke3lTY2FsZX0pYDtcbiAgLy8gZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZmllbGRbJ3JnYmEnXSB8fCBnZXRSR0JBKHJvbGVJbmRleCk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RmllbGRJZCA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICByZXR1cm4gYHZlcmRvY3MtZG9jLWZsZC0ke2ZpZWxkLm5hbWV9YDtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRGaWVsZE9wdGlvbklkID0gKGZpZWxkOiBJVGVtcGxhdGVGaWVsZCB8IElEb2N1bWVudEZpZWxkLCBpbmRleDogbnVtYmVyKSA9PiB7XG4gIHJldHVybiBgdmVyZG9jcy1kb2MtZmxkLSR7ZmllbGQubmFtZX0tJHtpbmRleH1gO1xufTtcblxuaW50ZXJmYWNlIElGaWVsZE9wdGlvbnMge1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG4gIGVkaXRhYmxlPzogYm9vbGVhbjtcbiAgZHJhZ2dhYmxlPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IHJlbmRlckRvY3VtZW50RmllbGQgPSAoZmllbGQ6IElUZW1wbGF0ZUZpZWxkIHwgSURvY3VtZW50RmllbGQsIGRvY1BhZ2U6IElEb2N1bWVudFBhZ2VJbmZvLCByb2xlSW5kZXg6IG51bWJlciwgZmllbGRPcHRpb25zOiBJRmllbGRPcHRpb25zKSA9PiB7XG4gIGNvbnN0IHtkaXNhYmxlZCA9IGZhbHNlLCBlZGl0YWJsZSA9IGZhbHNlLCBkcmFnZ2FibGUgPSBmYWxzZX0gPSBmaWVsZE9wdGlvbnM7XG4gIGNvbnN0IGNvbnRyb2xzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZG9jUGFnZS5jb250YWluZXJJZCArICctY29udHJvbHMnKTtcbiAgaWYgKCFjb250cm9sc0Rpdikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgIGNhc2UgJ2F0dGFjaG1lbnQnOlxuICAgIGNhc2UgJ2RhdGUnOlxuICAgIGNhc2UgJ2Ryb3Bkb3duJzpcbiAgICBjYXNlICdpbml0aWFsJzpcbiAgICBjYXNlICdwYXltZW50JzpcbiAgICBjYXNlICdzaWduYXR1cmUnOlxuICAgIGNhc2UgJ3RpbWVzdGFtcCc6XG4gICAgY2FzZSAndGV4dGFyZWEnOlxuICAgIGNhc2UgJ3RleHRib3gnOiB7XG4gICAgICBjb25zdCBpZCA9IGdldEZpZWxkSWQoZmllbGQpO1xuICAgICAgY29uc3QgZXhpc3RpbmdGaWVsZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICAgIGlmIChleGlzdGluZ0ZpZWxkKSB7XG4gICAgICAgIHNldENvbnRyb2xTdHlsZXMoZXhpc3RpbmdGaWVsZCwgZmllbGQsIGRvY1BhZ2UueFNjYWxlLCBkb2NQYWdlLnlTY2FsZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZWw6IGFueSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYHZlcmRvY3MtZmllbGQtJHtmaWVsZC50eXBlfWApO1xuICAgICAgZWwuZmllbGQgPSBmaWVsZDtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3JvbGVJbmRleCcsIHJvbGVJbmRleCk7XG4gICAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgfVxuICAgICAgaWYgKGVkaXRhYmxlKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZWRpdGFibGUnLCB0cnVlKTtcbiAgICAgIH1cbiAgICAgIGlmIChkcmFnZ2FibGUpIHtcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCB0cnVlKTtcbiAgICAgIH1cbiAgICAgIHNldENvbnRyb2xTdHlsZXMoZWwsIGZpZWxkLCBkb2NQYWdlLnhTY2FsZSwgZG9jUGFnZS55U2NhbGUpO1xuICAgICAgY29udHJvbHNEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuXG4gICAgICByZXR1cm4gZWw7XG4gICAgfVxuXG4gICAgY2FzZSAnY2hlY2tib3hfZ3JvdXAnOlxuICAgICAgKChmaWVsZCBhcyBhbnkpLnNldHRpbmdzIHx8IChmaWVsZCBhcyBhbnkpLnNldHRpbmcgfHwge30pLm9wdGlvbnMuZm9yRWFjaCgoXywgY2hlY2tib3hJbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBpZCA9IGdldEZpZWxkT3B0aW9uSWQoZmllbGQsIGNoZWNrYm94SW5kZXgpO1xuICAgICAgICBjb25zdCBleGlzdGluZ0ZpZWxkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICAgICBpZiAoZXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgIHNldENvbnRyb2xTdHlsZXMoZXhpc3RpbmdGaWVsZCwgZmllbGQsIGRvY1BhZ2UueFNjYWxlLCBkb2NQYWdlLnlTY2FsZSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2JFbDogYW55ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgdmVyZG9jcy1maWVsZC1jaGVja2JveGApO1xuICAgICAgICBjYkVsLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ3JvbGVJbmRleCcsIHJvbGVJbmRleCk7XG4gICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdvcHRpb24nLCBjaGVja2JveEluZGV4KTtcbiAgICAgICAgaWYgKGRpc2FibGVkKSB7XG4gICAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0Q29udHJvbFN0eWxlcyhjYkVsLCBmaWVsZCwgZG9jUGFnZS54U2NhbGUsIGRvY1BhZ2UueVNjYWxlLCBjaGVja2JveEluZGV4KTtcbiAgICAgICAgY29udHJvbHNEaXYuYXBwZW5kQ2hpbGQoY2JFbCk7XG5cbiAgICAgICAgcmV0dXJuIGNiRWw7XG4gICAgICB9KTtcblxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdyYWRpb19idXR0b25fZ3JvdXAnOlxuICAgICAgKChmaWVsZCBhcyBhbnkpLnNldHRpbmdzIHx8IChmaWVsZCBhcyBhbnkpLnNldHRpbmcgfHwge30pLm9wdGlvbnMuZm9yRWFjaCgoXywgYnV0dG9uSW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSBnZXRGaWVsZE9wdGlvbklkKGZpZWxkLCBidXR0b25JbmRleCk7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRmllbGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgICAgIGlmIChleGlzdGluZ0ZpZWxkKSB7XG4gICAgICAgICAgc2V0Q29udHJvbFN0eWxlcyhleGlzdGluZ0ZpZWxkLCBmaWVsZCwgZG9jUGFnZS54U2NhbGUsIGRvY1BhZ2UueVNjYWxlKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYkVsOiBhbnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGB2ZXJkb2NzLWZpZWxkLXJhZGlvLWJ1dHRvbmApO1xuICAgICAgICBjYkVsLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgICAgY2JFbC5zZXRBdHRyaWJ1dGUoJ3JvbGVJbmRleCcsIHJvbGVJbmRleCk7XG4gICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdvcHRpb24nLCBidXR0b25JbmRleCk7XG4gICAgICAgIGlmIChkaXNhYmxlZCkge1xuICAgICAgICAgIGNiRWwuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHNldENvbnRyb2xTdHlsZXMoY2JFbCwgZmllbGQsIGRvY1BhZ2UueFNjYWxlLCBkb2NQYWdlLnlTY2FsZSwgYnV0dG9uSW5kZXgpO1xuICAgICAgICBjb250cm9sc0Rpdi5hcHBlbmRDaGlsZChjYkVsKTtcblxuICAgICAgICByZXR1cm4gY2JFbDtcbiAgICAgIH0pO1xuXG4gICAgICBicmVhaztcblxuICAgIC8vIGNhc2UgJ2F0dGFjaG1lbnQnOlxuICAgIC8vICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2ZXJkb2NzLWZpZWxkLWF0dGFjaG1lbnQnKTtcbiAgICAvLyAgIGVsLnNldEF0dHJpYnV0ZSgndmFsdWUnLCByZXN1bHQgfHwgJycpO1xuICAgIC8vICAgYnJlYWs7XG4gICAgLy8gY2FzZSAncGF5bWVudCc6XG4gICAgLy8gICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZlcmRvY3MtZmllbGQtcGF5bWVudCcpO1xuICAgIC8vICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUubG9nKCdbUFJFVklFV10gU2tpcHBpbmcgdW5zdXBwb3J0ZWQgZmllbGQgdHlwZScsIGZpZWxkKTtcbiAgICAgIHJldHVybiBudWxsO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0Um9sZUluZGV4ID0gKHJvbGVzOiBzdHJpbmdbXSwgcm9sZTogc3RyaW5nKSA9PiByb2xlcy5pbmRleE9mKHJvbGUpIHx8IDA7XG5cbi8vIFRPRE86IFdlIGNhbiBjbGVhbiB0aGlzIHVwIGEgbG90IGlmIHdlIGFsdGVyIHRoZSBBUEkgdG8gZW1pdCBib3RoIHNldHRpbmcgYW5kIHNldHRpbmdzIHJlZ2FyZGxlc3Mgb2YgdGhlIHNvdXJjZSB0eXBlLFxuLy8gICBidXQgdGhlbiBtZXJnZSB0aGUgU0RLIHR5cGVzIHRvIGVuY291cmFnZSBkZXZlbG9wZXJzIHRvIHVzZSBqdXN0IGBzZXR0aW5nc2AuXG5leHBvcnQgY29uc3QgZ2V0RmllbGRTZXR0aW5ncyA9IChmaWVsZDogSVRlbXBsYXRlRmllbGQgfCBJRG9jdW1lbnRGaWVsZCkgPT4ge1xuICBpZiAoKGZpZWxkIGFzIElUZW1wbGF0ZUZpZWxkKS5zZXR0aW5nKSB7XG4gICAgcmV0dXJuIChmaWVsZCBhcyBJVGVtcGxhdGVGaWVsZCkuc2V0dGluZztcbiAgfVxuXG4gIGlmICgoZmllbGQgYXMgSURvY3VtZW50RmllbGQpLnNldHRpbmdzKSB7XG4gICAgcmV0dXJuIChmaWVsZCBhcyBJRG9jdW1lbnRGaWVsZCkuc2V0dGluZ3M7XG4gIH1cblxuICByZXR1cm4ge3g6IDAsIHk6IDAsIHJlcXVpcmVkOiBmYWxzZSwgZGlzYWJsZWQ6IGZhbHNlLCByZXN1bHQ6ICcnLCB2YWx1ZTogJyd9O1xufTtcblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gc2FmZWx5IHNldC91cGRhdGUgY29tcG9uZW50cyBpbiBhIENTUyB0cmFuc2Zvcm0gYXR0cmlidXRlLiBUcmFuc2Zvcm0gaXMgbm9ybWFsbHkgc2V0IGFzIGEgc3RyaW5nIG9mXG4gKiBgb3BlcmF0aW9uMShwYXJhbSkgb3BlcmF0aW9uMihwYXJhbSkgLi4uYCBjb21wb25lbnRzLCB3aGljaCBtYWtlcyB1cGRhdGluZyB0aGVtIGEgYml0IG9mIGEgcGFpbi4gVGhpcyB3aWxsIHJlbW92ZSB0aGVcbiAqIHNwZWNpZmllZCBjb21wb25lbnQgaWYgaXQncyBhbHJlYWR5IHNldCBhbmQgcmVwbGFjZSBpdCB3aXRoIHRoZSBuZXcgdmFsdWUsIHdpdGhvdXQgdG91Y2hpbmcgdGhlIG90aGVyIGNvbXBvbmVudHMgdGhhdFxuICogbWF5IGFscmVhZHkgYmUgc2V0LiBOb3RlIHRoYXQgdGhpcyBvcGVyYXRpb24gbW92ZXMgdGhlIGNvbXBvbmVudCB0byB0aGUgZW5kIG9mIHRoZSB0cmFuc2Zvcm0gY2hhaW4gc28gaXQncyBub3QgbWVhbnRcbiAqIHRvIGJlIHVzZWQgZm9yIG9yZGVyLXNlbnNpdGl2ZSBjb21wb25lbnRzIGUuZy4gdHJhbnNsYXRlLXRoZW4tcm90YXRlLlxuICovXG5leHBvcnQgY29uc3QgdXBkYXRlQ3NzVHJhbnNmb3JtID0gKGVsOiBIVE1MRWxlbWVudCwga2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgLy8gZS5nLiAnc2NhbGUoMS44NzkwOCwgMS44NzkwOCkgdHJhbnNsYXRlKDBweCwgMHB4KTsnXG4gIGNvbnN0IGN1cnJlbnRUcmFuc2Zvcm0gPSBlbC5zdHlsZS50cmFuc2Zvcm07XG4gIC8vIGUuZy4gWydzY2FsZSgxLjg3OTA4LCAxLjg3OTA4KScsICdzY2FsZScsICcxLjg3OTA4LCAxLjg3OTA4JywgLi4uXSwgWyAndHJhbnNsYXRlKDBweCwgMHB4KScsICd0cmFuc2xhdGUnLCAnMHB4LCAwcHgnXV1cbiAgY29uc3QgY29tcG9uZW50cyA9IFsuLi5jdXJyZW50VHJhbnNmb3JtLm1hdGNoQWxsKC8oXFx3KylcXCgoW14pXSopXFwpL2dpKV07XG4gIGVsLnN0eWxlLnRyYW5zZm9ybSA9IFtcbiAgICBjb21wb25lbnRzIC8vXG4gICAgICAuZmlsdGVyKGNvbXBvbmVudCA9PiBjb21wb25lbnRbMV0gIT09IGtleSkgLy8gUmVtb3ZlIHRoZSBlbnRyeSBpZiBpdCdzIGFscmVhZHkgc2V0XG4gICAgICAubWFwKGNvbXBvbmVudCA9PiBjb21wb25lbnRbMF0pLCAvLyBDb252ZXJ0IGJhY2sgdGhlIHJlbWFpbmluZyBlbnRyaWVzXG4gICAgYCR7a2V5fSgke3ZhbHVlfSlgLFxuICBdLmpvaW4oJyAnKTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG52YXIgJCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9leHBvcnQnKTtcbnZhciAkcmVkdWNlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FycmF5LXJlZHVjZScpLmxlZnQ7XG52YXIgYXJyYXlNZXRob2RJc1N0cmljdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9hcnJheS1tZXRob2QtaXMtc3RyaWN0Jyk7XG52YXIgQ0hST01FX1ZFUlNJT04gPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZW5naW5lLXY4LXZlcnNpb24nKTtcbnZhciBJU19OT0RFID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2VuZ2luZS1pcy1ub2RlJyk7XG5cbnZhciBTVFJJQ1RfTUVUSE9EID0gYXJyYXlNZXRob2RJc1N0cmljdCgncmVkdWNlJyk7XG4vLyBDaHJvbWUgODAtODIgaGFzIGEgY3JpdGljYWwgYnVnXG4vLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0xMDQ5OTgyXG52YXIgQ0hST01FX0JVRyA9ICFJU19OT0RFICYmIENIUk9NRV9WRVJTSU9OID4gNzkgJiYgQ0hST01FX1ZFUlNJT04gPCA4MztcblxuLy8gYEFycmF5LnByb3RvdHlwZS5yZWR1Y2VgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheS5wcm90b3R5cGUucmVkdWNlXG4kKHsgdGFyZ2V0OiAnQXJyYXknLCBwcm90bzogdHJ1ZSwgZm9yY2VkOiAhU1RSSUNUX01FVEhPRCB8fCBDSFJPTUVfQlVHIH0sIHtcbiAgcmVkdWNlOiBmdW5jdGlvbiByZWR1Y2UoY2FsbGJhY2tmbiAvKiAsIGluaXRpYWxWYWx1ZSAqLykge1xuICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIHJldHVybiAkcmVkdWNlKHRoaXMsIGNhbGxiYWNrZm4sIGxlbmd0aCwgbGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7XG4gIH1cbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==